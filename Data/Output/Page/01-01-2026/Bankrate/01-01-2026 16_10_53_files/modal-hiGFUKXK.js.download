const g=(l,A=!0)=>{const t=document.getElementById(l),f=300;let a=null,y=0;const s=e=>`is-${e}`,b=()=>t.classList.contains(s("modal-open")),v=e=>{const i=t.querySelectorAll("a[href], button:not([disabled],.Modal-overlay), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]"),c=Array.from(i).filter(r=>{const u=window.getComputedStyle(r),w=r.getBoundingClientRect();return u.display!=="none"&&u.visibility!=="hidden"&&(w.width>0||w.height>0)});let n=0,d=null;if(e.key==="Tab"||e.keyCode==="9"){for(const[r,u]of c.entries())if(u===e.target){n=r;break}e.shiftKey?(n-=1,n<0&&(n=c.length-1),d=c[n],d.focus(),e.preventDefault()):(n+=1,n>c.length-1&&(n=0),d=c[n],d.focus(),e.preventDefault())}},k=()=>{const e=t.querySelector('[tabindex="-1"]'),o=t.querySelectorAll("a, button, textarea, input, select, [tabindex]")[0];e?e.focus():o.focus()},S=()=>{document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",document.body.classList.add(`${l}--active`),t.setAttribute("aria-hidden",!1),t.addEventListener("keydown",v),k()},M=()=>{document.body.style.overflow=null,document.documentElement.style.overflow=null,document.body.classList.remove(`${l}--active`),t.setAttribute("aria-hidden",!0),t.removeEventListener("keydown",v),a&&a.focus()},C=()=>{t.querySelectorAll("iframe[data-src]").forEach(o=>{const i=o.getAttribute("data-src");!o.src&&i&&(o.src=i)})};t.addEventListener("open-modal",()=>L());const L=e=>{C(),A&&(a=e),t.classList.remove(s("closed")),t.classList.add(s("modal-open")),S(),t.classList.add(s("opening")),setTimeout(()=>{t.classList.remove(s("opening"))},f)},m=()=>{t.classList.add(s("closing")),setTimeout(()=>{t.classList.remove(s("closing")),t.classList.remove(s("modal-open")),t.classList.add(s("closed")),M(),a=null},f)},q=e=>{b()?m():L(e)},E=()=>{const e=new Date;return e-y>f?(y=e,!0):!1};[...document.querySelectorAll(`[href*="${l}"]`),...document.querySelectorAll(`[data-target*="${l}"]`)].forEach(e=>{e.addEventListener("click",o=>{o.preventDefault(),E()&&q(e)})});const h=e=>{if(!t){document.removeEventListener("keydown",h);return}const o=e.key==="Escape"||e.keyCode===27;!b()||!o||(e.preventDefault(),E()&&m())};document.addEventListener("keydown",h),window.addEventListener("message",e=>{e.data.name==="CLOSE_MODAL"&&m()})},p=()=>{document.querySelectorAll("[data-modal]").forEach(l=>{l.id&&g(l.id)})};window.initModal=g;document.addEventListener("DOMContentLoaded",p);document.addEventListener("MonarchTrafficFlowReady",p);
