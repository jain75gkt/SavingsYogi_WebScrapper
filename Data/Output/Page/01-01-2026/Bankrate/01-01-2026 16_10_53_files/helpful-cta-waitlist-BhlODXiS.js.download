import{g as a,b as n,u as h,s as p,c as I,a as b,t as y,d as N}from"./email-capture-helpers-DnHch4i1.js";import"./input-validations-Dt9W_Zgc.js";document.addEventListener("alpine:init",()=>{window.Alpine.data("helpfulCtaWaitlist",t=>({email:"",emailError:!1,isSubmitting:!1,subscriptionGroup:t.subscriptionGroup,subscriptionGroupId:t.subscriptionGroupId,display:t.display,formId:null,correlationId:null,formData:{},fields:[],campaignId:t.campaignId,title:t.title,yesTitle:t.yesTitle,noTitle:t.noTitle,yesQuestions:t.yesQuestions,noQuestions:t.noQuestions,get formName(){return"bankrate-feedback-capture"},get formBrand(){return this.campaignId&&this.campaignId.trim()||"Bankrate"},get formVersion(){return this.display},async init(){this.formId=a(),this.correlationId=a()},checkEmail(e){const i=N(this.email,e);this.emailError=i.emailError},trackFieldInputted({stepName:e,stepNumber:i,stepType:s,fieldLabel:o,fieldName:r,fieldValue:l,fieldType:d}){y({correlationId:this.correlationId,formContext:n({formBrand:this.formBrand,formId:this.formId,formName:this.formName,formVersion:this.formVersion}),stepContext:{stepId:a(),stepName:e,stepNumber:i,stepType:s},userInputField:{fieldLabel:o,fieldName:r,fieldValue:l,fieldType:d}})},trackEmailFieldInputted(){b({correlationId:this.correlationId,formContext:n({formBrand:this.formBrand,formId:this.formId,formName:this.formName,formVersion:this.formVersion}),generateUUID:a})},coreIdentify(){I(this.email)},dismiss(){this.trackFormContinued({step:"email_dismissed"}),this.trackFormSubmitted()},async subscribe(){if(!(this.emailError||this.email===""||this.isSubmitting)){this.trackEmailFieldInputted(),this.coreIdentify(),this.isSubmitting=!0;try{await h({email:this.email,formData:{email:this.email},eventName:"Email Capture Form Submitted",eventSuffix:"subscribe"});const e=await p({email:this.email,subscriptionGroup:this.subscriptionGroup,subscriptionGroupId:this.subscriptionGroupId}),i=await e.json();(i.code==="Success"||e.ok&&!i.code)&&(this.trackFormContinued({step:"email"}),this.trackFormSubmitted(),this.$dispatch("waitlist-joined"))}catch{}finally{this.isSubmitting=!1}}},goNext(e){this.trackFormContinued({step:e})},trackFormContinued({step:e}){let i=[],s="did_you_find_this_helpful_response",o="UNKNOWN",r=0;if(e==="email_dismissed")s="email_address",r=2,o="CONTACT",i=[{fieldLabel:"Email Address",fieldName:"email",fieldValue:"",fieldType:"email_address"}];else if(["yes","no"].includes(e))i.push({fieldLabel:this.title,fieldName:"did-you-find-this-helpful",fieldValue:e,fieldType:"button"});else if(["yes_submit","no_submit"].includes(e)){const l=e==="yes_submit"?this.yesQuestions:this.noQuestions,d=e==="yes_submit"?this.yesTitle:this.noTitle;if(s="question_step",r=1,i.push(...l.map((m,u)=>{if(!this.formData[m.uid])return null;const c=u+1,f={fieldLabel:d,fieldName:`submit ${e==="yes_submit"?"positive":"negative"} feedback - response ${c}`,fieldValue:m.value,fieldType:"checkbox"};return this.trackFieldInputted({stepName:s,stepNumber:r,stepType:o,...f}),f}).filter(Boolean)),this.formData.comments){const m={fieldLabel:"Comments",fieldName:"comments",fieldValue:this.formData.comments,fieldType:"UNKNOWN"};i.push(m),this.trackFieldInputted({stepName:s,stepNumber:r,stepType:o,...m})}}else e==="email"&&(s="email_address",r=2,o="CONTACT",i=[{fieldLabel:"Email Address",fieldName:"email",fieldValue:"PII filtered",fieldType:"email_address"}]);this.fields.push(...i),_Beam.track({"@type":"redventures.usertracking.v3.FormContinued",correlationId:this.correlationId,formContext:n({formBrand:this.formBrand,formId:this.formId,formName:this.formName,formVersion:this.formVersion}),stepContext:{stepId:a(),stepName:s,stepNumber:r,stepType:o},field:i})},trackFormSubmitted(){_Beam.track({"@type":"redventures.usertracking.v3.FormSubmitted",correlationId:this.correlationId,field:this.fields,formContext:n({formBrand:this.formBrand,formId:this.formId,formName:this.formName,formVersion:this.formVersion}),stepContext:{stepId:a(),stepName:"form_complete",stepNumber:this.fields.length,stepType:"CONFIRMATION"}})}}))});
