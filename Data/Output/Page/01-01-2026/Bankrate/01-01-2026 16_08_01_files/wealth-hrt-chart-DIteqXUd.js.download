window.HRTChart={initializedCharts:new Set,isSixMonthsOfData(a){if(!(a!=null&&a.length)||a.length<2)return!1;const o=a[0].timestamp/1e3;return(a[a.length-1].timestamp/1e3-o)/2629746>=6},initializeChart(a){const{productType:T,feeds:o,tableData:w,idKey:i,defaultTerm:E=0}=a;if(this.initializedCharts.has(i))return;this.initializedCharts.add(i);const t=document.getElementById(`term-length-${i}`),l=document.getElementById(`term-length-modal-${i}`),b=document.getElementById(`table-view-${i}`),y=document.getElementById(`legend-national-avg-${i}`),C=document.getElementById(`hrtAccordion-${i}`);let v=!1;const D=f=>{if(!t||!w)return;let p=parseInt(t.value,10);const r=document.getElementById(`unique-tbody-${i}`);f&&f.target===l&&(t.value=l.value,p=parseInt(l.value,10));const n=w[p];if(!(!n||!r)){for(;r.firstChild;)r.removeChild(r.firstChild);n.forEach(u=>{const s=document.createElement("tr"),d=document.createElement("td");d.textContent=u.date,s.appendChild(d);const h=document.createElement("td");h.textContent=u.rate,s.appendChild(h);const g=document.createElement("td");g.textContent=u.avg,s.appendChild(g),r.appendChild(s)})}},S=(f={type:"load"})=>{var p,r;if(T==="cd"){const n={};if(Object.entries(o.product_rates).forEach(([e,c])=>{const m=window.HRTChart.isSixMonthsOfData(c);n[e]=m?c:[]}),Object.values(n).every(e=>e.length===0)){const e=C.previousElementSibling;C.style.display="none",e.textContent=`We appreciate your patience as we continue to collect rates
            information for ${o.advertiser_name}. Check back again soon.`;return}Object.entries(o.product_rates).forEach(([e])=>{if(!n[e].length&&t!==null&&l!==null){const c=t.querySelector(`option[value="${e}"]`),m=l.querySelector(`option[value="${e}"]`);c&&c.remove(),m&&m.remove(),delete n[e]}}),D(f);const s=Object.prototype.hasOwnProperty.call(n,E)?E:parseInt(Object.keys(n)[0],10);let d;f.type==="load"?(d=s,t!==null&&(t.value=d)):t!==null&&l!==null&&(d=parseInt(t.value,10),l.value=t.value);const h={};if(Object.entries(o.national_avg).forEach(([e,c])=>{const m=window.HRTChart.isSixMonthsOfData(c);h[e]=m?c:[]}),!v&&!((p=h[d])!=null&&p.length)){const e=document.createElement("div");e.className="text-base text-gray-900 pl-1",e.textContent="(No data available)",y.appendChild(e),v=!0}else v&&((r=h[d])!=null&&r.length)&&(y.removeChild(y.lastChild),v=!1);const g={advertiser_name:o.advertiser_name,product_rates:n[d]||[],national_avg:h[d]||[]};window.renderChart(g,i)}else{const n=window.HRTChart.isSixMonthsOfData(o.product_rates),u=n?o:{...o,product_rates:[]};if(n)window.renderChart(u,i);else{const s=C.previousElementSibling;C.style.display="none",s.textContent=`We appreciate your patience as we continue to collect rates information for ${o.advertiser_name}. Check back again soon.`}}};window.addEventListener("load",S),t!==null&&t.addEventListener("change",S),l!==null&&l.addEventListener("change",S),b!==null&&t!==null&&l!==null&&b.addEventListener("click",D)}};window.HRTChartQueue||(window.HRTChartQueue=[],document.addEventListener("alpine:initialized",()=>{window.HRTChartQueue.forEach(a=>{window.HRTChart.initializeChart(a)}),window.HRTChartQueue=[]}));
