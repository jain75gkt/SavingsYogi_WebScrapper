window.mbt=window.mbt||{};window.mbt.quickLinks=function(){function scrollTo(id,event){function findPos(obj){var curtop=0;if(obj.offsetParent){do{curtop+=obj.offsetTop;}while((obj=obj.offsetParent));return curtop;}}
event&&event.preventDefault();var pos=findPos(document.getElementById(id)),navOffset=document.getElementsByTagName("nav")[0].clientHeight;$('html, body').animate({scrollTop:pos-navOffset},600);}
var getLightBoxPos=0;var toc_position;var toc_width
var element_article_row=document.getElementById('article-top-content');var element_right_rail=document.getElementsByClassName('article-right-rail')[0];toc_position=element_right_rail.offsetTop;function removeLiListItem(item){item.classList.remove('active_link');};function addLiListItem(item){item.parentElement.classList.add('active_link');};var header_height;setHeaderOffset();if(document.getElementsByClassName('toc-ul').length){highlightTocElement();};function setHeaderOffset(){if(pageYOffset==0){header_height=145;}else{header_height=45;}};window.addEventListener('resize',function(){console.log("resize");});function setTocScrollHeight(){var el=document.getElementById('article-right-rail-content');var toc_max_height="450px";var screen_height=document.querySelector('html').clientHeight;var rightRailContentTop=85+document.getElementsByClassName('article-right-rail-head')[0].offsetHeight;var toc_max_height=screen_height-rightRailContentTop;el.style.maxHeight=toc_max_height+"px";};function setTocInitialTopAlignment(){var article_right_rail_head=document.getElementsByClassName("article-right-rail-head")[0].offsetHeight;var article_top_content_mbt6=document.getElementsByClassName("articleContent")[0].clientHeight;var calculate_top_position=(article_top_content_mbt6)-article_right_rail_head;if(element_right_rail.classList.contains('sticky_toc')){var right_rail_toc_position_top=document.getElementsByClassName("article-right-rail")[0].style.marginTop="0px";}else{var right_rail_toc_position_top=document.getElementsByClassName("article-right-rail")[0].style.marginTop="0px";}};function getHeaders(){var result=[];var h2s=document.getElementById('article-top-content').getElementsByTagName('h2');if(h2s.length<1){document.getElementsByClassName("quick-links")[0].style.marginTop="0px";document.getElementsByClassName("article-right-rail-extra")[0].style.paddingTop="0px";document.querySelectorAll(".article-right-rail-head").forEach(el=>{el.style.display="none";});return result;}
for(var i=0;i<h2s.length;i++){result.push(h2s[i]);}
return result;};function highlightTocElement(){var scrollTop=window.scrollY;var h2Anchors=getHeaders();for(var i=0;i<h2Anchors.length;i++){if(h2Anchors[i].innerHTML.length){if(h2Anchors[0].innerHTML.length&&scrollTop<h2Anchors[0].offsetTop){document.querySelectorAll('ul.toc-ul li').forEach(removeLiListItem);var h2ID=h2Anchors[0].getAttribute('data-anchor');var checkLiAnchorText=document.querySelectorAll('ul.toc-ul li a');for(var j=0;j<checkLiAnchorText.length;j++){if(checkLiAnchorText[j].getAttribute('data-anchor')===h2ID){checkLiAnchorText[j].parentElement.classList.add('active_link');}}}
else if(scrollTop>h2Anchors[i].offsetTop-header_height-100){document.querySelectorAll('ul.toc-ul li').forEach(removeLiListItem);var h2ID=h2Anchors[i].getAttribute('data-anchor');var checkLiAnchorText=document.querySelectorAll('ul.toc-ul li a');for(var j=0;j<checkLiAnchorText.length;j++){if(checkLiAnchorText[j].getAttribute('data-anchor')===h2ID){checkLiAnchorText[j].parentElement.classList.add('active_link');}}}}}};function isBelowArticleBottom(){if(!element_article_row)return;if(!element_right_rail.classList.contains('sticky_toc'))return false;var posWRTViewport=element_article_row.getBoundingClientRect().top+(window.pageYOffset||document.documentElement.scrollTop);articleBottom=(posWRTViewport+element_article_row.clientHeight);if(element_right_rail.classList.contains('bottom_toc')){rightRailBottom=window.scrollY+85+element_right_rail.clientHeight;}else{rightRailBottom=window.scrollY+element_right_rail.offsetTop+element_right_rail.clientHeight;}
var isBelow=rightRailBottom>articleBottom;return isBelow;}
function enableBottomFixation(){element_right_rail.classList.add("bottom_toc");var rightRailTopToc=(element_article_row.clientHeight-element_right_rail.clientHeight)+"px";element_right_rail.style.top=rightRailTopToc;}
function disableBottomFixation(){element_right_rail.classList.remove("bottom_toc"),(element_right_rail.style.top="");}
function filterID(str){return str.replace(/([\(\)?&:.,-])+/g,'\\\$1');};window.addEventListener('scroll',function(){if(window.innerWidth>=1024&&!element_right_rail.classList.contains('sticky_toc')&&(window.scrollY>=toc_position)){element_right_rail.classList.add('sticky_toc');}
if(window.scrollY<toc_position){element_right_rail.classList.remove('sticky_toc');}
if(isBelowArticleBottom()){if(!element_right_rail.classList.contains('bottom_toc')){enableBottomFixation();}}else{if(element_right_rail.classList.contains('bottom_toc')){disableBottomFixation();}}
highlightTocElement();setTocInitialTopAlignment();});function init(){setTocInitialTopAlignment();var qla=document.getElementsByClassName('quick-links');if(qla.length===0)return;var ql=qla[0];var a=document.getElementById('article-top-content');if(!a)return;var navElems=[];var html="";var html_prepend="<ul class='toc-ul' id='toc-ul'>";var html_append="</ul>"
var headers=getHeaders();for(var i=0;i<headers.length;i++){var h=headers[i];var text=h.innerText;text=text.replace(/[0-9]^\d\./,'').trim();navElems.push(text);var aID='article'+(i+1);var a=document.createElement('a');a.id=aID;h.parentNode.insertBefore(a,h);h.setAttribute('data-anchor',aID);var liClass=(i===0)?" class='active_link'":"";html=html+"<li"+liClass+"><a href='#' data-anchor='"+aID+"' onclick='mbt.quickLinks.scrollTo(\""+aID+"\", event)' class='h2-heading'>"+text+"</a></li>";}
var html=html_prepend+html+html_append;ql.innerHTML=html;var showQuickLinks=(navElems.length>=2)?true:false;var header_height;};window.onload=init();setTocInitialTopAlignment();return{setTocInitialTopAlignment:setTocInitialTopAlignment,highlightTocElement:highlightTocElement,scrollTo:scrollTo,init:init}}();