(function() {window.GUM_DOMAIN="gum.criteo.com";window.CONFIG_CSM_DOMAIN_NAME="client-side-metrics.da.us.criteo.net";window.CALLER_ID="891";window.CONFIG_JS_CALLBACK=cto_handleGumResponse_91c47616b3b44de69ea24fcd9624f74c;window.CONFIG_RTUS_RESPONSE_RECEIVED_TIMEOUT_MS=30000;var o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(t,n)};function n(t,n){function i(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}function t(r,u,s,c){return new(s=s||Promise)(function(t,n){function i(t){try{e(c.next(t))}catch(t){n(t)}}function o(t){try{e(c.throw(t))}catch(t){n(t)}}function e(n){n.done?t(n.value):new s(function(t){t(n.value)}).then(i,o)}e((c=c.apply(r,u||[])).next())})}function a(i,o){var e,r,u,t,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return t={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function n(n){return function(t){return function(n){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,r&&(u=2&n[0]?r.return:n[0]?r.throw||((u=r.return)&&u.call(r),0):r.next)&&!(u=u.call(r,n[1])).done)return u;switch(r=0,u&&(n=[2&n[0],u.value]),n[0]){case 0:case 1:u=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,r=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(u=0<(u=s.trys).length&&u[u.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3])){s.label=n[1];break}if(6===n[0]&&s.label<u[1]){s.label=u[1],u=n;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(n);break}u[2]&&s.ops.pop(),s.trys.pop();continue}n=o.call(i,s)}catch(t){n=[6,t],r=0}finally{e=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,t])}}}var d=["co.id","co.il","co.jp","co.kr","co.nz","co.th","co.uk","com.au","com.br","com.mx","com.my","com.pl","com.sg","com.tr","com.vn"];function v(t,n){if(!l(t))return null;for(var i=t.cookie.split(";"),o=0;o<i.length;o++){var e=i[o],r=e.substr(0,e.indexOf("=")).replace(/^\s+|\s+$/g,""),u=e.substr(e.indexOf("=")+1);if(r===n&&u)return decodeURIComponent(u)}return null}function e(t,n,i,o){var e=t.location.hostname;if(!l(t))return e;var r=new Date;r.setTime(r.getTime()+60*o*60*1e3);for(var u="expires="+r.toUTCString(),s=e.split("."),c=null,a=1;a<s.length;++a)if(c=s.slice(s.length-a-1,s.length).join("."),!(-1<d.indexOf(c))){var f="domain=."+c;try{t.cookie=n+"="+encodeURIComponent(i)+";"+u+";"+f+";path=/";var h=v(t,n);if(h&&h===i)break}catch(t){}}return c||e}function i(t,n){e(t,n,"",0)}function l(t){try{return void 0!==t.cookie}catch(t){return!1}}var m=function(){function t(t,n,i){void 0===i&&(i=function(t){}),this.tcfv1ConsentProvider=t,this.tcfv2ConsentProvider=n,this.logger=i}return t.prototype.getReadyToRetrieveProvider=function(){return this.tcfv2ConsentProvider.hasCallerFunctionInFrame()?this.tcfv2ConsentProvider:this.tcfv1ConsentProvider.hasCallerFunctionInFrame()?this.tcfv1ConsentProvider:void 0!==this.tcfv2ConsentProvider.getCMPFrame()?this.tcfv2ConsentProvider:void 0!==this.tcfv1ConsentProvider.getCMPFrame()?this.tcfv1ConsentProvider:void 0},t.prototype.retrieveConsentForPassback=function(t){var n=this.getReadyToRetrieveProvider();void 0===n&&(this.logger("No compatible GDPR privacy provider found"),t(void 0)),n===this.tcfv1ConsentProvider?this.tcfv1ConsentProvider.retrieveConsentForPassback(t):n===this.tcfv2ConsentProvider&&this.tcfv2ConsentProvider.retrieveConsent(t)},t.prototype.retrieveConsent=function(t){var n=this.getReadyToRetrieveProvider();void 0===n&&(this.logger("No compatible GDPR privacy provider found"),t(void 0)),null==n||n.retrieveConsent(t)},t.prototype.readyToRetrieve=function(){return this.tcfv2ConsentProvider.readyToRetrieve()||this.tcfv1ConsentProvider.readyToRetrieve()},t}();function c(t){try{return JSON.parse(t)}catch(t){return}}var f,r=91,p=function(){function t(t,n,i){void 0===i&&(i=function(t){}),this.cmpCallbacks={},this.currentWindow=t,this.timeout=n.tcfTimeout,this.pingTimeout=n.tcfPingTimeout,this.pingDelay=n.tcfPingDelay,this.cmpAutoDetect=n.cmpAutoDetect,this.logger=i}return t.prototype.getCMPFrame=function(){for(var t,n=this.currentWindow,i=0;i<10;++i){try{n.frames.__cmpLocator&&(t=n)}catch(t){}if(n===this.currentWindow.top)break;n=n.parent}return t},t.prototype.hasCallerFunctionInFrame=function(){return"function"==typeof this.currentWindow.__cmp},t.prototype.readyToRetrieve=function(){return this.hasCallerFunctionInFrame()||void 0!==this.getCMPFrame()},t.prototype.pingWithTimeout=function(o,t,n,i){function e(t,n){r.logger(n),clearTimeout(t),i()}var r=this;return window.setTimeout(function(){var i=window.setTimeout(function(){e(o,"Timeout: Unable to get ping return after "+t+"ms")},t);r.executeCommand("ping",null,function(t,n){clearTimeout(i),n?(r.logger("GDPR CMP ping returned"),!0!==t.cmpLoaded&&e(o,"GDPR ping returned cmpLoaded which is not true"),r.logger("GDPR ping returned cmpLoaded which is true")):e(o,"Error sending ping to GDPR CMP")})},n)},t.prototype.retrieveConsent=function(t){this.executeRetrieveConsent("getConsentData",null,t)},t.prototype.retrieveConsentForPassback=function(t){this.executeRetrieveConsent("getVendorConsents",[r],t)},t.prototype.executeRetrieveConsent=function(t,n,i){var o=this,e=!1,r=window.setTimeout(function(){e=!0,o.logger("Timeout: Unable to resolve GDPR consent after "+o.timeout+"ms"),i(void 0)},this.timeout),u=!1!==this.cmpAutoDetect?this.pingWithTimeout(r,this.pingTimeout,this.pingDelay,function(){e=!0,o.logger("Timeout: Unable to ping GDPR API after "+o.pingTimeout+"ms"),i(void 0)}):void 0;this.executeCommand(t,n,function(t,n){clearTimeout(u),e||(clearTimeout(r),n?(o.logger("GDPR consent retrieved"),o.processConsentData(t,i)):(o.logger("Error retrieving GDPR consent data from CMP"),i(void 0)))})},t.prototype.processConsentData=function(t,n){if(t){var i={};"undefined"===t.consentData&&(t.consentData=""),i.consentData=void 0!==t.consentData?t.consentData:"",void 0!==t.gdprApplies&&(i.gdprApplies=!!t.gdprApplies),n(i)}else this.logger("Unable to read GDPR consent data from CMP"),n(void 0)},t.prototype.executeCommand=function(t,n,i){var r=this;if(!this.hasCallerFunctionInFrame()){this.logger("No GDPR CMP defined on current frame");var u=this.getCMPFrame();this.currentWindow.__cmp=function(t,n,i){if(!u)return r.logger("GDPR CMP not found in any frame"),void i({msg:"GDPR CMP not found in any frame"},!1);var o=Math.random().toString(10),e={__cmpCall:{command:t,parameter:n,callId:o}};r.cmpCallbacks[o]=i,u.postMessage(e,"*")},this.currentWindow.addEventListener("message",function(t){var n="string"==typeof t.data?c(t.data):t.data;if(n&&n.__cmpReturn&&n.__cmpReturn.callId&&n.__cmpReturn.returnValue){var i=n.__cmpReturn;r.cmpCallbacks&&r.cmpCallbacks[i.callId]&&(r.cmpCallbacks[i.callId](i.returnValue,i.success),delete r.cmpCallbacks[i.callId])}},!1)}this.currentWindow.__cmp(t,n,i)},t}(),h=2;!function(t){t.LOADED="tcloaded",t.UI_SHOWN="cmpuishown",t.USER_ACTION_COMPLETE="useractioncomplete"}(f=f||{});var u,s,g=function(){function t(t,n,i){void 0===i&&(i=function(t){}),this.cmpCallbacks={},this.currentWindow=t,this.timeout=n.tcfTimeout,this.pingTimeout=n.tcfPingTimeout,this.pingDelay=n.tcfPingDelay,this.cmpAutoDetect=n.cmpAutoDetect,this.logger=i}return t.prototype.getCMPFrame=function(){for(var t,n=this.currentWindow,i=0;i<10;++i){try{n.frames.__tcfapiLocator&&(t=n)}catch(t){}if(n===this.currentWindow.top)break;n=n.parent}return t},t.prototype.hasCallerFunctionInFrame=function(){return"function"==typeof this.currentWindow.__tcfapi},t.prototype.readyToRetrieve=function(){return this.hasCallerFunctionInFrame()||void 0!==this.getCMPFrame()},t.prototype.pingWithTimeout=function(i,t,n,o){function e(t,n){r.logger(n),clearTimeout(t),o()}var r=this;return window.setTimeout(function(){var n=window.setTimeout(function(){e(i,"Timeout: Unable to get TCFv2 ping return after "+t+"ms")},t);r.executeCommand("ping",h,function(t){clearTimeout(n),r.logger("TCFv2 CMP ping returned in ms"),"error"===t.cmpStatus?e(i,"Error status on ping to TCFv2 CMP"):!0!==t.cmpLoaded?e(i,"TCFv2 ping returned cmpLoaded = false"):r.logger("TCFv2 ping returned cmpLoaded = true")})},n)},t.prototype.retrieveConsent=function(i){var o,e,r=this,u=!1,s=window.setTimeout(function(){u=!0,e===f.UI_SHOWN?(r.logger("Timeout: User hasn't confirm their consent settings after "+r.timeout+"ms"),i(o)):(r.logger("Timeout: Unable to resolve TCFv2 consent after "+r.timeout+"ms"),i(void 0))},this.timeout),c=!1!==this.cmpAutoDetect?this.pingWithTimeout(s,this.pingTimeout,this.pingDelay,function(){u=!0,r.logger("Timeout: Unable to ping TCFv2 API after "+r.pingTimeout+"ms"),i(void 0)}):void 0;this.executeCommand("addEventListener",h,function(t,n){clearTimeout(c),u||((e=t.eventStatus)!==f.UI_SHOWN&&clearTimeout(s),n?(r.logger("TCFv2 consent retrieved in ms"),t||(r.logger("Unable to read GDPR consent data from CMP"),i(void 0)),o=r.processResponseData(t),!1===t.gdprApplies&&void 0===e?i(o):e!==f.LOADED&&e!==f.USER_ACTION_COMPLETE||i(o)):(r.logger("Error retrieving TCFv2 consent data from CMP"),i(void 0)))})},t.prototype.processResponseData=function(t){var n,i,o={};return"undefined"===t.tcString&&(t.tcString=""),o.consentData=void 0!==t.tcString?t.tcString:"",void 0!==t.gdprApplies&&(o.gdprApplies=!!t.gdprApplies),o.version=t.tcfPolicyVersion?t.tcfPolicyVersion:h,o.purposes=null===(n=null==t?void 0:t.purpose)||void 0===n?void 0:n.consents,o.vendorConsents=null===(i=null==t?void 0:t.vendor)||void 0===i?void 0:i.consents,o},t.prototype.executeCommand=function(t,n,i,o){var u=this;if(!this.hasCallerFunctionInFrame()){this.logger("No TCFv2 CMP defined on current frame");var s=this.getCMPFrame();this.currentWindow.__tcfapi=function(t,n,i,o){if(!s)return u.logger("TCFv2 CMP not found in any frame"),void i({msg:"TCFv2 CMP not found in any frame"},!1);var e=Math.random().toString(10),r={__tcfapiCall:{command:t,version:n,parameter:o,callId:e}};u.cmpCallbacks[e]=i,s.postMessage(r,"*")},this.currentWindow.addEventListener("message",function(t){var n="string"==typeof t.data?c(t.data):t.data;if(n&&n.__tcfapiReturn&&n.__tcfapiReturn.callId&&n.__tcfapiReturn.returnValue){var i=n.__tcfapiReturn;u.cmpCallbacks&&u.cmpCallbacks[i.callId]&&"function"==typeof u.cmpCallbacks[i.callId]&&(u.cmpCallbacks[i.callId](i.returnValue,i.success),i.returnValue.eventStatus!==f.UI_SHOWN&&delete u.cmpCallbacks[i.callId])}},!1)}this.currentWindow.__tcfapi(t,n,i,o)},t}(),P=1,w=function(){function t(t,n,i){void 0===i&&(i=function(t){}),this.uspapiCallbacks={},this.currentWindow=t,this.timeout=n.uspApiTimeout,this.logger=i}return t.prototype.getCMPFrame=function(){for(var t,n=this.currentWindow,i=0;i<10;++i){try{n.frames.__uspapiLocator&&(t=n)}catch(t){}if(n===this.currentWindow.top)break;n=n.parent}return t},t.prototype.hasCallerFunctionInWindow=function(){return"function"==typeof this.currentWindow.__uspapi},t.prototype.readyToRetrieve=function(){return this.hasCallerFunctionInWindow()||void 0!==this.getCMPFrame()},t.prototype.retrieveConsent=function(i){var o=this,e=!1,r=window.setTimeout(function(){e=!0,o.logger("Timeout: Unable to resolve CCPA consent after "+o.timeout+"ms"),i(void 0)},this.timeout);this.executeCommand("getUSPData",P,function(t,n){e||(clearTimeout(r),n?(o.logger("CCPA consent retrieved"),o.processResponseData(t,i)):(o.logger("Error retrieving CCPA consent data from CMP"),i(void 0)))})},t.prototype.processResponseData=function(t,n){t?n(t):(this.logger("Unable to read CCPA consent data from CMP"),n(void 0))},t.prototype.executeCommand=function(t,n,i){var r=this;if(!this.hasCallerFunctionInWindow()){this.logger("No CCPA CMP defined on current frame");var u=this.getCMPFrame();this.currentWindow.__uspapi=function(t,n,i){if(!u)return r.logger("CCPA CMP not found in any frame"),void i({msg:"CCPA CMP not found in any frame"},!1);var o=Math.random().toString(10),e={__uspapiCall:{command:t,parameter:n,callId:o}};r.uspapiCallbacks[o]=i,u.postMessage(e,"*")},this.currentWindow.addEventListener("message",function(t){var n="string"==typeof t.data?c(t.data):t.data;if(n&&n.__uspapiReturn&&n.__uspapiReturn.callId&&n.__uspapiReturn.returnValue){var i=n.__uspapiReturn;r.uspapiCallbacks&&r.uspapiCallbacks[i.callId]&&(r.uspapiCallbacks[i.callId](i.returnValue,i.success),delete r.uspapiCallbacks[i.callId])}},!1)}this.currentWindow.__uspapi(t,n,i)},t.prototype.hasUserOptOut=function(t){return!(!t||!t.uspString||"1YNY"===t.uspString.toUpperCase()||"1YNN"===t.uspString.toUpperCase()||"1YN-"===t.uspString.toUpperCase()||"1-N-"===t.uspString.toUpperCase()||"1-NN"===t.uspString.toUpperCase()||"1-NY"===t.uspString.toUpperCase()||"1---"===t.uspString)},t}(),C="1.0",y="1.1",T=function(){function t(t,n,i){void 0===i&&(i=function(t){}),this.cmpCallbacks={},this.currentWindow=t,this.timeout=n.gppTimeout,this.pingTimeout=n.gppPingTimeout,this.pingDelay=n.gppPingDelay,this.logger=i}return t.prototype.getCMPFrame=function(){for(var t,n=this.currentWindow,i=0;i<10;++i){try{void 0!==n&&n.frames.__gppLocator&&(t=n)}catch(t){}if(n===this.currentWindow.top)break;n=n.parent}return t},t.prototype.hasCallerFunctionInFrame=function(){return"function"==typeof this.currentWindow.__gpp},t.prototype.readyToRetrieve=function(){return this.hasCallerFunctionInFrame()||void 0!==this.getCMPFrame()},t.prototype.retrieveConsent=function(i){function o(t,n){e.logger(n),clearTimeout(t),r=!0,e.logger("Timeout: Unable to ping GPP after "+e.pingTimeout+"ms"),i(void 0)}var e=this,r=!1,u=window.setTimeout(function(){r=!0,e.logger("Timeout: Unable to resolve GPP consent after "+e.timeout+"ms"),i(void 0)},this.timeout);window.setTimeout(function(){var n=window.setTimeout(function(){o(u,"Timeout: Unable to get GPP ping return after "+e.pingTimeout+"ms")},e.pingTimeout);e.executeCommand("ping",function(t){clearTimeout(n),e.logger("GPP CMP ping has responsed"),t.gppVersion===C?(e.logger("Detected GPP CMP 1.0"),"error"===t.cmpStatus?o(u,"Error status on ping to GPP CMP"):"loaded"===t.cmpStatus?(e.logger("GPP ping returned cmpStatus = loaded"),e.executeCommand("getGPPData",function(t,n){r||(clearTimeout(u),n?(e.logger("GPP consent retrieved"),e.processResponseData(t,i)):(e.logger("Error retrieving GPP consent data from CMP"),i(void 0)))})):o(u,"GPP ping returned cmpStatus != loaded")):t.gppVersion===y?(e.logger("Detected GPP CMP 1.1"),"ready"===t.signalStatus?(clearTimeout(u),e.logger("GPP consent retrieved"),e.processResponseData(t,i)):e.executeCommand("addEventListener",function(t,n){r||"signalStatus"===t.eventName&&"ready"===t.pingData.signalStatus&&(clearTimeout(u),e.logger("GPP consent retrieved"),e.processResponseData(t.pingData,i))})):o(u,"Unknown GPP version "+t.gppVersion)})},this.pingDelay)},t.prototype.processResponseData=function(t,n){if(t){var i={};void 0!==t.gppString&&(i.gpp=t.gppString),void 0!==t.applicableSections&&(i.gppSid=t.applicableSections),n(i)}else this.logger("Unable to read GPP consent data from CMP"),n(void 0)},t.prototype.executeCommand=function(t,n,i){var r=this;if(!this.hasCallerFunctionInFrame()){this.logger("No GPP CMP defined on current frame");var u=this.getCMPFrame();this.currentWindow.__gpp=function(t,n,i){if(!u)return r.logger("GPP CMP not found in any frame"),void n({msg:"GPP CMP not found in any frame"},!1);var o=Math.random().toString(10),e={__gppCall:{command:t,parameter:i,callId:o}};r.cmpCallbacks[o]=n,u.postMessage(e,"*")},this.currentWindow.addEventListener("message",function(t){var n="string"==typeof t.data?c(t.data):t.data;if(n&&n.__gppReturn&&n.__gppReturn.callId&&n.__gppReturn.returnValue){var i=n.__gppReturn;r.cmpCallbacks&&r.cmpCallbacks[i.callId]&&"function"==typeof r.cmpCallbacks[i.callId]&&(r.cmpCallbacks[i.callId](i.returnValue,i.success),delete r.cmpCallbacks[i.callId])}},!1)}this.currentWindow.__gpp(t,n,i)},t}(),b=function(){function t(t,n,i,o,e,r,u,s){void 0===n&&(n=1e4),void 0===i&&(i=50),void 0===o&&(o=1e3),void 0===e&&(e=50),void 0===r&&(r=1e4),void 0===u&&(u=50),void 0===s&&(s=1e3);var c={tcfTimeout:n,tcfPingTimeout:i,tcfPingDelay:o,uspApiTimeout:e,gppTimeout:r,gppPingTimeout:u,gppPingDelay:s},a={uspApiTimeout:n},f=new p(t,c),h=new g(t,c);this.tcfPrivacyProvider=new m(f,h),this.ccpaConsentProvider=new w(t,a),this.gppConsentProvider=new T(t,c)}return t.prototype.retrieveConsentGDPR=function(){return t.retrieveConsent(this.tcfPrivacyProvider)()},t.prototype.retrieveConsentCCPA=function(){return t.retrieveConsent(this.ccpaConsentProvider)()},t.prototype.retrieveConsentGPP=function(){return t.retrieveConsent(this.gppConsentProvider)()},t.retrieveConsent=function(i){return function(){return new Promise(function(t,n){i.readyToRetrieve()?i.retrieveConsent(t):t(void 0)})}},t}();!function(t){t[t.None=0]="None",t[t.Cookie=1]="Cookie",t[t.LocalStorage=2]="LocalStorage",t[t.Delegation=4]="Delegation"}(u=u||{}),function(t){t[t.Unknown=0]="Unknown",t[t.Deactivated=1]="Deactivated",t[t.Activated=2]="Activated"}(s=s||{});var M,D,G,R,S=function(){function t(t){this.userDataHandlers=t}return t.prototype.getLocalWebId=function(){return this.userDataHandlers.localWebId().fromAllStorages()},t.prototype.getOptOut=function(){return this.userDataHandlers.optOut().fromAllStorages()},t.prototype.getBundle=function(){return this.userDataHandlers.bundle().fromAllStorages()},t}(),U=function(){function n(t,n){this.value=t,this.origin=n}return n.fromUserIdentificationData=function(t){return new n(t.value,t.origin)},n.fromValue=function(t){return new n(t,u.None)},n.prototype.hasValue=function(){return""!==String(this.value)&&null!==this.value&&void 0!==this.value},n}(),F=function(u){function t(t,n,i,o,e){var r=u.call(this,i,o)||this;return r.storageKey=t,r.expirationTimeHours=n,r.storageAdapter=e,r}return n(t,u),t.prototype.hasValue=function(){return""!==String(this.value)&&null!==this.value&&void 0!==this.value},t.prototype.saveOnAllStorages=function(){if(this.hasValue()){var t="boolean"==typeof this.value?this.value?"1":"0":String(this.value);this.storageAdapter.writeToAllStorages(this.storageKey,t,this.expirationTimeHours)}},t.prototype.toJSON=function(){return{value:this.value,origin:this.origin}},t}(U),_=function(){function n(t){this.storageAdapter=t}return n.prototype.localWebId=function(){return this.createGuid(n.LWID_COOKIE_NAME)},n.prototype.optOut=function(){return new k(Boolean,n.OPTOUT_COOKIE_NAME,n.OPTOUT_RETENTION_TIME_HOUR,this.storageAdapter)},n.prototype.bundle=function(){return this.createGuid(n.BUNDLE_COOKIE_NAME)},n.prototype.createGuid=function(t){return new k(String,t,n.GUID_RETENTION_TIME_HOUR,this.storageAdapter)},n.LWID_COOKIE_NAME="cto_lwid",n.OPTOUT_COOKIE_NAME="cto_optout",n.BUNDLE_COOKIE_NAME="cto_bundle",n.GUID_RETENTION_TIME_HOUR=9360,n.OPTOUT_RETENTION_TIME_HOUR=43200,n}(),k=function(){function t(t,n,i,o){this.type=t,this.storageKey=n,this.expirationTimeHours=i,this.storageAdapter=o}return t.prototype.fromAllStorages=function(){var t=this.storageAdapter.readFromAllStorages(this.storageKey),n="boolean"==typeof(new this.type).valueOf()?"1"===t.value:t.value;return this.create(n,t.origin)},t.prototype.fromValue=function(t){return this.create(t,u.None)},t.prototype.removeFromAllStorages=function(){this.storageAdapter.removeFromAllStorages(this.storageKey)},t.prototype.create=function(t,n){return new F(this.storageKey,this.expirationTimeHours,t,n,this.storageAdapter)},t}(),E=function(){function t(t,n,i){this.criteoGlobalVendorListId=91,this.window=t,this.document=t.document,this.userDataHandlers=new _(n),i=null!=i?i:"gum.criteo.com",this.syncframeOrigin="https://"+i,this.syncframeEndpoint="https://"+i+"/syncframe",this.window.criteo_syncframe_state||(this.window.criteo_syncframe_state={syncframeRequested:!1}),this.window.criteo_syncframe_state.appendSyncframeRequestQueue||(this.window.criteo_syncframe_state.appendSyncframeRequestQueue=[])}return t.prototype.getSyncframeListener=function(i,o){var e=this;return function(t){if(!e.discardMessageFromOtherFrames(t)||e.window.criteo_syncframe_state.ForceSyncframeMessageHandling){var n=t.data;(null==n?void 0:n.requestId)===i&&(t.stopImmediatePropagation(),e.handleSyncframeResponse(n,o),e.window.criteo_syncframe_state.firstSyncframeCompleted=!0,e.window.criteo_syncframe_state.syncframeRequested=!1,e.tryUnqueueAppendSyncframeRequests())}}},t.prototype.userBundleHasAlreadyBeenRetrieved=function(){return this.userDataHandlers.bundle().fromAllStorages().hasValue()},t.prototype.canDropSyncframe=function(){return!this.window.criteo_syncframe_state.syncframeRequested},t.prototype.discardMessageFromOtherFrames=function(t){return!t.data||t.origin!=this.syncframeOrigin},t.prototype.appendGumIframeIfDoesNotExist=function(t,n,i){var o,e=this;!0===(null===(o=this.window.criteo_syncframe_state)||void 0===o?void 0:o.firstSyncframeCompleted)||this.userBundleHasAlreadyBeenRetrieved()?this.appendGumIframe(t,n,i):this.canDropSyncframe()?this.appendGumIframe(t,n,i):this.queueAppendSyncframeRequest(function(){return e.appendGumIframeIfDoesNotExist(t,n,i)})},t.prototype.doOnCompletedDom=function(t){var n=this;if(this.window.addEventListener)if("complete"===this.document.readyState)t();else{var i=function(){n.window.removeEventListener("load",i),n.document.removeEventListener("DOMContentLoaded",i),t()};this.window.addEventListener("load",i,!1),this.document.addEventListener("DOMContentLoaded",i,!1)}},t.prototype.appendGumIframe=function(t,n,i){n();var o=t();if(this.consentAllowsSyncframeToBeDropped(o.consent)){this.window.addEventListener("message",this.getSyncframeListener(o.requestId,i),!0);var e=this.createIFrame(o);this.document.body.appendChild(e),this.window.criteo_syncframe_state.syncframeRequested=!0}else this.handleSyncframeResponse({},i)},t.prototype.consentAllowsSyncframeToBeDropped=function(t){var n;return 2!==(null==t?void 0:t.gdprVersion)||!0!==(null==t?void 0:t.gdprApplies)||!0===(null===(n=null==t?void 0:t.vendorConsents)||void 0===n?void 0:n[this.criteoGlobalVendorListId])},t.prototype.queueAppendSyncframeRequest=function(t){void 0!==this.window.criteo_syncframe_state.appendSyncframeRequestQueue&&this.window.criteo_syncframe_state.appendSyncframeRequestQueue.push(t)},t.prototype.tryUnqueueAppendSyncframeRequests=function(){for(var t,n,i=null===(t=this.window.criteo_syncframe_state.appendSyncframeRequestQueue)||void 0===t?void 0:t.shift();void 0!==i;)i(),i=null===(n=this.window.criteo_syncframe_state.appendSyncframeRequestQueue)||void 0===n?void 0:n.shift()},t.prototype.createIFrame=function(t){var n,i=this.document.createElement("iframe"),o={bundle:t.bundle,optout:t.optoutCookie,tld:t.topLevelDomain,topUrl:t.topUrl,version:"string"==typeof t.version?null===(n=t.version)||void 0===n?void 0:n.replace(/\./g,"_"):t.version,origin:t.origin,pm:t.privateMode,rtusCallerId:t.rtusCallerId,requestId:t.requestId},e=[];return e.push("origin="+t.origin),e.push("topUrl="+t.topUrl),t.consent&&(void 0!==t.consent.gdprApplies&&e.push("gdpr="+(t.consent.gdprApplies?1:0)),void 0!==t.consent.consentData&&e.push("gdpr_consent="+t.consent.consentData),void 0!==t.consent.uspString&&e.push("us_privacy="+t.consent.uspString),void 0!==t.consent.gppString&&e.push("gpp="+t.consent.gppString),void 0!==t.consent.gppSectionIds&&e.push("gpp_sid="+t.consent.gppSectionIds)),t.isDebug&&e.push("debug=1"),i.src=this.syncframeEndpoint+"?"+e.join("&")+"#"+JSON.stringify(o),i.width="0",i.height="0",i.frameBorder="0",i.style.borderWidth="0px",i.style.margin="0px",i.style.display="none",i.setAttribute("sandbox","allow-scripts allow-same-origin"),i.setAttribute("aria-hidden","true"),i.title="Criteo GUM iframe",i},t}(),N=function(e){function t(t,n){var i,o=e.call(this,n,t.storageAdapter,null===(i=n)||void 0===i?void 0:i.GUM_DOMAIN)||this;return o.adapter=t,o.adapter=t,o}return n(t,e),t.prototype.discardMessageFromOtherFrames=function(t){return e.prototype.discardMessageFromOtherFrames.call(this,t)||!("function"==typeof this.window.fetch)},t.prototype.handleSyncframeResponse=function(t){t.optout?(this.adapter.logCounter("Origin.FromSyncframeOptout"),this.userDataHandlers.optOut().fromValue(!0).saveOnAllStorages(),this.userDataHandlers.bundle().removeFromAllStorages()):(t.bundle&&(this.adapter.logCounter("Origin.FromSyncframeBundle"),this.userDataHandlers.bundle().fromValue(t.bundle).saveOnAllStorages()),t.bundle||this.adapter.sendMetrics()),this.adapter.onSyncframeResponseHandled()},t.prototype.fetchUserData=function(){return new S(this.userDataHandlers)},t.prototype.appendGumIFrameOnCompletedDomIfItDoesNotExist=function(t){var n=this,i=Math.random().toString();this.doOnCompletedDom(function(){return n.appendGumIframeIfDoesNotExist(function(){return n.createSyncframeRequest(t(),i)},function(){return n.adapter.logCounter("Events.SyncframeDropped")})})},t.prototype.createSyncframeRequest=function(t,n){return{bundle:this.userDataHandlers.bundle().fromAllStorages().toJSON(),optoutCookie:this.userDataHandlers.optOut().fromAllStorages().toJSON(),topLevelDomain:t.topLevelDomain,topUrl:t.topUrl,version:void 0,canWriteCookie:t.canWriteCookie,canWriteLocalStorage:t.canWriteLocalStorage,origin:"rtus",privateMode:void 0,consent:t.consent,rtusCallerId:parseInt(this.window.CALLER_ID,10),isDebug:!1,requestId:n}},t}(E),I=function(){function t(t){this.window=t}return t.prototype.setItem=function(t,n){if(this.hasStorages())try{this.window.localStorage.setItem(t,n)}catch(t){}},t.prototype.getItem=function(t){return this.hasStorages()?this.window.localStorage.getItem(t):null},t.prototype.removeItem=function(t){if(this.hasStorages())return this.window.localStorage.removeItem(t)},t.prototype.hasStorages=function(){try{return this.window.localStorage&&this.window.sessionStorage}catch(t){return!1}},t}(),A=function(){function t(){this.storage=new I(window)}return t.prototype.readFromAllStorages=function(t){var n=v(document,t),i=this.storage.getItem(t);return n||i?{value:n||i,origin:(n&&u.Cookie)|(i&&u.LocalStorage)}:{value:null,origin:u.None}},t.prototype.removeFromAllStorages=function(t){i(document,t),this.storage.removeItem(t)},t.prototype.writeToAllStorages=function(t,n,i){e(document,t,n,i),this.storage.setItem(t,n)},t}(),O=function(){function t(t,n,i){var o=this;void 0===n&&(n=""),void 0===i&&(i=100),this._eventsQueue=[],this.CSM_BASE_DOMAIN=t,this.SAMPLING_RATIO=i||100,this.METRIC_PREFIX=n||"",window.addEventListener("pagehide",function(){return o.flushEventQueue()})}return t.prototype.logCounter=function(t){var n="entry=c~"+(this.METRIC_PREFIX?this.METRIC_PREFIX+".":"")+(t||"")+"~1";this._eventsQueue.push(n)},t.prototype.logHistogram=function(t,n){var i="entry=h~"+(this.METRIC_PREFIX?this.METRIC_PREFIX+".":"")+(t||"")+"~"+n;this._eventsQueue.push(i)},t.prototype.logError=function(t,n,i){void 0===i&&(i=null);var o=n&&n.message||n,e="string"==typeof i?[i]:i,r=[this.METRIC_PREFIX,t].concat(e).reduce(function(t,n){return t.concat(n&&n.split(".")||[])},[]).filter(function(t){return null!=t&&null!=t&&""!=t}).map(function(t){return"&tag="+encodeURIComponent(t)}).join(""),u="https://"+this.CSM_BASE_DOMAIN+"/iex?gPath="+(this.METRIC_PREFIX?this.METRIC_PREFIX+".":"")+encodeURIComponent(t)+"&msg="+encodeURIComponent(o)+r;this.logPixel(u)},t.prototype.sendMetrics=function(){this.flushEventQueue()},t.prototype.flushEventQueue=function(){if(0<this._eventsQueue.length){var t="https://"+this.CSM_BASE_DOMAIN+"/iev?"+this._eventsQueue.join("&");this.logPixel(t),this._eventsQueue=[]}},t.prototype.logPixel=function(t){if(!this.CSM_BASE_DOMAIN)return console.log("Pixel",t);var n=Math.floor(100*Math.random());this.SAMPLING_RATIO<=n||("function"==typeof navigator.sendBeacon?navigator.sendBeacon(t):(new Image).src=t)},t}(),L=new b(window),x=new I(window),J=document.currentScript.src,W="cto_rtus",B=W+"_"+window.CALLER_ID,Y=/\(({[^}]*})\)/g,H=!1,V=!1,j={status:"Unknown",userid:""},q=null!==(D=null===(M=window.CRTO_DEPENDENCIES)||void 0===M?void 0:M.RTUS_CSM_CLIENT)&&void 0!==D?D:new O(window.CONFIG_CSM_DOMAIN_NAME,"Idfs.Rtus",10),z=new N({logCounter:ct,onSyncframeResponseHandled:function(){var t=z.fetchUserData(),n=t.getOptOut(),i=t.getBundle();at("Duration.BeforeRtusFetchFromNewSyncframe",R),K(n,i).then(function(){at("Duration.AfterRtusFetchFromNewSyncframe",R),ct("Events.AfterRtusFetchFromNewSyncframe")}).then(function(){return ut("FromNewSyncframe")})},sendMetrics:ht,removeRtusResponse:function(){x.removeItem(W),x.removeItem(B)},storageAdapter:new A},window),$=function(){return x.getItem(B)||x.getItem(W)};function K(t,n){if(V)return ht(),Promise.resolve();V=!0;var i=new Headers;return t.value&&(i.set("x-crto-optout","1"),ct("Headers.Optout")),n.hasValue()&&(i.set("x-crto-bundle",n.value),ct("Headers.Bundle")),ct("Events.InitiateFetch"),fetch(J,{headers:i,cache:"reload",mode:"cors"}).then(function(t){return t.text()}).then(function(t){if(!(0<t.indexOf('"status":"Unknown"'))){var n=Y.exec(t);n&&n[1]?(x.setItem(B,n[1]),ct("Events.SaveResponseOnLocalStorage")):ft("Events.JsonpParseError","JSONP could not be parsed"+t.slice(0,200))}}).catch(ct.bind(null,"Events.FetchError")).then(ht)}function Q(t){try{return JSON.parse(t)}catch(t){return ft("Events.JsonParseError",t),null}}function X(){var t=e(document,"cto_tld_test","test",1);return i(document,"cto_tld_test"),t}function Z(){return nt(function(t,n,i){return e(document,t,n,i)},function(t){return v(document,t)},function(t){return i(document,t)})}function tt(){return nt(function(t,n,i){return x.setItem(t,n)},function(t){return x.getItem(t)},function(t){return x.removeItem(t)})}function nt(t,n,i){t("cto_write_test","testWrite",1);var o="testWrite"===n("cto_write_test");return i("cto_write_test"),o}function it(t,n,i,o,e){var r,u=ot(et(rt(window))),s=encodeURIComponent(u);return{topLevelDomain:X(),topUrl:s,canWriteCookie:t,canWriteLocalStorage:n,consent:{gdprApplies:null==i?void 0:i.gdprApplies,consentData:null==i?void 0:i.consentData,gdprVersion:null==i?void 0:i.version,vendorConsents:null==i?void 0:i.vendorConsents,uspString:null==o?void 0:o.uspString,ccpaVersion:null==o?void 0:o.version,gppString:null==e?void 0:e.gpp,gppSectionIds:null===(r=null==e?void 0:e.gppSid)||void 0===r?void 0:r.join(",")}}}function ot(t){var n=document.createElement("a");return n.href=t,n.hostname}function et(t){var n=t.topFrame,i="";if(t.err)try{try{i=n.top.location.href}catch(t){var o=n.location.ancestorOrigins;i=o[o.length-1]}}catch(t){i=n.document.referrer}else i=n.location.href;return i}function rt(t){var n=t,i=!1;try{for(;n.parent.document!==n.document;){if(!n.parent.document){i=!0;break}n=n.parent}}catch(t){i=!0}return{topFrame:n,err:i}}function ut(t){if(clearTimeout(G),H)return!1;var n=$();if(at("Duration.CallClientCallback."+window.CONFIG_RTUS_RESPONSE_RECEIVED_TIMEOUT_MS,R),at("Duration.CallClientCallbackByOrigin."+t+"."+window.CONFIG_RTUS_RESPONSE_RECEIVED_TIMEOUT_MS,R),n){var i=Q(n);if(null==i)return!1;window.CONFIG_JS_CALLBACK(i),ct("Origin."+t+".Valid")}else window.CONFIG_JS_CALLBACK(j),ct("Origin."+t+".Unknown");H=!0,ht()}function st(){return t(this,void 0,void 0,function(){var n,i,o,e,r,u,s,c;return a(this,function(t){switch(t.label){case 0:return ct("Events.StartInit"),R=Date.now(),n=z.fetchUserData(),i=n.getOptOut(),o=n.getBundle(),e=Z(),r=tt(),[4,L.retrieveConsentGDPR()];case 1:return u=t.sent(),[4,L.retrieveConsentCCPA()];case 2:return s=t.sent(),[4,L.retrieveConsentGPP()];case 3:return c=t.sent(),G=setTimeout(function(){ct("Events.Timeout."+window.CONFIG_RTUS_RESPONSE_RECEIVED_TIMEOUT_MS),ut("FromTimeout")},window.CONFIG_RTUS_RESPONSE_RECEIVED_TIMEOUT_MS),z.appendGumIFrameOnCompletedDomIfItDoesNotExist(function(){return it(e,r,u,s,c)}),$()?ut("FromLocalRtusResponse"):(i.value||o.hasValue())&&K(i,o).then(function(){at("Duration.AfterRtusFetchFromCachedSyncframe",R),ct("Events.AfterRtusFetchFromCachedSyncframe")}).then(function(){return ut("FromCachedSyncframe")}),ht(),[2]}})})}function ct(t){q.logCounter(t)}function at(t,n){q.logHistogram(t,Date.now()-n)}function ft(t,n){q.logError(t,n)}function ht(){q.sendMetrics()}st();
})();