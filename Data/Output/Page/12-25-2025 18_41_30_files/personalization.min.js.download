var liveRampTimeOut=700,global_liveRampResponse="",global_idlValue="",liveRampResp="",liveRamp_RespTime="",cuuid="",liveRampIndicator={callStatus:"-",idlResponse:"-",idlLinkInOS:"0",responseTime:""};function getCUUID(){for(var e="CUUID=",i=decodeURIComponent(document.cookie).split(";"),t=0;t<i.length;t++){for(var n=i[t];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(e)&&null!=n.substring(e.length)&&void 0!=n.substring(e.length)&&""!=n.substring(e.length)){var r=n.substring(e.length);return console.log("Old CuuidCookie",r),r}}let o=new Date;o.setTime(o.getTime()+31536e6);let l=newCookie();document.cookie="CUUID="+l+"; expires="+o.toUTCString()+"; path=/;domain="+location.hostname,console.log("CUUIDCookie",l)}function newCookie(){options={};var e=rng();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,bytesToUuid(e)}function rng(){var e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(e){var i=new Uint8Array(16);return e(i),i}for(var t,n=Array(16),r=0;r<16;r++)(3&r)==0&&(t=4294967296*Math.random()),n[r]=t>>>((3&r)<<3)&255;return n}function bytesToUuid(e){for(var i=[],t=0;t<256;++t)i[t]=(t+256).toString(16).substr(1);var t=0,n=i;return[n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],"-",n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]],n[e[t++]]].join("")}function getCookie(e){for(var i=e+"=",t=document.cookie.split(";"),n=0;n<t.length;n++){for(var r=t[n];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(i))return r.substring(i.length,r.length)}return""}function httpCall(e,i,t,n){var r=new XMLHttpRequest;-1!=i.indexOf("identity")&&(r.withCredentials=!0),r.open(e,i,t),-1!=n&&(r.timeout=n);var o=new Date().getTime();return r.onload=function(){if(r.readyState===r.DONE&&200===r.status){if(-1!=i.indexOf("identity")){if(liveRamp_RespTime=new Date().getTime()-o,liveRampIndicator.callStatus="1",liveRampIndicator.responseTime=liveRamp_RespTime,null!=(liveRampResp=r.response)&&""!=liveRampResp&&void 0!=liveRampResp){var e=JSON.parse(global_liveRampResponse=liveRampResp),t=e.idl.substring(0,2);liveRampIndicator.idlResponse=""!=t?"XY"==t?1:"Xc"==t?2:"Xi"==t?3:"-":"0",validateLiveRampResponse(global_liveRampResponse,e)}else liveRampIndicator.idlResponse="0"}return r.response}},r.ontimeout=function(e){if(console.log("timeout error for url:"+i+"error:"+e),-1!=i.indexOf("identity")){console.log("timeout error for LiveRamp Call:"+i+"error:"+e),liveRampIndicator.callStatus="0";try{liveRampIndicator.responseTime=new Date().getTime()-o}catch(t){console.log("Error occurs in response time",t.message)}}return -1},r.onerror=function(e){if(console.log("error for url:"+i+"error:"+e),-1!=i.indexOf("identity")){console.log("timeout error for LiveRamp Call:"+i+"error:"+e),liveRampIndicator.callStatus="0";try{liveRampIndicator.responseTime=new Date().getTime()-o}catch(t){console.log("Error occurs in response time",t.message)}}return -1},r.send(null),r.response}function fireLiveRampCall(){new Date().getTime();var e=httpCall("GET","https://api.rlcdn.com/api/identity?pid=1&rt=idl",!0,liveRampTimeOut),i=new Date().getTime();console.log("location: banner.js, Live Ramp call successful, response is",e+"end time",i)}function validateLiveRampResponse(e,i){var t=!1,n="",r=!1,o=!1,l={blackListKeywords:["script","embed","object"],whiteListVariables:["idl"]};for(let a=0;a<l.blackListKeywords.length;a++)if(r=-1!=e.indexOf(l.blackListKeywords[a]))return t;for(let s=0;s<l.whiteListVariables.length;s++)(o=!!i[l.whiteListVariables[s]])&&(global_idlValue=n=i[l.whiteListVariables[s]],t=!0);return t}function setLiveRampPixel(){new Promise(e=>{var i=document.createElement("IMG");cuuid=getCUUID();var t="https://idsync.rlcdn.com/463166.gif?partner_uid";t=t+"="+cuuid,i.setAttribute("src",t),i.addEventListener("load",function(){e(i)}),i.addEventListener("error",function(){e(null)}),i.addEventListener("abort",function(){e(null)}),setTimeout(function(){e(null)},liveRampTimeOut)}).then(e=>{e||console.log("Pixel load timed out. Triggering the idl api call"),fireLiveRampCall()}).catch(e=>{console.log("Pixel failed. Triggering the idl api call ",e),fireLiveRampCall()})}function getClientIP(){fetch("https://api.ipify.org/?format=json").then(e=>e.json()).then(e=>global_clientIP=e)}setLiveRampPixel(),getClientIP();