//tealium universal tag - utag.sync ut4.0.202512120400, Copyright 2025 Tealium.com Inc. All Rights Reserved.
try{try{if(window.location.hostname.toLowerCase()==="aem-pwa-prod5.us.bank-dns.com"){document.cookie="privacy_optout=1";}}catch(e){console.log(e)}}catch(e){console.log(e);}
try{try{(function(exports){try{const secureAdobeHost='smetrics.usbank.com';const hostname=window.location.hostname;exports.usbAnalyticsConfig={adobe:{analytics:{trackingServer:'metrics.usbank.com',trackingServerSecure:secureAdobeHost,},edgeAdapter:{properties:{},},orgId:'675616D751E567410A490D4C@AdobeOrg',websdk:{datastreamId:'d99cf7a5-a3a0-418f-999e-9f2b559f214b',edgeDomain:secureAdobeHost,},},cookieDomain:'.usbank.com',environment:'prod',ispot:{baseUrl:'pt.ispot.tv',retailSiteId:'TC-3676-2',rpsSiteId:'TC-3676-4',},privacy:{isOptedOut:!!window.navigator.globalPrivacyControl||document.cookie.indexOf('privacy_optout')>-1},};}catch(err){console.error(err);}})(window);}catch(e){console.log(e)}}catch(e){console.log(e);}
try{try{window.usbAnalytics=window.usbAnalytics||[];}catch(e){console.log(e)}}catch(e){console.log(e);}
try{try{(function(config){try{if(config.privacy.isOptedOut){return;}
!function(n,o){o.forEach(function(o){n[o]||((n.__alloyNS=n.__alloyNS||[]).push(o),n[o]=function(){var u=arguments;return new Promise(function(i,l){n[o].q.push([i,l,u])})},n[o].q=[])})}(window,["alloy"]);}catch(err){console.error(err);}})(window.usbAnalyticsConfig);}catch(e){console.log(e)}}catch(e){console.log(e);}
try{try{(function(alloy,config){try{if(config.privacy.isOptedOut){return;}
alloy('configure',{datastreamId:config.adobe.websdk.datastreamId,orgId:config.adobe.orgId,targetMigrationEnabled:true,idMigrationEnabled:true,edgeDomain:config.adobe.websdk.edgeDomain,context:["web","device","environment","placeContext","highEntropyUserAgentHints"],prehidingStyle:'body { opacity: 0 !important }',clickCollectionEnabled:false,});}catch(err){console.error(err);}})(window.alloy,window.usbAnalyticsConfig);}catch(e){console.log(e)}}catch(e){console.log(e);}
try{try{window.adobe??={};window.adobe.target??={};window.adobe.target.trackEvent=()=>{};window.adobe.target.event={"LIBRARY_LOADED":"at-library-loaded","REQUEST_START":"at-request-start","REQUEST_SUCCEEDED":"at-request-succeeded","REQUEST_FAILED":"at-request-failed","CONTENT_RENDERING_START":"at-content-rendering-start","CONTENT_RENDERING_SUCCEEDED":"at-content-rendering-succeeded","CONTENT_RENDERING_FAILED":"at-content-rendering-failed","CONTENT_RENDERING_NO_OFFERS":"at-content-rendering-no-offers","CONTENT_RENDERING_REDIRECT":"at-content-rendering-redirect",}
window.adobe.target.getOffer=({mbox="__view__",params={},success=null,error=null,timeout=2000})=>{if(typeof alloy!=="function"){return;}
var timeoutId=-1;let mboxParams={__adobe:{target:{}}};if(typeof error==="function"){timeoutId=setTimeout(()=>{const msg=`Timeout reached for mbox ${mbox}`;error(msg);},timeout);}
Object.assign(mboxParams.__adobe.target,params);alloy("sendEvent",{renderDecisions:true,type:'decisioning.propositionFetch',decisionScopes:[mbox],data:mboxParams}).then(result=>{const{propositions}=result;let decision=[];let displayedProps=[];if(Array.isArray(propositions)){propositions.forEach((proposition)=>{if(proposition.items.length){proposition.items.forEach((e)=>{try{decision.push({scope:proposition.scope,action:e.data&&e?.data?.format&&(e?.data?.format.includes("json")?"setJson":e?.data?.format),content:e.data&&e?.data?.content&&[e?.data?.content],activity:e.meta&&e.meta["activity.name"],experience:e.meta&&e.meta["experience.name"],id:e.data?e.data.id:""});}catch(error){}});}
displayedProps.push({id:proposition.id,scope:proposition.scope,scopeDetails:proposition.scopeDetails});});if(typeof success==="function"){clearTimeout(timeoutId);success(decision);}
if(displayedProps.length>0){alloy("sendEvent",{xdm:{eventType:"decisioning.propositionDisplay",_experience:{decisioning:{propositions:displayedProps}}}});}
let eventDetail={mbox:mbox,redirect:false,type:"at-request-succeeded",responseTokens:result.propositions.filter(p=>p.items.length).map(p=>p.items.map(i=>i.meta)).flat()}
var atSucceededEvent=new CustomEvent("at-request-succeeded",{detail:eventDetail});document.dispatchEvent(atSucceededEvent);var decisionsReturned=new CustomEvent('_waDecisionsReturned',{detail:eventDetail});document.dispatchEvent(decisionsReturned);};}).catch(e=>{if(timeoutId>-1){clearTimeout(timeoutId)}
let display=String.fromCodePoint(0x1F7E5)+'\t Error making call to Target: '+e;if(typeof error==="function"){error(display);}});}}catch(e){console.log(e)}}catch(e){console.log(e);}
try{try{(function(alloy,config,atData={}){try{let{target}=atData;if(config.privacy.isOptedOut){return;}
alloy('sendEvent',{type:'decisioning.propositionFetch',renderDecisions:true,personalization:{sendDisplayEvent:false,sendDisplayNotifications:false,},}).then(()=>{window.dispatchEvent(new CustomEvent(window.adobe.target.event.CONTENT_RENDERING_SUCCEEDED));}).catch(error=>{console.error(error);});}catch(err){console.error(err);}})(window.alloy,window.usbAnalyticsConfig,window.adobe);}catch(e){console.log(e)}}catch(e){console.log(e);}
try{try{(function(config){try{if(config.privacy.isOptedOut){return;}
!function(){"use strict";function e(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function n(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void t(e)}c.done?n(u):Promise.resolve(u).then(r,o)}function t(e,n,t){return(n=s(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?r(Object(o),!0).forEach((function(n){t(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==n.indexOf(r))continue;t[r]=e[r]}return t}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],-1===n.indexOf(t)&&{}.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function a(){a=function(){return n};var e,n={},t=Object.prototype,r=t.hasOwnProperty,o=Object.defineProperty||function(e,n,t){e[n]=t.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function d(e,n,t){return Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[n]}try{d({},"")}catch(e){d=function(e,n,t){return e[n]=t}}function l(e,n,t,r){var i=n&&n.prototype instanceof y?n:y,a=Object.create(i.prototype),c=new N(r||[]);return o(a,"_invoke",{value:P(e,t,c)}),a}function f(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(e){return{type:"throw",arg:e}}}n.wrap=l;var p="suspendedStart",g="suspendedYield",v="executing",m="completed",h={};function y(){}function w(){}function b(){}var E={};d(E,c,(function(){return this}));var C=Object.getPrototypeOf,I=C&&C(C(A([])));I&&I!==t&&r.call(I,c)&&(E=I);var k=b.prototype=y.prototype=Object.create(E);function S(e){["next","throw","return"].forEach((function(n){d(e,n,(function(e){return this._invoke(n,e)}))}))}function D(e,n){function t(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var s=u.arg,d=s.value;return d&&"object"==typeof d&&r.call(d,"__await")?n.resolve(d.__await).then((function(e){t("next",e,a,c)}),(function(e){t("throw",e,a,c)})):n.resolve(d).then((function(e){s.value=e,a(s)}),(function(e){return t("throw",e,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new n((function(n,o){t(e,r,n,o)}))}return i=i?i.then(o,o):o()}})}function P(n,t,r){var o=p;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var u=T(c,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=v;var s=f(n,t,r);if("normal"===s.type){if(o=r.done?m:g,s.arg===h)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=m,r.method="throw",r.arg=s.arg)}}}function T(n,t){var r=t.method,o=n.iterator[r];if(o===e)return t.delegate=null,"throw"===r&&n.iterator.return&&(t.method="return",t.arg=e,T(n,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=f(o,n.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var a=i.arg;return a?a.done?(t[n.resultName]=a.value,t.next=n.nextLoc,"return"!==t.method&&(t.method="next",t.arg=e),t.delegate=null,h):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function O(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function R(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function A(n){if(n||""===n){var t=n[c];if(t)return t.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,i=function t(){for(;++o<n.length;)if(r.call(n,o))return t.value=n[o],t.done=!1,t;return t.value=e,t.done=!0,t};return i.next=i}}throw new TypeError(typeof n+" is not iterable")}return w.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:w,configurable:!0}),w.displayName=d(b,s,"GeneratorFunction"),n.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===w||"GeneratorFunction"===(n.displayName||n.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,d(e,s,"GeneratorFunction")),e.prototype=Object.create(k),e},n.awrap=function(e){return{__await:e}},S(D.prototype),d(D.prototype,u,(function(){return this})),n.AsyncIterator=D,n.async=function(e,t,r,o,i){void 0===i&&(i=Promise);var a=new D(l(e,t,r,o),i);return n.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(k),d(k,s,"Generator"),d(k,c,(function(){return this})),d(k,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var n=Object(e),t=[];for(var r in n)t.push(r);return t.reverse(),function e(){for(;t.length;){var r=t.pop();if(r in n)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=A,N.prototype={constructor:N,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!n)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var t=this;function o(r,o){return c.type="throw",c.arg=n,t.next=r,o&&(t.method="next",t.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=n,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),h},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),R(t),h}},catch:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===e){var r=t.completion;if("throw"===r.type){var o=r.arg;R(t)}return o}}throw Error("illegal catch attempt")},delegateYield:function(n,t,r){return this.delegate={iterator:A(n),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=e),h}},n}function c(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i,a,c=[],u=!0,s=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;u=!1}else for(;!(u=(r=i.call(t)).done)&&(c.push(r.value),c.length!==n);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,n)||l(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(n){return function(n){if(Array.isArray(n))return e(n)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||l(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:n+""}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function l(n,t){if(n){if("string"==typeof n)return e(n,t);var r={}.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(n,t):void 0}}var f=function(e){return null==e},p=function(e){return!f(e)&&!Array.isArray(e)&&"object"===d(e)},g=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.length<2?Object.assign.apply(Object,n):n.reduce((function(e,n){return p(n)&&Object.keys(n).forEach((function(t){var r;Array.isArray(n[t])?Array.isArray(e[t])?(r=e[t]).push.apply(r,u(n[t])):e[t]=u(n[t]):e[t]=n[t]})),e}))};function v(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)e[r]=t[r]}return e}var m,h,y=function e(n,t){function r(e,r,o){if("undefined"!=typeof document){"number"==typeof(o=v({},t,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var a in o)o[a]&&(i+="; "+a,!0!==o[a]&&(i+="="+o[a].split(";")[0]));return document.cookie=e+"="+n.write(r,e)+i}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],r={},o=0;o<t.length;o++){var i=t[o].split("="),a=i.slice(1).join("=");try{var c=decodeURIComponent(i[0]);if(r[c]=n.read(a,c),e===c)break}catch(e){}}return e?r[e]:r}},remove:function(e,n){r(e,"",v({},n,{expires:-1}))},withAttributes:function(n){return e(this.converter,v({},this.attributes,n))},withConverter:function(n){return e(v({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(n)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),w={get:y.get.bind(y),set:y.set.bind(y),remove:y.remove.bind(y),withConverter:y.withConverter.bind(y)},b=function(e,n){Object.keys(n).forEach((function(t){p(e[t])&&p(n[t])?b(e[t],n[t]):e[t]=n[t]}))},E=function(e){if(f(e))throw new TypeError('deepAssign "target" cannot be null or undefined');for(var n=Object(e),t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return r.forEach((function(e){return b(n,Object(e))})),n},C=function(e,n){return function(t){var r=n.split(".").reduce((function(e,n){return e[n]=e[n]||{},e[n]}),e);E(r,t)}},I=function(){var e=[];return{add:function(n){e.push(n)},call:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return Promise.all(e.map((function(e){return e.apply(void 0,t)})))}}},k=function(e){var n=e.logger,t=e.cookieJar;return o(o({},t),{},{set:function(e,r,i){n.info("Setting cookie",o({name:e,value:r},i)),t.set(e,r,i)}})},S=function(){var e={};return e.promise=new Promise((function(n,t){e.resolve=n,e.reject=t})),e},D=function(e,n){return e===n},P=function(e,n){return e.appendChild(n)},T=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=(arguments.length>4&&void 0!==arguments[4]?arguments[4]:document).createElement(e);return Object.keys(n).forEach((function(e){o.setAttribute(e,n[e])})),function(e,n){Object.keys(n).forEach((function(t){if("style"===t&&p(n[t])){var r=n[t];Object.keys(r).forEach((function(n){e.style[n]=r[n]}))}else e[t]=n[t]}))}(o,t),r.forEach((function(e){return P(o,e)})),o},O="IMG",R="STYLE",N="SCRIPT",A=function(e){var n=e.src,t=e.currentDocument,r=void 0===t?document:t;return new Promise((function(e,t){T(O,{src:n},{onload:e,onerror:t,onabort:t},[],r)}))},x=function(e){return"function"==typeof e},M=function(e){return Array.isArray(e)&&e.length>0},q=function(e){return Array.isArray(e)?e:null==e?[]:[].slice.call(e)},L=/^\s*>/,j=function(e,n){return L.test(n)?q(e.querySelectorAll(":scope "+n)):q(e.querySelectorAll(n))},U=":shadow",B=function(e,n){var t=n;return t.startsWith(">")?(e instanceof Element||e instanceof Document?":scope":":host")+" "+t:t},_=function(e,n){var t=function(e){return e.split(U)}(n);if(t.length<2)return j(e,n);for(var r=e,o=0;o<t.length;o+=1){var i=t[o].trim();if(""===i&&r.shadowRoot)r=r.shadowRoot;else{var a=B(r,i),c=j(r,a);if(0===c.length||!c[0]||!c[0].shadowRoot)return c;r=c[0].shadowRoot}}},F=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return-1===e.indexOf(U)?j(n,e):_(n,e)},V="MutationObserver",z={childList:!0,subtree:!0},H=function(e){return new Error("Could not find: "+e)},J=function(e){return new Promise(e)},G=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:document,i=n(e);return M(i)?Promise.resolve(i):function(e){return x(e[V])}(r)?function(e,n,t,r,o){return J((function(i,a){var c,u=new e[V]((function(){var e=o(t);M(e)&&(u.disconnect(),c&&clearTimeout(c),i(e))}));c=setTimeout((function(){u.disconnect(),a(H(t))}),r),u.observe(n,z)}))}(r,o,e,t,n):function(e){return"visible"===e.visibilityState}(o)?function(e,n,t,r){return J((function(o,i){var a=function(){var t=r(n);M(t)?o(t):e.requestAnimationFrame(a)};a(),setTimeout((function(){i(H(n))}),t)}))}(r,e,t,n):function(e,n,t){return J((function(r,o){var i=function(){var n=t(e);M(n)?r(n):setTimeout(i,100)};i(),setTimeout((function(){o(H(e))}),n)}))}(e,t,n)},Q=function(e){var n=e.parentNode;return n?n.removeChild(e):null},X={name:"Adobe Alloy"},Y={style:{display:"none",width:0,height:0}},W=function(e){return p(e)&&0===Object.keys(e).length},K=function(e,n){return f(e)||!p(e)?e:Object.keys(e).reduce((function(r,i){var a=e[i];if(p(a)){var c=K(a,n);return W(c)?r:o(o({},r),{},t({},i,c))}return n(a)?o(o({},r),{},t({},i,a)):r}),{})},$=function(e){return function(e){for(var n=2166136261,t=(new TextEncoder).encode(e),r=0;r<t.length;r+=1)n^=t[r],n=Math.imul(n,16777619);return n>>>0}(e).toString(16).padStart(8,"0")},Z="com.adobe.alloy.",ee=Z+"getTld",ne="kndctr",te=function(e){return e.replace("@","_")},re=function(e,n){return ne+"_"+te(e)+"_"+n},oe=function(e,n){var t={};return e.forEach((function(e){var r=n(e);t[r]||(t[r]=[]),t[r].push(e)})),t},ie="Chrome",ae="Edge",ce="EdgeChromium",ue="Unknown",se=function(e){var n,t=!1;return function(){return t||(t=!0,n=e()),n}},de=[ie,ae,ce,"IE",ue],le=function(e){var n=e.orgId,t=re(n,"identity");return function(){return Boolean(w.get(t))}},fe=function(e,n,t){return{getItem:function(r){try{return e[n].getItem(t+r)}catch(e){return null}},setItem:function(r,o){try{return e[n].setItem(t+r,o),!0}catch(e){return!1}},clear:function(){try{return Object.keys(e[n]).forEach((function(r){r.startsWith(t)&&e[n].removeItem(r)})),!0}catch(e){return!1}}}},pe=function(e){return function(n){var t=Z+n;return{session:fe(e,"sessionStorage",t),persistent:fe(e,"localStorage",t)}}},ge=function(e){return"boolean"==typeof e},ve=function(e){return"number"==typeof e&&!Number.isNaN(e)},me=function(e){var n=parseInt(e,10);return ve(n)&&e===n},he=function(e){return"string"==typeof e},ye=function(e){return he(e)&&e.length>0},we=function(){},be=function(e){var n={},t=e.split(".");switch(t.length){case 1:n.subdomain="",n.domain=e,n.topLevelDomain="";break;case 2:n.subdomain="",n.domain=e,n.topLevelDomain=t[1];break;case 3:n.subdomain="www"===t[0]?"":t[0],n.domain=e,n.topLevelDomain=t[2];break;case 4:n.subdomain="www"===t[0]?"":t[0],n.domain=e,n.topLevelDomain=t[2]+"."+t[3]}return n},Ee=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be;he(e)||(e="");var t=function(e){try{var n=new URL(e),t=n.pathname;return e.endsWith("/")||"/"!==t||(t=""),{host:n.hostname,path:t,query:n.search.replace(/^\?/,""),anchor:n.hash.replace(/^#/,"")}}catch(e){return{}}}(e)||{},r=t.host,i=void 0===r?"":r,a=t.path,c=void 0===a?"":a,u=t.query,s=void 0===u?"":u,d=t.anchor;return o({path:c,query:s,fragment:void 0===d?"":d},n(i))};function Ce(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}for(var Ie,ke=(h||(h=1,m={parse:function(e){return function(e){var n={};if(!e||"string"!=typeof e)return n;var t=e.trim().replace(/^[?#&]/,""),r=new URLSearchParams(t),o=r.keys();do{var i=o.next(),a=i.value;if(a){var c=r.getAll(a);1===c.length?n[a]=c[0]:n[a]=c}}while(!1===i.done);return n}(e)},stringify:function(e){return function(e){var n="{{space}}",t=new URLSearchParams;return Object.keys(e).forEach((function(r){var o=e[r];"string"==typeof e[r]?o=o.replace(/ /g,n):["object","undefined"].includes(d(o))&&!Array.isArray(o)&&(o=""),Array.isArray(o)?o.forEach((function(e){t.append(r,e)})):t.append(r,o)})),t.toString().replace(new RegExp(encodeURIComponent(n),"g"),"%20")}(e)}}),m),Se=Ce(ke),De=function(e){return Array.isArray(e)?e.map((function(e){return De(e)})):"object"===d(e)&&null!==e?Object.keys(e).sort().reduce((function(n,t){return n[t]=De(e[t]),n}),{}):e},Pe=function(e){return e instanceof Error?e:new Error(e)},Te=function(e){var n=e.error,t=e.message;try{n.message=t}catch(e){}},Oe=function(e){var n=e.error,t=e.message,r=Pe(n),o=t+"\nCaused by: "+r.message;return Te({error:r,message:o}),r},Re=function(e,n){if(ve(e)||he(e)){var t=Math.round(Number(e));if(!Number.isNaN(t))return t}return n},Ne=function(e,n,t){return(""+e).padStart(n,t)},Ae=[],xe=0;xe<256;++xe)Ae.push((xe+256).toString(16).slice(1));var Me=new Uint8Array(16);var qe={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Le(e,n,t){var r,o,i,a;if(qe.randomUUID&&!n&&!e)return qe.randomUUID();var c=null!==(r=null!==(o=(e=e||{}).random)&&void 0!==o?o:null===(i=(a=e).rng)||void 0===i?void 0:i.call(a))&&void 0!==r?r:function(){if(!Ie){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ie=crypto.getRandomValues.bind(crypto)}return Ie(Me)}();if(c.length<16)throw new Error("Random bytes length must be >= 16");if(c[6]=15&c[6]|64,c[8]=63&c[8]|128,n){if((t=t||0)<0||t+16>n.length)throw new RangeError("UUID byte range "+t+":"+(t+15)+" is out of buffer bounds");for(var u=0;u<16;++u)n[t+u]=c[u];return n}return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(Ae[e[n+0]]+Ae[e[n+1]]+Ae[e[n+2]]+Ae[e[n+3]]+"-"+Ae[e[n+4]]+Ae[e[n+5]]+"-"+Ae[e[n+6]]+Ae[e[n+7]]+"-"+Ae[e[n+8]]+Ae[e[n+9]]+"-"+Ae[e[n+10]]+Ae[e[n+11]]+Ae[e[n+12]]+Ae[e[n+13]]+Ae[e[n+14]]+Ae[e[n+15]]).toLowerCase()}(c)}var je=function(e){return function(n,t){return null==n?n:e.call(this,n,t)}},Ue=function(e,n){return function(t,r){return n.call(this,e.call(this,t,r),r)}},Be=function(e,n,t){return Object.assign(Ue(e,n),e,t)},_e=function(e,n,t){return Object.assign(Ue(e,je(n)),e,t)},Fe=function(e,n,t){return Object.assign((r=je(n),o=e,function(e,n){var t=this,i=[],a=[r,o].reduce((function(e,r){try{return r.call(t,e,n)}catch(n){return i.push(n),e}}),e);if(i.length)throw new Error(i.join("\n"));return a}),e,t);var r,o},Ve=function(e,n,t,r){if(!e)throw new Error("'"+t+"': Expected "+r+", but got "+JSON.stringify(n)+".")},ze=function(e,n){return Ve(ge(e),e,n,"true or false"),e},He=function(e,n){return Ve(x(e),e,n,"a function"),e},Je=function(e,n){return function(t,r){return Ve(t>=n,t,r,e+" greater than or equal to "+n),t}},Ge=function(e){return function(n,t){return p(n)?Ve(!W(n),n,t,e):Ve(n.length>0,n,t,e),n}},Qe=function(){return function(e,n){return Ve(function(e){for(var n=Object.create(null),t=0;t<e.length;t+=1){var r=e[t];if(r in n)return!1;n[r]=!0}return!0}(e),e,n,"array values to be unique"),e}},Xe=/^[a-z0-9.-]{1,}$/i,Ye=function(e,n){return Ve(Xe.test(e),e,n,"a valid domain"),e},We=function(e,n){return Ve(me(e),e,n,"an integer"),e},Ke=function(e,n){return Ve(ve(e),e,n,"a number"),e},$e=function(e,n){return Ve(function(e){try{return null!==RegExp(e)}catch(e){return!1}}(e),e,n,"a regular expression"),e},Ze=function(e,n){if(null==e)throw new Error("'"+n+"' is a required option");return e},en=function(e,n){return Ve(he(e),e,n,"a string"),e},nn=function(e){return e};nn.default=function(e){return Be(this,function(e){return function(n){return null==n?e:n}}(e))},nn.required=function(){return Be(this,Ze)},nn.deprecated=function(e){return Be(this,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"This field has been deprecated";return function(n,t){var r=e;return void 0!==n&&(t&&(r="'"+t+"': "+r),this&&this.logger&&this.logger.warn(r)),n}}(e))};var tn,rn=function(){return _e(this,Ye)},on=function(e){return _e(this,Je("an integer",e))},an=function(e){return _e(this,Je("a number",e))},cn=function(e){return _e(this,(n="a number",t=e,function(e,r){return Ve(e<=t,e,r,n+" less than or equal to "+t),e}));var n,t},un=function(){return _e(this,We,{minimum:on})},sn=function(){return _e(this,Ge("a non-empty string"))},dn=function(){return _e(this,Ge("a non-empty array"))},ln=function(){return _e(this,Ge("a non-empty object"))},fn=function(){return _e(this,$e)},pn=function(e){return _e(this,function(e){return function(n,t){return Ve(e.test(n),n,t,"does not match the "+e.toString()),n}}(e))},gn=function(){return _e(this,(e=[],function(n,t){return Ve(-1===e.indexOf(n),n,t,"a unique value across instances"),e.push(n),n}));var e},vn=function(){return _e(this,Qe())},mn=function(e){return{noUnknownFields:function(){return _e(this,function(e){return function(n,t){var r=[];if(Object.keys(n).forEach((function(n){if(!e[n]){var o=t?t+"."+n:n;r.push("'"+o+"': Unknown field.")}})),r.length)throw new Error(r.join("\n"));return n}}(e))},nonEmpty:ln,concat:function(n){var t=o(o({},e),n.schema);return _e(this,n,mn(t))},renamed:function(e,n,r){return Fe(this,function(e,n,r){return function(a,c){Ve(p(a),a,c,"an object");var u=a[e],d=a[r],l=i(a,[e,r].map(s)),f=n(u,c);if(void 0!==f){var g="The field '"+e+"' is deprecated. Use '"+r+"' instead.";if(c&&(g="'"+c+"': "+g),void 0!==d&&d!==f)throw new Error(g);this&&this.logger&&this.logger.warn(g)}return o(t({},r,d||f),l)}}(e,n,r))},schema:e}},hn=function(e,n){return Be(this,function(e,n){return function(t,r){var o,i=this,a=e.find((function(e){try{return o=e.call(i,t,r),!0}catch(e){return!1}}));return Ve(a,t,r,n),o}}(e,n))}.bind(nn),yn=function(){return this}.bind(nn),wn=function(e){return _e(this,function(e){return function(n,t){var r=this;Ve(Array.isArray(n),n,t,"an array");var o=[],i=n.map((function(i,a){try{return e.call(r,i,t+"["+a+"]",n)}catch(e){return void o.push(e.message)}}));if(o.length)throw new Error(o.join("\n"));return i}}(e),{nonEmpty:dn,uniqueItems:vn})}.bind(nn),bn=function(){return _e(this,ze)}.bind(nn),En=function(){return _e(this,He)}.bind(nn),Cn=function(e){return _e(this,function(e){return function(n,t){return Ve(n===e,n,t,""+e),n}}(e))}.bind(nn),In=function(){return _e(this,Ke,{minimum:an,maximum:cn,integer:un,unique:gn})}.bind(nn),kn=function(e){return _e(this,(n=e,function(e,t){var r=this;Ve(p(e),e,t,"an object");var o=[],i={};if(Object.keys(e).forEach((function(a){var c=e[a],u=t?t+"."+a:a;try{var s=n.call(r,c,u);void 0!==s&&(i[a]=s)}catch(e){o.push(e.message)}})),o.length)throw new Error(o.join("\n"));return i}),{nonEmpty:ln});var n}.bind(nn),Sn=function(e){return _e(this,function(e){return function(n,t){var r=this;Ve(p(n),n,t,"an object");var o=[],i={};if(Object.keys(e).forEach((function(a){var c=n[a],u=e[a],s=t?t+"."+a:a;try{var d=u.call(r,c,s);void 0!==d&&(i[a]=d)}catch(e){o.push(e.message)}})),Object.keys(n).forEach((function(e){Object.prototype.hasOwnProperty.call(i,e)||(i[e]=n[e])})),o.length)throw new Error(o.join("\n"));return i}}(e),mn(e))}.bind(nn),Dn=function(){return _e(this,en,{regexp:fn,domain:rn,nonEmpty:sn,unique:gn,matches:pn})}.bind(nn),Pn=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return hn(n.map(Cn),"one of these values: "+JSON.stringify(n))},Tn=kn(wn(Sn({authenticatedState:Pn("ambiguous","authenticated","loggedOut"),id:Dn(),namespace:Sn({code:Dn()}).noUnknownFields(),primary:bn(),xid:Dn()}).noUnknownFields()).required()),On=Sn({}),Rn="alloy_debug",Nn=function(e){var n,t=e.console,r=e.locationSearch,o=e.createLogger,i=e.instanceName,a=e.createNamespacedStorage,c=e.getMonitors,u=Se.parse(r),s=a("instance."+i+"."),d=s.session.getItem("debug"),l="true"===d,f=null===d,p=function(){return l},g=function(e,n){var t=n.fromConfig;t&&!f||(l=e),t||(s.session.setItem("debug",e.toString()),f=!1)};return void 0!==u[Rn]&&g((n=u[Rn],he(n)&&"true"===n.toLowerCase()),{fromConfig:!1}),{setDebugEnabled:g,logger:o({getDebugEnabled:p,context:{instanceName:i},getMonitors:c,console:t}),createComponentLogger:function(e){return o({getDebugEnabled:p,context:{instanceName:i,componentName:e},getMonitors:c,console:t})}}},An=["onComponentsRegistered","onBeforeEvent","onBeforeRequest","onResponse","onRequestFailure","onClick","onDecision"],xn=function(e){return An.reduce((function(n,t){var r;return n[t]=(r=function(e,n){return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return Promise.all(e.getLifecycleCallbacks(n).map((function(e){return new Promise((function(n){n(e.apply(void 0,r))}))})))}}(e,t),function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return Promise.resolve().then((function(){return r.apply(void 0,n)}))}),n}),{})},Mn=function(e,n){return function(){var t;try{t=e.apply(void 0,arguments)}catch(e){throw Oe({error:e,message:n})}return t instanceof Promise&&(t=t.catch((function(e){throw Oe({error:e,message:n})}))),t}},qn=function(){var e={},n={},t={};return{register:function(r,o){var i=o.commands,a=o.lifecycle;!function(e){var t,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=(t=Object.keys(n),r=Object.keys(o),t.filter((function(e){return r.includes(e)})));if(i.length)throw new Error("[ComponentRegistry] Could not register "+e+" because it has existing command(s): "+i.join(","));Object.keys(o).forEach((function(t){var r=o[t];r.commandName=t,r.run=Mn(r.run,"["+e+"] An error occurred while executing the "+t+" command."),n[t]=r}))}(r,i),function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(n).forEach((function(r){t[r]=t[r]||[],t[r].push(Mn(n[r],"["+e+"] An error occurred while executing the "+r+" lifecycle hook."))}))}(r,a),e[r]=o},getCommand:function(e){return n[e]},getCommandNames:function(){return Object.keys(n)},getLifecycleCallbacks:function(e){return t[e]||[]},getComponentNames:function(){return Object.keys(e)}}},Ln="in",jn="out",Un="pending",Bn="general",_n="declinedConsent",Fn="default",Vn="initial",zn="new",Hn=function(e){var n=new Error(e);return n.code=_n,n.message=e,n},Jn=function(e){var n=e.logger,t=[],r=function(){return Promise.resolve()},o=function(){return Promise.resolve()},i=function(){return Promise.reject(Hn("No consent preferences have been set."))},a=function(){return Promise.reject(Hn("The user declined consent."))},c=function(e){if(e)return Promise.reject(new Error("Consent is pending."));var n=S();return t.push(n),n.promise};return{in:function(e){e===Fn?this.awaitConsent=r:(e===Vn?n.info("Loaded user consent preferences. The user previously consented."):e===zn&&this.awaitConsent!==o&&n.info("User consented."),function(){for(;t.length;)t.shift().resolve()}(),this.awaitConsent=o)},out:function(e){e===Fn?(n.warn("User consent preferences not found. Default consent of out will be used."),this.awaitConsent=i):(e===Vn?n.warn("Loaded user consent preferences. The user previously declined consent."):e===zn&&this.awaitConsent!==a&&n.warn("User declined consent."),function(){for(;t.length;)t.shift().reject(Hn("The user declined consent."))}(),this.awaitConsent=a)},pending:function(e){e===Fn&&n.info("User consent preferences not found. Default consent of pending will be used. Some commands may be delayed."),this.awaitConsent=c},awaitConsent:function(){return Promise.resolve()},withConsent:function(){return this.awaitConsent(!0)},current:function(){switch(this.awaitConsent){case r:return{state:"in",wasSet:!1};case o:return{state:"in",wasSet:!0};case i:return{state:"out",wasSet:!1};case a:return{state:"out",wasSet:!0};case c:return{state:"pending",wasSet:!1};default:return{state:"in",wasSet:!1}}}}},Gn=function(e){return e&&e._experience&&e._experience.decisioning&&M(e._experience.decisioning.propositions)?e._experience.decisioning.propositions:[]},Qn=function(){var e,n,t={},r=!1,o=!1,i=!0,a=function(e){if(o)throw new Error(e+" cannot be called after event is finalized.")},c={hasQuery:function(){return Object.prototype.hasOwnProperty.call(this.getContent(),"query")},getContent:function(){var r=JSON.parse(JSON.stringify(t));return e&&E(r,{xdm:e}),n&&E(r,{data:n}),r},setUserXdm:function(n){a("setUserXdm"),e=n},setUserData:function(e){a("setUserData"),n=e},mergeXdm:function(e){a("mergeXdm"),e&&E(t,{xdm:e})},mergeData:function(e){a("mergeData"),e&&E(t,{data:e})},mergeMeta:function(e){a("mergeMeta"),e&&E(t,{meta:e})},mergeQuery:function(e){a("mergeQuery"),e&&E(t,{query:e})},documentMayUnload:function(){r=!0},finalize:function(r){if(!o){var a=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:D;return e.filter((function(t,r){return function(e,n,t){for(var r=0;r<e.length;r+=1)if(t(e[r],n))return r;return-1}(e,t,n)===r}))}([].concat(u(Gn(e)),u(Gn(t.xdm))),(function(e,n){return e===n||e.id&&n.id&&e.id===n.id&&e.scope&&n.scope&&e.scope===n.scope}));if(e&&this.mergeXdm(e),a.length>0&&(t.xdm._experience.decisioning.propositions=a),n&&c.mergeData(n),o=!0,r){i=!1;var s={xdm:t.xdm||{},data:t.data||{}},d=r(s);i=!1!==d,t.xdm=s.xdm||{},t.data=s.data||{},W(t.xdm)&&delete t.xdm,W(t.data)&&delete t.data}}},getDocumentMayUnload:function(){return r},isEmpty:function(){return W(t)&&(!e||W(e))&&(!n||W(n))},shouldSend:function(){return i},getViewName:function(){if(e&&e.web&&e.web.webPageDetails)return e.web.webPageDetails.viewName},toJSON:function(){if(!o)throw new Error("toJSON called before finalize");return t}};return c},Xn="configure",Yn="setDebug",Wn=function(e){var n,t=e.logger,r=e.configureCommand,o=e.setDebugCommand,i=e.handleError,a=e.validateCommandOptions;return function(e){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(i){var u=function(e,i){var c;if(e===Xn){if(n)throw new Error("The library has already been configured and may only be configured once.");c=function(){return(n=r(i)).then((function(){}))}}else{if(!n)throw new Error("The library must be configured first. Please do so by executing the configure command.");c=e===Yn?function(){var e=Sn({enabled:bn().required()}).noUnknownFields(),n=a({command:{commandName:Yn,optionsValidator:e},options:i});o(n)}:function(){return n.then((function(n){var t=n.getCommand(e);if(!t||!x(t.run)){var r=[Xn,Yn].concat(n.getCommandNames()).join(", ");throw new Error("The "+e+" command does not exist. List of available commands: "+r+".")}var o=a({command:t,options:i});return t.run(o)}),(function(){return t.warn("An error during configuration is preventing the "+e+" command from executing."),new Promise((function(){}))}))}}return c}(e,c);t.logOnBeforeCommand({commandName:e,options:c}),i(u())})).catch((function(n){return i(n,e+" command")})).catch((function(n){throw t.logOnCommandRejected({commandName:e,options:c,error:n}),n})).then((function(n){var r=p(n)?n:{};return t.logOnCommandResolved({commandName:e,options:c,result:r}),r}))}},Kn=function(e){var n=e.command,t=e.options,r=n.commandName,o=n.documentationUri,i=void 0===o?"https://adobe.ly/3sHgQHb":o,a=n.optionsValidator,c=t;if(a)try{c=a(t)}catch(e){throw new Error("Invalid "+r+" command options:\n\t - "+e+" For command documentation see: "+i)}return c},$n=function(e){var n=e.options,t=e.componentCreators,r=e.coreConfigValidators,i=e.createConfig,a=e.logger,c=e.setDebugEnabled,s=function(e){var n=[],t={get enabled(){return e.enabled},flush:function(){n.forEach((function(n){var t=n.method,r=n.args;return e[t].apply(e,u(r))}))}};return Object.keys(e).filter((function(n){return"function"==typeof e[n]})).forEach((function(e){t[e]=function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];n.push({method:e,args:r})}})),t}(a),d=t.map((function(e){return e.configValidators})).filter((function(e){return e})).reduce((function(e,n){return e.concat(n)}),r),l=i(function(e){var n=e.combinedConfigValidator,t=e.options,r=e.logger;try{return n.noUnknownFields().required().call({logger:r},t)}catch(e){throw new Error("Resolve these configuration problems:\n\t - "+e.message.split("\n").join("\n\t - ")+"\nFor configuration documentation see: https://adobe.ly/3sHh553")}}({combinedConfigValidator:d,options:n,logger:s}));c(l.debugEnabled,{fromConfig:!0}),s.flush();var f=function(e,n,t){return t.reduce((function(t,r){var i=r.buildOnInstanceConfiguredExtraParams;return i&&(t=o(o({},t),i({config:e,logger:n}))),t}),{})}(l,a,t);return a.logOnInstanceConfigured(o(o({},f),{},{config:l})),l},Zn=function(e){return o({},e)},et=function(e){var n=e.errorPrefix,t=e.logger;return function(e,r){var o=Pe(e);if(o.code===_n)return t.warn("The "+r+" could not fully complete. "+o.message),{};throw Te({error:o,message:n+" "+o.message}),o}},nt=function(e){var n=e.getDebugEnabled,t=e.console,r=e.getMonitors,i=e.context,a="["+i.instanceName+"]";i.componentName&&(a+=" ["+i.componentName+"]");var c=function(e,n){var t=r();if(t.length>0){var a=o(o({},i),n);t.forEach((function(n){n[e]&&n[e](a)}))}},u=function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];c("onBeforeLog",{level:e,arguments:o}),n()&&t[e].apply(t,[a].concat(o))};return{get enabled(){return r().length>0||n()},logOnInstanceCreated:function(e){c("onInstanceCreated",e),u("info","Instance initialized.")},logOnInstanceConfigured:function(e){c("onInstanceConfigured",e),u("info","Instance configured. Computed configuration:",e.config)},logOnBeforeCommand:function(e){c("onBeforeCommand",e),u("info","Executing "+e.commandName+" command. Options:",e.options)},logOnCommandResolved:function(e){c("onCommandResolved",e),u("info",e.commandName+" command resolved. Result:",e.result)},logOnCommandRejected:function(e){c("onCommandRejected",e),u("error",e.commandName+" command was rejected. Error:",e.error)},logOnBeforeNetworkRequest:function(e){c("onBeforeNetworkRequest",e),u("info","Request "+e.requestId+": Sending request.",e.payload)},logOnNetworkResponse:function(e){c("onNetworkResponse",e);var n=e.parsedBody||e.body?"response body:":"no response body.";u("info","Request "+e.requestId+": Received response with status code "+e.statusCode+" and "+n,e.parsedBody||e.body)},logOnNetworkError:function(e){c("onNetworkError",e),u("error","Request "+e.requestId+": Network request failed.",e.error)},logOnContentHiding:function(e){c("onContentHiding",{status:e.status}),u(e.logLevel,e.message)},logOnContentRendering:function(e){c("onContentRendering",{status:e.status,payload:e.detail}),u(e.logLevel,e.message)},info:u.bind(null,"info"),warn:u.bind(null,"warn"),error:u.bind(null,"error")}},tt="__view__",rt=function(e){return function(n,t){e.xdm=e.xdm||{},e.xdm.identityMap=e.xdm.identityMap||{},e.xdm.identityMap[n]=e.xdm.identityMap[n]||[],e.xdm.identityMap[n].push(t)}},ot=function(e){var n=e.payload,t=e.getAction,r=e.getUseSendBeacon,o=e.datastreamIdOverride,i=e.edgeSubPath,a=Le(),c=!1,u=!1;return{getId:function(){return a},getPayload:function(){return n},getAction:function(){return t({isIdentityEstablished:u})},getDatastreamIdOverride:function(){return o},getUseSendBeacon:function(){return r({isIdentityEstablished:u})},getEdgeSubPath:function(){return i||""},getUseIdThirdPartyDomain:function(){return c},setUseIdThirdPartyDomain:function(){c=!0},setIsIdentityEstablished:function(){u=!0}}},it=function(e){var n=e.payload,t=e.datastreamIdOverride,r=function(e){var t=e.isIdentityEstablished;return n.getDocumentMayUnload()&&t};return ot({payload:n,getAction:function(e){var n=e.isIdentityEstablished;return r({isIdentityEstablished:n})?"collect":"interact"},getUseSendBeacon:r,datastreamIdOverride:t})},at=function(e){var n=e.content,t=e.addIdentity,r=e.hasIdentity,o=C(n,"meta.configOverrides");return{mergeMeta:C(n,"meta"),mergeState:C(n,"meta.state"),mergeQuery:C(n,"query"),mergeConfigOverride:function(e){return o(function(e){if(f(e)||"object"!==d(e))return null;var n=K(e,(function(e){return!(f(e)||!ge(e)&&!ve(e)&&!ye(e)&&!M(e))}));return W(n)?null:n}(e))},addIdentity:t,hasIdentity:r,toJSON:function(){return n}}},ct=function(e){return function(n){return void 0!==(e.xdm&&e.xdm.identityMap&&e.xdm.identityMap[n])}},ut=function(){var e={},n=at({content:e,addIdentity:rt(e),hasIdentity:ct(e)});return n.addEvent=function(n){e.events=e.events||[],e.events.push(n)},n.getDocumentMayUnload=function(){return(e.events||[]).some((function(e){return e.getDocumentMayUnload()}))},n},st=["datastreamId"],dt=function(e){var n=e.localConfigOverrides,t=e.globalConfigOverrides,r=e.payload,o={payload:r},a=n||{},c=a.datastreamId,u=i(a,st);return c&&(o.datastreamIdOverride=c),t&&!W(t)&&r.mergeConfigOverride(t),u&&!W(u)&&r.mergeConfigOverride(u),o},lt="clientId",ft=["edgeConfigOverrides"],pt="Event was canceled because the onBeforeEventSend callback returned false.",gt=function(e){var n=e.orgId,t=e.targetMigrationEnabled;return function(e){return function(e,n){return 0===n.indexOf(ne+"_"+te(e)+"_")}(n,e)||"at_qa_mode"===e||t&&"mbox"===e}},vt=function(e){var n=e.shift()||[],t=e.shift()||[],r=e;return g.apply(void 0,[{}].concat(u(n),u(t),u(r)))},mt=function(e){return function(n){var t=function(){throw n};return e.call({error:n}).then(t,t)}},ht="The server responded with a",yt=function(e){var n=e.orgId,t=e.cookieJar,r=re(n,"cluster");return function(){return t.get(r)||function(){var e=t.get("mboxEdgeCluster");if(e)return"t"+e}()}},wt=[429,503,502,504],bt=function(e){var n=e.response;return e.retriesAttempted<3&&wt.includes(n.statusCode)},Et=function(e){var n=e.response,t=e.retriesAttempted,r=function(e){var n,t=e.getHeader("Retry-After");if(t){var r=parseInt(t,10);n=me(r)?1e3*r:Math.max(0,new Date(t).getTime()-(new Date).getTime())}return n}(n);return void 0===r&&(r=function(e){var n=1e3+1e3*e,t=.3*n,r=n-t,o=n+t;return Math.round(r+Math.random()*(o-r))}(t)),r},Ct=function(e){return function(n){var t=e().toISOString();E(n,{timestamp:t})}},It="2.26.0",kt=[["architecture","string"],["bitness","string"],["model","string"],["platformVersion","string"],["wow64","boolean"]],St=function(e){return function(n){var t={webPageDetails:{URL:e.location.href||e.location},webReferrer:{URL:e.document.referrer}};E(n,{web:t})}}(window),Dt=function(e){return function(n){var t=e.screen,r=t.width,o=t.height,i={},a=Re(o);a>=0&&(i.screenHeight=a);var c=Re(r);c>=0&&(i.screenWidth=c);var u=function(e){var n=e.screen.orientation;if(null==n||null==n.type)return null;var t=n.type.split("-");return 0===t.length||"portrait"!==t[0]&&"landscape"!==t[0]?null:t[0]}(e)||function(e){if(x(e.matchMedia)){if(e.matchMedia("(orientation: portrait)").matches)return"portrait";if(e.matchMedia("(orientation: landscape)").matches)return"landscape"}return null}(e);u&&(i.screenOrientation=u),Object.keys(i).length>0&&E(n,{device:i})}}(window),Pt=function(e){return function(n){var t=e.document.documentElement,r=void 0===t?{}:t,o=r.clientWidth,i=r.clientHeight,a={type:"browser"},c=Re(o);c>=0&&(a.browserDetails={viewportWidth:c});var u=Re(i);u>=0&&(a.browserDetails=a.browserDetails||{},a.browserDetails.viewportHeight=u),E(n,{environment:a})}}(window),Tt=(tn=function(){return new Date},function(e){var n=tn(),t={},r=Re(n.getTimezoneOffset());void 0!==r&&(t.localTimezoneOffset=r),(void 0===r||Math.abs(r)<6e3)&&(t.localTime=function(e){var n=e.getFullYear(),t=Ne(e.getMonth()+1,2,"0"),r=Ne(e.getDate(),2,"0"),o=Ne(e.getHours(),2,"0"),i=Ne(e.getMinutes(),2,"0"),a=Ne(e.getSeconds(),2,"0"),c=Ne(e.getMilliseconds(),3,"0"),u=Re(e.getTimezoneOffset(),0);return n+"-"+t+"-"+r+"T"+o+":"+i+":"+a+"."+c+(u>0?"-":"+")+Ne(Math.floor(Math.abs(u)/60),2,"0")+":"+Ne(Math.abs(u)%60,2,"0")}(n)),E(e,{placeContext:t})}),Ot=Ct((function(){return new Date})),Rt=function(e){return function(e){return void 0!==e.userAgentData}(e)?function(n,t){try{return e.userAgentData.getHighEntropyValues(kt.map((function(e){return e[0]}))).then((function(e){var t={};kt.forEach((function(n){var r=c(n,2),o=r[0],i=r[1];Object.prototype.hasOwnProperty.call(e,o)&&d(e[o])===i&&(t[o]=e[o])})),E(n,{environment:{browserDetails:{userAgentClientHints:t}}})}))}catch(e){return t.warn("Unable to collect user-agent client hints. "+e.message),we}}:we}(navigator),Nt={web:St,device:Dt,environment:Pt,placeContext:Tt},At={highEntropyUserAgentHints:Rt},xt=o(o({},Nt),At),Mt=[Ot,function(e){E(e,{implementationDetails:{name:"https://ns.adobe.com/experience/alloy",version:It,environment:"browser"}})}],qt=function(e){return function(e,n,t,r){var o=e.context.flatMap((function(e,r){return t[e]?[t[e]]:(n.warn("Invalid context["+r+"]: '"+e+"' is not available."),[])})).concat(r);return{namespace:"Context",lifecycle:{onBeforeEvent:function(e){var t=e.event,r={};return Promise.all(o.map((function(e){return Promise.resolve(e(r,n))}))).then((function(){return t.mergeXdm(r)}))}}}}(e.config,e.logger,xt,Mt)};qt.namespace="Context",qt.configValidators=Sn({context:wn(Dn()).default(Object.keys(Nt))});var Lt=["xdm","data","documentUnloading","type","mergeId","datasetId","edgeConfigOverrides"],jt=function(e){var n=e.eventManager,t=e.logger;return{commands:{sendEvent:{documentationUri:"https://adobe.ly/3GQ3Q7t",optionsValidator:function(e){return function(e){var n=e.options;return Sn({type:Dn(),xdm:Sn({eventType:Dn(),identityMap:Tn}),data:Sn({}),documentUnloading:bn(),renderDecisions:bn(),decisionScopes:wn(Dn()).uniqueItems(),personalization:Sn({decisionScopes:wn(Dn()).uniqueItems(),surfaces:wn(Dn()).uniqueItems(),sendDisplayEvent:bn().default(!0),includeRenderedPropositions:bn().default(!1),defaultPersonalizationEnabled:bn(),decisionContext:Sn({})}).default({sendDisplayEvent:!0}),datasetId:Dn(),mergeId:Dn(),edgeConfigOverrides:On,initializePersonalization:bn()}).required().noUnknownFields()(n)}({options:e})},run:function(e){var r=e.xdm,o=e.data,a=e.documentUnloading,c=e.type,u=e.mergeId,s=e.datasetId,d=e.edgeConfigOverrides,l=i(e,Lt),f=n.createEvent();return a&&f.documentMayUnload(),f.setUserXdm(r),f.setUserData(o),c&&f.mergeXdm({eventType:c}),u&&f.mergeXdm({eventMergeId:u}),d&&(l.edgeConfigOverrides=d),s&&(t.warn("The 'datasetId' option has been deprecated. Please use 'edgeConfigOverrides.com_adobe_experience_platform.datasets.event.datasetId' instead."),l.edgeConfigOverrides=d||{},E(l.edgeConfigOverrides,{com_adobe_experience_platform:{datasets:{event:{datasetId:s}}}})),n.sendEvent(f,l)}},applyResponse:{documentationUri:"",optionsValidator:function(e){return function(e){var n=e.options;return Sn({renderDecisions:bn(),responseHeaders:kn(Dn().required()),responseBody:Sn({handle:wn(Sn({type:Dn().required(),payload:yn().required()})).required()}).required(),personalization:Sn({sendDisplayEvent:bn().default(!0),decisionContext:Sn({})}).default({sendDisplayEvent:!0})}).noUnknownFields()(n)}({options:e})},run:function(e){var t=e.renderDecisions,r=void 0!==t&&t,o=e.decisionContext,i=void 0===o?{}:o,a=e.responseHeaders,c=void 0===a?{}:a,u=e.responseBody,s=void 0===u?{handle:[]}:u,d=e.personalization,l=n.createEvent();return n.applyResponse(l,{renderDecisions:r,decisionContext:i,responseHeaders:c,responseBody:s,personalization:d})}}}}};jt.namespace="DataCollector";var Ut=function(e,n){return"ID sync "+(n?"succeeded":"failed")+": "+e.spec.url},Bt=Sn({thirdPartyCookiesEnabled:bn().default(!0),idMigrationEnabled:bn().default(!0)}),_t=Sn({url:Dn().required().nonEmpty(),edgeConfigOverrides:On}).required().noUnknownFields(),Ft="ECID",Vt=function(e){var n=e.logger;return new Promise((function(e,t){if(p(window.adobe)&&p(window.adobe.optIn)){var r=window.adobe.optIn;n.info("Delaying request while waiting for legacy opt-in to let Visitor retrieve ECID from server."),r.fetchPermissions((function(){r.isApproved([r.Categories.ECID])?(n.info("Received legacy opt-in approval to let Visitor retrieve ECID from server."),e()):t(new Error("Legacy opt-in was declined."))}),!0)}else e()}))},zt=function(e){var n=e.logger,t=e.orgId,r=e.awaitVisitorOptIn;return function(){var e=function(e){var n=e.Visitor;return x(n)&&x(n.getInstance)&&n}(window);return e?r({logger:n}).then((function(){return n.info("Delaying request while using Visitor to retrieve ECID from server."),new Promise((function(r){e.getInstance(t,{}).getMarketingCloudVisitorID((function(e){n.info("Resuming previously delayed request that was waiting for ECID from Visitor."),r(e)}),!0)}))})).catch((function(e){e?n.info(e.message+", retrieving ECID from experience edge"):n.info("An error occurred while obtaining the ECID from Visitor.")})):Promise.resolve()}},Ht="CORE",Jt=function(e){try{return decodeURIComponent(e)}catch(e){return""}},Gt=function(e,n){e.addIdentity(Ft,{id:n})},Qt=function(e){return e.getPayloadsByType("identity:result").reduce((function(e,n){return n.namespace&&n.namespace.code&&(e[n.namespace.code]=n.id),e}),{})},Xt=function(e){var n=e.payload,t=e.datastreamIdOverride;return ot({payload:n,datastreamIdOverride:t,getAction:function(){return"identity/acquire"},getUseSendBeacon:function(){return!1}})},Yt=function(e){var n={query:{identity:{fetch:e}}};return at({content:n,addIdentity:rt(n),hasIdentity:ct(n)})},Wt=/^([^?#]*)(\??[^#]*)(#?.*)$/,Kt=Sn({namespaces:wn(Pn(Ft,Ht)).nonEmpty().uniqueItems().default([Ft]),edgeConfigOverrides:On}).noUnknownFields().default({namespaces:[Ft]}),$t=function(e,n){var t,r=0,o=0;do{if(n<0||n+o>=e.length)throw new Error("Invalid varint: buffer ended unexpectedly");if(r|=(127&(t=e[n+o]))<<7*o,(o+=1)>10)throw new Error("Invalid varint: too long")}while(128&t);return{value:r,length:o}},Zt=Object.freeze({VARINT:0,I64:1,LEN:2,SGROUP:3,EGROUP:4,I32:5}),er=function(e){var n=e.orgId,t=e.cookieJar,r=e.logger,o=re(n,"identity");return function(){var e,n=t.get(o);if(!n)return null;try{var i=decodeURIComponent(n).replace(/_/g,"/").replace(/-/g,"+");return function(e){for(var n=0,t=null;n<e.length&&!t;){var r=$t(e,n),o=r.value;n+=r.length;var i=7&o;if(1==o>>3){if(i===Zt.LEN){var a=$t(e,n);return n+=a.length,t=(new TextDecoder).decode(e.slice(n,n+a.value)),n+=a.value,t}}else switch(i){case Zt.VARINT:n+=$t(e,n).length;break;case Zt.I64:n+=8;break;case Zt.LEN:var c=$t(e,n);n+=c.length+c.value;break;case Zt.SGROUP:case Zt.EGROUP:break;case Zt.I32:n+=4;break;default:throw new Error("Malformed kndctr cookie. Unknown wire type: "+i)}}throw new Error("No ECID found in cookie.")}((e=atob(i),Uint8Array.from(e,(function(e){return e.codePointAt(0)}))))}catch(e){return r.warn("Unable to decode ECID from "+o+" cookie",e),null}}},nr=function(e){var n=e.config,t=e.logger,r=e.consent,i=e.fireReferrerHideableImage,a=e.sendEdgeNetworkRequest,u=e.apexDomain,s=e.getBrowser,d=n.orgId,l=n.thirdPartyCookiesEnabled,f=n.edgeConfigOverrides,p=zt({logger:t,orgId:d,awaitVisitorOptIn:Vt}),g=k({logger:t,cookieJar:w}),v=function(e){var n=e.config,t=e.getEcidFromVisitor,r=e.apexDomain,i=e.isPageSsl,a=e.cookieJar,c=n.idMigrationEnabled,u="AMCV_"+n.orgId,s=function(){var e=null,n=a.get("s_ecid")||a.get(u);if(n){var t=n.match(/(^|\|)MCMID\|(\d+)($|\|)/);t&&(e=t[2])}return e};return{getEcid:function(){if(c){var e=s();return e?Promise.resolve(e):t()}return Promise.resolve()},setEcid:function(e){if(c&&s()!==e){var n=i?{sameSite:"none",secure:!0}:{};a.set(u,"MCMID|"+e,o({domain:r,expires:390},n))}}}}({config:n,getEcidFromVisitor:p,apexDomain:u,cookieJar:g,isPageSsl:"https:"===window.location.protocol}),m=le({orgId:d}),h=function(e){var n=e.sendEdgeNetworkRequest,t=e.createIdentityRequestPayload,r=e.createIdentityRequest,o=e.globalConfigOverrides;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.namespaces,a=e.edgeConfigOverrides,c=dt({payload:t(i),globalConfigOverrides:o,localConfigOverrides:a}),u=r(c);return n({request:u})}}({sendEdgeNetworkRequest:a,createIdentityRequestPayload:Yt,createIdentityRequest:Xt,globalConfigOverrides:f}),y=function(e){var n=e.getBrowser;return se((function(){return de.includes(n())}))}({getBrowser:s}),b=function(e){var n=e.thirdPartyCookiesEnabled,t=e.areThirdPartyCookiesSupportedByDefault;return function(e){n&&t()&&e.setUseIdThirdPartyDomain()}}({thirdPartyCookiesEnabled:l,areThirdPartyCookiesSupportedByDefault:y}),E=function(e){var n=e.getLegacyEcid,t=e.addEcidToPayload;return function(e){return e.hasIdentity(Ft)?Promise.resolve():n().then((function(n){n&&t(e,n)}))}}({getLegacyEcid:v.getEcid,addEcidToPayload:Gt}),C=function(e){var n=e.locationSearch,t=e.dateProvider,r=e.orgId,o=e.logger;return function(e){if(!e.hasIdentity(Ft)){var i=Se.parse(n),a=i.adobe_mc;if(void 0!==a){Array.isArray(a)&&(o.warn("Found multiple adobe_mc query string paramters, only using the last one."),a=a[a.length-1]);var u=a.split("|").reduce((function(e,n){var t=c(n.split("="),2),r=t[0],o=t[1];return e[r]=Jt(o),e[r]=e[r].replace(/[^a-zA-Z0-9@.]/g,""),e}),{}),s=parseInt(u.TS,10),d=u.MCMID,l=Jt(u.MCORGID);t().getTime()/1e3<=s+300&&l===r&&d?(o.info("Found valid ECID identity "+d+" from the adobe_mc query string parameter."),e.addIdentity(Ft,{id:d})):o.info("Detected invalid or expired adobe_mc query string parameter.")}else{var f=w.get("mid"),p=w.get("apptype"),g=i.mid;void 0!==f&&void 0!==p&&["app:iphone rebranded","app:android rebranded","relia card app:iphone","relia card app:android","app:ipad rebranded"].includes(p)?(o.info("Found valid ECID identity from the legacy USBank cookie."),e.addIdentity(Ft,{id:f})):void 0!==g&&(o.info("Found valid ECID identity from the legacy mid query param."),e.addIdentity(Ft,{id:g}))}}}}({locationSearch:window.document.location.search,dateProvider:function(){return new Date},orgId:d,logger:t}),I=function(e){var n=e.doesIdentityCookieExist,t=e.orgId,r=e.logger;return function(e){var o=e.onResponse,i=e.onRequestFailure;return new Promise((function(e,a){o((function(){n()?e():(r.warn("Identity cookie not found. This could be caused by any of the following issues:\n\t* The org ID "+t+" configured in Alloy doesn't match the org ID specified in the edge configuration.\n\t* Experience edge was not able to set the identity cookie due to domain or cookie restrictions.\n\t* The request was canceled by the browser and not fully processed."),a(new Error("Identity cookie not found.")))})),i((function(){n()?e():a(new Error("Identity cookie not found."))}))}))}}({doesIdentityCookieExist:m,orgId:d,logger:t}),S=function(e){var n,t=e.doesIdentityCookieExist,r=e.setDomainForInitialIdentityPayload,o=e.addLegacyEcidToPayload,i=e.awaitIdentityCookie,a=e.logger,c=function(e){return r(e),o(e.getPayload())};return function(e){var r=e.request,o=e.onResponse,u=e.onRequestFailure;if(t())return r.setIsIdentityEstablished(),Promise.resolve();if(n){a.info("Delaying request while retrieving ECID from server.");var s=n;return n=s.catch((function(){return i({onResponse:o,onRequestFailure:u})})),s.then((function(){a.info("Resuming previously delayed request."),r.setIsIdentityEstablished()})).catch((function(){return c(r)}))}return(n=i({onResponse:o,onRequestFailure:u})).catch((function(){})),c(r)}}({doesIdentityCookieExist:m,setDomainForInitialIdentityPayload:b,addLegacyEcidToPayload:E,awaitIdentityCookie:I,logger:t}),D=function(e){var n=e.fireReferrerHideableImage,t=e.logger;return function(e){var r=e.filter((function(e){return"url"===e.type}));return r.length?Promise.all(r.map((function(e){return n(e.spec).then((function(){t.info(Ut(e,!0))})).catch((function(){t.error(Ut(e,!1))}))}))).then(we):Promise.resolve()}}({fireReferrerHideableImage:i,logger:t}),P=function(e){var n=e.processIdSyncs;return function(e){return n(e.getPayloadsByType("identity:exchange"))}}({processIdSyncs:D}),T=function(e){var n=e.dateProvider,t=e.orgId;return function(e,r){var o=Math.round(n().getTime()/1e3),i=encodeURIComponent("TS="+o+"|MCMID="+e+"|MCORGID="+encodeURIComponent(t)),a=c(r.match(Wt),4),u=a[1],s=a[2],d=a[3],l=function(e){return""===e?"?":"?"===e?"":"&"}(s);return""+u+s+l+"adobe_mc="+i+d}}({dateProvider:function(){return new Date},orgId:d}),O=function(e){var n=e.thirdPartyCookiesEnabled;return function(e){var t=Kt(e);if(!n&&t.namespaces.includes(Ht))throw new Error("namespaces: The CORE namespace cannot be requested when third-party cookies are disabled.");return t}}({thirdPartyCookiesEnabled:l}),R=function(e){var n=e.thirdPartyCookiesEnabled,t=e.areThirdPartyCookiesSupportedByDefault,r={identity:{fetch:[Ft]}};return n&&t()&&r.identity.fetch.push(Ht),function(e){e.mergeQuery(r)}}({thirdPartyCookiesEnabled:l,areThirdPartyCookiesSupportedByDefault:y}),N=er({orgId:d,cookieJar:g,logger:t});return function(e){var n,t=e.addEcidQueryToPayload,r=e.addQueryStringIdentityToPayload,i=e.ensureSingleIdentity,a=e.setLegacyEcid,c=e.handleResponseForIdSyncs,u=e.getNamespacesFromResponse,s=e.getIdentity,d=e.consent,l=e.appendIdentityToUrl,f=e.logger,p=e.getIdentityOptionsValidator,g=e.decodeKndctrCookie,v={};return{lifecycle:{onBeforeRequest:function(e){var n=e.request,o=e.onResponse,a=e.onRequestFailure;return t(n.getPayload()),r(n.getPayload()),i({request:n,onResponse:o,onRequestFailure:a})},onResponse:function(e){var t=e.response,r=u(t);return n&&n[Ft]||!r||!r[Ft]||a(r[Ft]),r&&Object.keys(r).length>0&&(n=o(o({},n),r)),v=o(o({},v),t.getEdge()),c(t)}},commands:{getIdentity:{optionsValidator:p,run:function(e){var t=e.namespaces;return d.awaitConsent().then((function(){if(!n){var r=g();if(!r||!t.includes(Ft)||(n||(n={}),n[Ft]=r,1!==t.length))return s(e)}})).then((function(){return{identity:t.reduce((function(e,t){return e[t]=n[t]||null,e}),{}),edge:v}}))}},appendIdentityToUrl:{optionsValidator:_t,run:function(e){return d.withConsent().then((function(){if(!n){var t=g();return t?(n||(n={}),void(n[Ft]=t)):s(e)}})).then((function(){return{url:l(n[Ft],e.url)}})).catch((function(n){return f.warn("Unable to append identity to url. "+n.message),e}))}}}}}({addEcidQueryToPayload:R,addQueryStringIdentityToPayload:C,ensureSingleIdentity:S,setLegacyEcid:v.setEcid,handleResponseForIdSyncs:P,getNamespacesFromResponse:Qt,getIdentity:h,consent:r,appendIdentityToUrl:T,logger:t,getIdentityOptionsValidator:O,decodeKndctrCookie:N})};nr.namespace="Identity",nr.configValidators=Bt;var tr=function(e){var n=e.config,t=e.componentRegistry,r=[].concat(u(t.getCommandNames()),[Xn,Yn]).sort(),i=o({},n);Object.keys(n).forEach((function(e){var t=n[e];"function"==typeof t&&(i[e]=t.toString())}));var a=t.getComponentNames();return{version:It,configs:i,commands:r,components:a}},rr=function(e){var n=e.config,t=e.componentRegistry;return{commands:{getLibraryInfo:{run:function(){return{libraryInfo:tr({config:n,componentRegistry:t})}}}}}};rr.namespace="LibraryInfo";var or,ir,ar,cr=Object.freeze({__proto__:null,context:qt,dataCollector:jt,identity:nr,libraryInfo:rr}),ur=pe(window),sr=window,dr=sr.console,lr=sr.fetch,fr=sr.navigator,pr=function(){return window.__alloyMonitors||[]},gr=Sn({debugEnabled:bn().default(!1),datastreamId:Dn().unique().required(),edgeDomain:Dn().domain().default("edge.adobedc.net"),edgeBasePath:Dn().nonEmpty().default("ee"),orgId:Dn().unique().required(),onBeforeEventSend:En().default(we),edgeConfigOverrides:On}).renamed("edgeConfigId",Dn().unique(),"datastreamId"),vr=function(e,n){for(var t,r,o="",i=e.location.hostname.toLowerCase().split("."),a=1;a<i.length&&!n.get(ee);)o=(t=i,r=a+=1,t.slice(-r)).join("."),n.set(ee,ee,{domain:o});return n.remove(ee,{domain:o}),o}(window,w),mr=function(e){var n=e.fetch;return function(e,t){return n(e,{method:"POST",cache:"no-cache",credentials:"include",headers:{"Content-Type":"text/plain; charset=UTF-8"},referrerPolicy:"no-referrer-when-downgrade",body:t}).then((function(e){return e.text().then((function(n){return{statusCode:e.status,getHeader:function(n){return e.headers.get(n)},body:n}}))}))}}({fetch:lr}),hr=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.appendNode,r=void 0===t?P:t,o=n.awaitSelector,i=void 0===o?G:o,a=n.createNode,u=void 0===a?T:a,s=n.fireImage,d=void 0===s?A:s,l=d,f=function(n){var t=n.src;return i("BODY").then((function(n){var t=c(n,1)[0];return e||(e=u("IFRAME",X,Y),r(t,e))})).then((function(e){var n=e.contentWindow.document;return d({src:t,currentDocument:n})}))};return function(e){var n=e.hideReferrer,t=e.url;return n?f({src:t}):l({src:t})}}(),yr=function(e){var n=e.window,t=(0,e.createNamespacedStorage)("validation.");return function(){var e=Se.parse(n.location.search).adb_validation_sessionid;if(!e)return"";var r=function(e){var n=e.persistent.getItem(lt);return n||(n=Le(),e.persistent.setItem(lt,n)),n}(t),o=e+"|"+r;return"&"+Se.stringify({adobeAepValidationToken:o})}}({window:window,createNamespacedStorage:ur}),wr=(or={userAgent:window.navigator.userAgent},ir=or.userAgent,se((function(){return function(e,n){for(var t=Object.keys(e),r=0;r<t.length;r+=1){var o=t[r];if(e[o].test(n))return o}return ue}(t(t(t(t(t(t({},ae,/Edge\/([0-9\._]+)/),ce,/Edg\/([0-9\.]+)/),ie,/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/),"Firefox",/Firefox\/([0-9\.]+)(?:\s|$)/),"IE",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/),"Safari",/Version\/([0-9\._]+).*Safari/),ir)}))),br=function(e){var n=e.instanceName,t=e.logController,r=t.setDebugEnabled,a=t.logger,c=t.createComponentLogger,u=e.components,s=qn(),d=xn(s),l=u.concat(Object.values(cr)),f=k({logger:a,cookieJar:w}),p=et({errorPrefix:"["+n+"]",logger:a}),g=Wn({logger:a,configureCommand:function(e){var t=$n({options:e,componentCreators:l,coreConfigValidators:gr,createConfig:Zn,logger:a,setDebugEnabled:r}),u=t.orgId,p=t.targetMigrationEnabled,g=gt({orgId:u,targetMigrationEnabled:p}),v=function(e){var n=e.cookieJar,t=e.shouldTransferCookie,r=e.apexDomain,o=e.dateProvider;return{cookiesToPayload:function(e,o){var i=""!==r&&o.endsWith(r),a={domain:r,cookiesEnabled:!0};if(!i){var c=n.get(),u=Object.keys(c).filter(t).map((function(e){return{key:e,value:c[e]}}));u.length&&(a.entries=u)}e.mergeState(a)},responseToCookies:function(e){e.getPayloadsByType("state:store").forEach((function(e){var t={domain:r},i=e.attrs&&e.attrs.SameSite&&e.attrs.SameSite.toLowerCase();void 0!==e.maxAge&&(t.expires=new Date(o().getTime()+1e3*e.maxAge)),void 0!==i&&(t.sameSite=i),"none"===i&&(t.secure=!0),n.set(e.key,e.value,t)}))}}}({cookieJar:f,shouldTransferCookie:g,apexDomain:vr,dateProvider:function(){return new Date}}),m=x(fr.sendBeacon)?function(e){var n=e.sendBeacon,t=e.sendFetchRequest,r=e.logger;return function(e,o){var i=new Blob([o],{type:"text/plain; charset=UTF-8"});return n(e,i)?Promise.resolve({statusCode:204,getHeader:function(){return null},body:""}):(r.info("Unable to use `sendBeacon`; falling back to `fetch`."),t(e,o))}}({sendBeacon:fr.sendBeacon.bind(fr),sendFetchRequest:mr,logger:a}):mr,h=function(e){var n=e.logger,t=e.sendFetchRequest,r=e.sendBeaconRequest,i=e.isRequestRetryable,a=e.getRequestRetryDelay;return function(e){var c=e.requestId,u=e.url,s=e.payload,d=e.useSendBeacon,l=JSON.stringify(s),f=JSON.parse(l);n.logOnBeforeNetworkRequest({url:u,requestId:c,payload:f});var p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(d?r:t)(u,l).then((function(t){var r;if(i({response:t,retriesAttempted:e})){var s=a({response:t,retriesAttempted:e});return new Promise((function(n){setTimeout((function(){n(p(e+1))}),s)}))}try{r=JSON.parse(t.body)}catch(e){}return n.logOnNetworkResponse(o(o({requestId:c,url:u,payload:f},t),{},{parsedBody:r,retriesAttempted:e})),{statusCode:t.statusCode,body:t.body,parsedBody:r,getHeader:t.getHeader}}))};return p().catch((function(e){throw n.logOnNetworkError({requestId:c,url:u,payload:f,error:e}),Oe({error:e,message:"Network request failed."})}))}}({logger:a,sendFetchRequest:mr,sendBeaconRequest:m,isRequestRetryable:bt,getRequestRetryDelay:Et}),y=function(e){var n=e.logger;return function(e){var t=e.statusCode,r=e.body,o=e.parsedBody;if(t<200||t>=300||!o&&204!==t||o&&!Array.isArray(o.handle)){var i=o?JSON.stringify(o,null,2):r;throw new Error(ht+" status code "+t+" and "+(i?"response body:\n"+i:"no response body."))}if(o){var a=o.warnings,c=void 0===a?[]:a,u=o.errors,s=void 0===u?[]:u;c.forEach((function(e){n.warn(ht+" warning:",e)})),s.forEach((function(e){n.error(ht+" non-fatal error:",e)}))}}}({logger:a}),b=function(e){var n=e.logger;return function(e){if(e){var t=e.split(";");if(t.length>=2&&t[1].length>0)try{var r=parseInt(t[1],10);if(!Number.isNaN(r))return{regionId:r}}catch(e){}n.warn('Invalid adobe edge: "'+e+'"')}return{}}}({logger:a}),E=function(e){var n=e.extractEdgeInfo;return function(e){var t=e.content,r=void 0===t?{}:t,o=e.getHeader,i=r.handle,a=void 0===i?[]:i,c=r.errors,u=void 0===c?[]:c,s=r.warnings,d=void 0===s?[]:s;return{getPayloadsByType:function(e){return a.filter((function(n){return n.type===e})).flatMap((function(e){return e.payload}))},getErrors:function(){return u},getWarnings:function(){return d},getEdge:function(){return n(o("x-adobe-edge"))},toJSON:function(){return r}}}}({extractEdgeInfo:b}),C=yt({orgId:u,cookieJar:w}),k=function(e){var n=e.config,t=e.lifecycle,r=e.cookieTransfer,o=e.sendNetworkRequest,i=e.createResponse,a=e.processWarningsAndErrors,c=e.getLocationHint,u=e.getAssuranceValidationTokenParams,s=n.edgeDomain,d=n.edgeBasePath,l=n.datastreamId,f=!1,p=function(e,n){var t=c(),r=t?d+"/"+t+n.getEdgeSubPath():""+d+n.getEdgeSubPath(),o=n.getDatastreamIdOverride()||l;return o!==l&&n.getPayload().mergeMeta({sdkConfig:{datastream:{original:l}}}),"https://"+e+"/"+r+"/v1/"+n.getAction()+"?configId="+o+"&requestId="+n.getId()+u()};return function(e){var n=e.request,c=e.runOnResponseCallbacks,u=void 0===c?we:c,d=e.runOnRequestFailureCallbacks,l=void 0===d?we:d,g=I();g.add(t.onResponse),g.add(u);var v=I();return v.add(t.onRequestFailure),v.add(l),t.onBeforeRequest({request:n,onResponse:g.add,onRequestFailure:v.add}).then((function(){var e=f||!n.getUseIdThirdPartyDomain()?s:"adobedc.demdex.net",t=p(e,n),i=n.getPayload();return r.cookiesToPayload(i,e),o({requestId:n.getId(),url:t,payload:i,useSendBeacon:n.getUseSendBeacon()})})).then((function(e){return a(e),e})).catch((function(e){if(function(e,n){return n.getUseIdThirdPartyDomain()&&function(e){return"TypeError"===e.name||"NetworkError"===e.name||0===e.status}(e)}(e,n)){f=!0,n.setUseIdThirdPartyDomain(!1);var t=p(s,n),i=n.getPayload();return r.cookiesToPayload(i,s),o({requestId:n.getId(),url:t,payload:i,useSendBeacon:n.getUseSendBeacon()})}return mt(v)(e)})).then((function(e){var n=e.parsedBody,t=e.getHeader,o=i({content:n,getHeader:t});return r.responseToCookies(o),g.call({response:o}).then(vt)}))}}({config:t,lifecycle:d,cookieTransfer:v,sendNetworkRequest:h,createResponse:E,processWarningsAndErrors:y,getLocationHint:C,getAssuranceValidationTokenParams:yr}),S=function(e){var n=e.cookieTransfer,t=e.lifecycle,r=e.createResponse,o=e.processWarningsAndErrors;return function(e){var i=e.request,a=e.responseHeaders,c=e.responseBody,u=e.runOnResponseCallbacks,s=void 0===u?we:u,d=e.runOnRequestFailureCallbacks,l=void 0===d?we:d,f=I();f.add(t.onResponse),f.add(s);var p=I();p.add(t.onRequestFailure),p.add(l);var g=function(e){return a[e]};return t.onBeforeRequest({request:i,onResponse:f.add,onRequestFailure:p.add}).then((function(){return o({statusCode:200,getHeader:g,body:JSON.stringify(c),parsedBody:c})})).catch(mt(p)).then((function(){var e=r({content:c,getHeader:g});return n.responseToCookies(e),f.call({response:e}).then(vt)}))}}({lifecycle:d,cookieTransfer:v,createResponse:E,processWarningsAndErrors:y}),D=function(e){var n=e.generalConsentState,t=e.logger,r=function(e,r){switch(e[Bn]){case Ln:n.in(r);break;case jn:n.out(r);break;case Un:n.pending(r);break;default:t.warn("Unknown consent value: "+e[Bn])}};return{initializeConsent:function(e,n){n[Bn]?r(n,Vn):r(e,Fn)},setConsent:function(e){r(e,zn)},suspend:function(){n.pending()},awaitConsent:function(){return n.awaitConsent()},withConsent:function(){return n.withConsent()},current:function(){return n.current()}}}({generalConsentState:Jn({logger:a}),logger:a}),P=function(e){var n=e.config,t=e.logger,r=e.lifecycle,a=e.consent,c=e.createEvent,u=e.createDataCollectionRequestPayload,s=e.createDataCollectionRequest,d=e.sendEdgeNetworkRequest,l=e.applyResponse,f=n.onBeforeEventSend,p=n.edgeConfigOverrides;return{createEvent:c,sendEvent:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=n.edgeConfigOverrides,l=i(n,ft),g=dt({payload:u(),localConfigOverrides:c,globalConfigOverrides:p}),v=s(g),m=I(),h=I();return r.onBeforeEvent(o(o({},l),{},{event:e,onResponse:m.add,onRequestFailure:h.add})).then((function(){return g.payload.addEvent(e),a.awaitConsent()})).then((function(){try{e.finalize(f)}catch(o){var n=function(){throw o};return h.add(r.onRequestFailure),h.call({error:o}).then(n,n)}if(!e.shouldSend()){h.add(r.onRequestFailure),t.info(pt);var o=new Error(pt);return h.call({error:o}).then((function(){}))}return d({request:v,runOnResponseCallbacks:m.call,runOnRequestFailureCallbacks:h.call})}))},applyResponse:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.renderDecisions,o=void 0!==t&&t,i=n.decisionContext,a=void 0===i?{}:i,c=n.responseHeaders,d=void 0===c?{}:c,f=n.responseBody,p=void 0===f?{handle:[]}:f,g=n.personalization,v=u(),m=s({payload:v}),h=I();return r.onBeforeEvent({event:e,renderDecisions:o,decisionContext:a,decisionScopes:[tt],personalization:g,onResponse:h.add,onRequestFailure:we}).then((function(){return v.addEvent(e),l({request:m,responseHeaders:d,responseBody:p,runOnResponseCallbacks:h.call})}))}}}({config:t,logger:a,lifecycle:d,consent:D,createEvent:Qn,createDataCollectionRequestPayload:ut,createDataCollectionRequest:it,sendEdgeNetworkRequest:k,applyResponse:S});return function(e){var n=e.componentCreators,t=e.lifecycle,r=e.componentRegistry,o=e.getImmediatelyAvailableTools;return n.forEach((function(e){var n,t=e.namespace,i=o(t);try{n=e(i)}catch(e){throw Oe({error:e,message:"["+t+"] An error occurred during component creation."})}r.register(t,n)})),t.onComponentsRegistered({lifecycle:t}).then((function(){return r}))}({componentCreators:l,lifecycle:d,componentRegistry:s,getImmediatelyAvailableTools:function(e){var r=c(e);return{config:t,componentRegistry:s,consent:D,eventManager:P,fireReferrerHideableImage:hr,logger:r,lifecycle:d,sendEdgeNetworkRequest:k,handleError:et({errorPrefix:"["+n+"] ["+e+"]",logger:r}),createNamespacedStorage:ur,apexDomain:vr,getBrowser:wr}}})},setDebugCommand:function(e){r(e.enabled,{fromConfig:!1})},handleError:p,validateCommandOptions:Kn});return g},Er=function(e){var n=function(e){var n=e.eventManager,t=e.lifecycle,r=e.handleError;return function(e){if(e.s_fe)return Promise.resolve();var o="composedPath"in e&&e.composedPath().length>0?e.composedPath()[0]:e.target,i=n.createEvent();return i.documentMayUnload(),t.onClick({event:i,clickedElement:o}).then((function(){return i.isEmpty()?Promise.resolve():n.sendEvent(i)})).then(we).catch((function(e){r(e,"click collection")}))}}({eventManager:e.eventManager,lifecycle:e.lifecycle,handleError:e.handleError});document.addEventListener("click",n,!0)},Cr="\\.(exe|zip|wav|mp3|mov|mpg|avi|wmv|pdf|doc|docx|xls|xlsx|ppt|pptx)$",Ir=Dn().regexp().default(Cr),kr=Sn({clickCollectionEnabled:bn().default(!0),clickCollection:Sn({internalLinkEnabled:bn().default(!0),externalLinkEnabled:bn().default(!0),downloadLinkEnabled:bn().default(!0),sessionStorageEnabled:bn().default(!1),eventGroupingEnabled:bn().default(!1),filterClickProperties:En()}).default({internalLinkEnabled:!0,externalLinkEnabled:!0,downloadLinkEnabled:!0,sessionStorageEnabled:!1,eventGroupingEnabled:!1}),downloadLinkQualifier:Ir,onBeforeLinkClickSend:En().deprecated('The field "onBeforeLinkClickSend" has been deprecated. Use "clickCollection.filterClickDetails" instead.')}),Sr=function(){return null!==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document).getElementById("cppXYctnr")},Dr=function(e){var n=e;return/^https?:\/\//i.test(n)||(n=window.location.protocol+"//"+e),new URL(n).hostname},Pr=function(e){var n=e.config,t=e.logger,r=e.getClickedElementProperties,o=e.clickActivityStorage,i=n.clickCollectionEnabled,a=n.clickCollection;return i?function(e){var i,c,u=e.event,s=e.clickedElement,d=r({clickActivityStorage:o,clickedElement:s,config:n,logger:t}),l=d.linkType;Sr()||(d.isValidLink()&&function(e,n){return n&&("download"===n&&!e.downloadLinkEnabled||"exit"===n&&!e.externalLinkEnabled||"other"===n&&!e.internalLinkEnabled)}(a,l)?t.info("Cancelling link click event due to clickCollection."+l+"LinkEnabled = false."):d.isInternalLink()&&a.eventGroupingEnabled&&(!n.onBeforeLinkClickSend||a.filterClickDetails)&&(i=window.location.hostname,c=d.linkUrl,Dr(i)===Dr(c))?o.save(d.properties):d.isValidLink()?(u.mergeXdm(d.xdm),u.mergeData(d.data),o.save({pageName:d.pageName,pageIDType:d.pageIDType})):d.isValidActivityMapData()&&o.save(d.properties))}:function(){}},Tr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.properties,t=e.logger,r=n||{};return{get pageName(){return r.pageName},set pageName(e){r.pageName=e},get linkName(){return r.linkName},set linkName(e){r.linkName=e},get linkRegion(){return r.linkRegion},set linkRegion(e){r.linkRegion=e},get linkType(){return r.linkType},set linkType(e){r.linkType=e},get linkUrl(){return r.linkUrl},set linkUrl(e){r.linkUrl=e},get pageIDType(){return r.pageIDType},set pageIDType(e){r.pageIDType=e},get clickedElement(){return r.clickedElement},set clickedElement(e){r.clickedElement=e},get properties(){return{pageName:r.pageName,linkName:r.linkName,linkRegion:r.linkRegion,linkType:r.linkType,linkUrl:r.linkUrl,pageIDType:r.pageIDType}},isValidLink:function(){return!!(r.linkUrl&&r.linkType&&r.linkName&&r.linkRegion)},isInternalLink:function(){return this.isValidLink()&&"other"===r.linkType},isValidActivityMapData:function(){return!!r.pageName&&!!r.linkName&&!!r.linkRegion&&void 0!==r.pageIDType},get xdm(){return r.filteredXdm?r.filteredXdm:function(e){return{eventType:"web.webinteraction.linkClicks",web:{webInteraction:{name:e.linkName,region:e.linkRegion,type:e.linkType,URL:e.linkUrl,linkClicks:{value:1}}}}}(this)},get data(){return r.filteredData?r.filteredData:function(e){return{__adobe:{analytics:{contextData:{a:{activitymap:{page:e.pageName,link:e.linkName,region:e.linkRegion,pageIDType:e.pageIDType}}}}}}}(this)},applyPropertyFilter:function(e){e&&!1===e(r)&&(t&&t.info("Clicked element properties were rejected by filter function: "+JSON.stringify(this.properties,null,2)),r={})},applyOptionsFilter:function(e){var n=this.options;if(n&&n.clickedElement&&(n.xdm||n.data)){if(e&&!1===e(n))return t&&t.info("Clicked element properties were rejected by filter function: "+JSON.stringify(this.properties,null,2)),void(this.options=void 0);this.options=n,r.filteredXdm=n.xdm,r.filteredData=n.data}},get options(){var e={};if(this.isValidLink()&&(e.xdm=this.xdm),this.isValidActivityMapData()&&(e.data=this.data),this.clickedElement&&(e.clickedElement=this.clickedElement),e.xdm||e.data)return e},set options(e){r={},e&&function(e,n){var t=e.xdm,r=e.data,o=e.clickedElement;if(n.clickedElement=o,t&&t.web&&t.web.webInteraction){var i=t.web.webInteraction,a=i.name,c=i.region,u=i.type,s=i.URL;n.linkName=a,n.linkRegion=c,n.linkType=u,n.linkUrl=s}if(r&&r.__adobe&&r.__adobe.analytics){var d=r.__adobe.analytics.contextData;if(d&&d.a&&d.a.activitymap){var l=d.a.activitymap,f=l.page,p=l.link,g=l.region,v=l.pageIDType;n.pageName=f||n.pageName,n.linkName=p||n.linkName,n.linkRegion=g||n.linkRegion,void 0!==v&&(n.pageIDType=v)}}}(e,r)}}},Or="clickData",Rr=function(e){return e&&e.replace(/\s+/g," ").trim()},Nr=/^(SCRIPT|STYLE|LINK|CANVAS|NOSCRIPT|#COMMENT)$/i,Ar=function(e){var n=[],t=!1;(function(e){return!(e&&e.nodeName&&e.nodeName.match(Nr))})(e)?(n.push(e),e.childNodes&&Array.prototype.slice.call(e.childNodes).forEach((function(e){var r=Ar(e);n=n.concat(r.supportedNodes),t=t||r.includesUnsupportedNodes}))):t=!0;return{supportedNodes:n,includesUnsupportedNodes:t}},xr=function(e,n,t){var r;return t&&t!==e.nodeName.toUpperCase()||(r=e.getAttribute(n)),r},Mr=/^(HEADER|MAIN|FOOTER|NAV)$/i,qr=function(e){var n;return"region"===e.role&&ye(e["aria-label"])&&(n=e["aria-label"]),n},Lr=function(e){var n;return e&&e.nodeName&&e.nodeName.match(Mr)&&(n=e.nodeName),n},jr=function(e){return!(!e.href||"A"!==e.tagName&&"AREA"!==e.tagName||e.onclick&&e.protocol&&!(e.protocol.toLowerCase().indexOf("javascript")<0))},Ur=function(e){return!!e&&!!e.onclick},Br=function(e){if("INPUT"===e.tagName){var n=e.getAttribute("type");if("submit"===n)return!0;if("image"===n&&e.src)return!0}return!1},_r=function(e){return"BUTTON"===e.tagName&&"submit"===e.type},Fr=function(e){var n=e.indexOf("?"),t=e.indexOf("#");return n>=0&&(n<t||t<0)?e.substring(0,n):t>=0?e.substring(0,t):e},Vr=function(e){var n=e.window,t=e.getLinkName,r=e.getLinkRegion,o=e.getAbsoluteUrlFromAnchorElement,i=e.findClickableElement,a=e.determineLinkType;return function(e){var c=e.clickedElement,u=e.config,s=e.logger,d=e.clickActivityStorage,l=u.onBeforeLinkClickSend,f=u.clickCollection.filterClickDetails,p=Tr({logger:s});if(c){var g=i(c);if(g){p.clickedElement=c,p.linkUrl=o(n,g),p.linkType=a(n,u,p.linkUrl,g),p.linkRegion=r(g),p.linkName=t(g),p.pageIDType=0,p.pageName=n.location.href;var v=d.load();v&&v.pageName&&(p.pageName=v.pageName,p.pageIDType=1),f?p.applyPropertyFilter(f):l&&p.applyOptionsFilter(l)}}return p}}({window:window,getLinkName:function(e){var n=Rr(e.innerText||e.textContent),t=Ar(e);if(!n||t.includesUnsupportedNodes){var r=function(e){var n={texts:[]};return e.supportedNodes.forEach((function(e){e.getAttribute&&(n.alt||(n.alt=Rr(e.getAttribute("alt"))),n.title||(n.title=Rr(e.getAttribute("title"))),n.inputValue||(n.inputValue=Rr(xr(e,"value","INPUT"))),n.imgSrc||(n.imgSrc=Rr(xr(e,"src","IMG")))),e.nodeValue&&n.texts.push(e.nodeValue)})),n}(t);(n=Rr(r.texts.join("")))||(n=r.alt||r.title||r.inputValue||r.imgSrc)}return n||""},getLinkRegion:function(e){for(var n,t=e.parentNode;t;){if(n=Rr(t.id||qr(t)||Lr(t)))return n;t=t.parentNode}return"BODY"},getAbsoluteUrlFromAnchorElement:function(e,n){var t=e.location,r=n.href||"";"string"!=typeof r&&(r="");var o,i=n.protocol,a=n.host;if(r&&(!(o=r)||!/^[a-z0-9]+:\/\//i.test(o))){i||(i=t.protocol?t.protocol:""),i=i?i+"//":"",a||(a=t.host?t.host:"");var c="";if("/"!==r.substring(0,1)){var u=t.pathname.lastIndexOf("/");u=u<0?0:u,c=t.pathname.substring(0,u)}r=""+i+a+c+"/"+r}return r},findClickableElement:function(e){for(var n=e;n;){if(jr(n)||Ur(n)||Br(n)||_r(n))return n;n=n.parentNode}return null},determineLinkType:function(e,n,t,r){var o="other";return ye(t)&&(!function(e,n,t){var r=!1;if(n)if(t&&t.download)r=!0;else if(e){var o=new RegExp(e),i=Fr(n).toLowerCase();r=o.test(i)}return r}(n.downloadLinkQualifier,t,r)?function(e,n){var t=!1;if(n&&e.location.hostname){var r=e.location.hostname.toLowerCase();t=Fr(n).toLowerCase().indexOf(r)<0}return t}(e,t)&&(o="exit"):o="download"),o}}),zr=function(e){if(!ar){var n=pe(window)(e.orgId||""),t=function(){var e={};return{getItem:function(n){return e[n]},setItem:function(n,t){e[n]=t},removeItem:function(n){delete e[n]}}}(),r=e.clickCollection.sessionStorageEnabled?n.session:t;ar=function(e){var n=e.storage;return{save:function(e){var t=JSON.stringify(e);n.setItem(Or,t)},load:function(){var e=null,t=n.getItem(Or);return t&&(e=JSON.parse(t)),e},remove:function(){n.removeItem(Or)}}}({storage:r})}},Hr=function(e){var n=e.config,t=e.eventManager,r=e.handleError,o=e.logger;!function(e,n){var t=e.clickCollectionEnabled,r=e.onBeforeLinkClickSend,o=e.downloadLinkQualifier;!1===t&&(r&&n.warn("The 'onBeforeLinkClickSend' configuration was provided but will be ignored because clickCollectionEnabled is false."),o&&o!==Cr&&n.warn("The 'downloadLinkQualifier' configuration was provided but will be ignored because clickCollectionEnabled is false."))}(n,o);var i=n.clickCollection;ar||zr(n);var a=Pr({config:n,logger:o,clickActivityStorage:ar,getClickedElementProperties:Vr}),c=function(e){var n=e.clickActivityStorage;return function(e){if(!Sr()){var t=n.load(),r=Tr({properties:t});if(r.isValidLink()||r.isValidActivityMapData()){if(r.isValidLink()){var o=r.xdm;delete o.eventType,e.mergeXdm(o)}r.isValidActivityMapData()&&e.mergeData(r.data),n.save({pageName:r.pageName,pageIDType:r.pageIDType})}}}}({clickActivityStorage:ar}),u=function(e){var n=e.clickActivityStorage;return function(e){n.save({pageName:e.getContent().xdm.web.webPageDetails.name,pageIDType:1})}}({clickActivityStorage:ar});return{lifecycle:{onComponentsRegistered:function(e){var n=e.lifecycle;Er({eventManager:t,lifecycle:n,handleError:r})},onClick:function(e){var n=e.event,t=e.clickedElement;a({event:n,clickedElement:t})},onBeforeEvent:function(e){var n=e.event;(function(e){var n=e.getContent();return void 0!==n.xdm&&void 0!==n.xdm.web&&void 0!==n.xdm.web.webPageDetails&&void 0!==n.xdm.web.webPageDetails.name})(n)&&(i.eventGroupingEnabled&&c(n),u(n,o,ar))}}}};Hr.namespace="ActivityCollector",Hr.configValidators=kr,Hr.buildOnInstanceConfiguredExtraParams=function(e){var n=e.config,t=e.logger;return ar||zr(n),{getLinkDetails:function(e){return Vr({clickActivityStorage:ar,clickedElement:e,config:n,logger:t}).properties}}};var Jr=function(e){var n=e.fireReferrerHideableImage,t=e.logger,r=e.cookieJar,i=e.isPageSsl?{sameSite:"none",secure:!0}:{};return function(e){return function(e){e.filter((function(e){return"cookie"===e.type})).forEach((function(e){var n=e.spec,t=n.name,a=n.value,c=n.domain,u=n.ttlDays;r.set(t,a||"",o({domain:c||"",expires:u||10},i))}))}(e),function(e){var r=e.filter((function(e){return"url"===e.type}));return Promise.all(r.map((function(e){return n(e.spec).then((function(){t.info(function(e){return"URL destination succeeded: "+e.spec.url}(e))})).catch((function(){}))}))).then(we)}(e)}},Gr=function(e){var n=e.processDestinations;return function(e){var t,r,o=e.response;return(t={response:o},r=t.response.getPayloadsByType("activation:push"),n(r)).then((function(){return{destinations:{response:o}.response.getPayloadsByType("activation:pull")}}))}},Qr=function(e){var n=e.logger,t=e.fireReferrerHideableImage,r=w.withConverter({write:function(e){return encodeURIComponent(e)}}),o=k({logger:n,cookieJar:r}),i=Jr({fireReferrerHideableImage:t,logger:n,cookieJar:o,isPageSsl:"https:"===window.location.protocol});return{lifecycle:{onResponse:Gr({processDestinations:i})},commands:{}}};Qr.namespace="Audiences";var Xr=function(e){return $(JSON.stringify(function(e){return De(e)}(e)))},Yr=["standard","version"],Wr=function(e){return e.standard+"."+e.version},Kr=function(){var e={},n=at({content:e,addIdentity:function(n,t){e.identityMap=e.identityMap||{},e.identityMap[n]=e.identityMap[n]||[],e.identityMap[n].push(t)},hasIdentity:function(n){return void 0!==(e.identityMap&&e.identityMap[n])}});return n.setConsent=function(n){e.consent=n},n},$r=function(e){var n=e.payload,t=e.datastreamIdOverride;return ot({payload:n,datastreamIdOverride:t,getAction:function(){return"privacy/set-consent"},getUseSendBeacon:function(){return!1}})},Zr=function(e){return e.split(";").reduce((function(e,n){var t=c(n.split("="),2),r=t[0],o=t[1];return e[r]=o,e}),{})},eo=Sn({consent:wn(yn()).required().nonEmpty(),identityMap:Tn,edgeConfigOverrides:On}).noUnknownFields().required(),no=Sn({defaultConsent:Pn(Ln,jn,Un).default(Ln)}),to=function(e){var n,r,o=e.config,a=e.consent,c=e.sendEdgeNetworkRequest,u=e.createNamespacedStorage,s=o.orgId,d=o.defaultConsent,l=function(e){var n=e.parseConsentCookie,t=e.orgId,r=e.cookieJar,o=re(t,"consent");return{read:function(){var e=r.get(o);return e?n(e):{}},clear:function(){r.remove(o)}}}({parseConsentCookie:Zr,orgId:s,cookieJar:w}),f=(n=0,r=Promise.resolve(),{addTask:function(e){n+=1;var t=function(){return e().finally((function(){n-=1}))};return r=r.then(t,t)},get length(){return n}}),g=function(e){var n=e.createConsentRequestPayload,t=e.createConsentRequest,r=e.sendEdgeNetworkRequest,o=e.edgeConfigOverrides;return function(e){var i=e.consentOptions,a=e.identityMap,c=e.edgeConfigOverrides,u=dt({payload:n(),globalConfigOverrides:o,localConfigOverrides:c});u.payload.setConsent(i),p(a)&&Object.keys(a).forEach((function(e){a[e].forEach((function(n){u.payload.addIdentity(e,n)}))}));var s=t(u);return r({request:s}).then((function(){}))}}({createConsentRequestPayload:Kr,createConsentRequest:$r,sendEdgeNetworkRequest:c,edgeConfigOverrides:o.edgeConfigOverrides}),v=function(e){var n=e.storage;return{clear:function(){n.clear()},lookup:function(e){var t={},r=function(e){var n=Wr(e);e.standard,e.version;var r=i(e,Yr);return t[n]||(t[n]=Xr(r).toString()),t[n]};return{isNew:function(){return e.some((function(e){var t=Wr(e),o=n.getItem(t);return null===o||o!==r(e)}))},save:function(){e.forEach((function(e){var t=Wr(e);n.setItem(t,r(e))}))}}}}}({storage:u(te(s)+".consentHashes.").persistent}),m=le({orgId:s});return function(e){var n=e.storedConsent,r=e.taskQueue,o=e.defaultConsent,i=e.consent,a=e.sendSetConsentRequest,c=e.validateSetConsentOptions,u=e.consentHashStore,s=e.doesIdentityCookieExist,d=t({},Bn,o),l=n.read(),f=s(),p=void 0!==l[Bn];f&&p||u.clear(),f||(n.clear(),l={}),i.initializeConsent(d,l);var g=function(){if(0===r.length){var e=n.read();void 0!==e[Bn]&&i.setConsent(e)}};return{commands:{setConsent:{optionsValidator:c,run:function(e){var n=e.consent,t=e.identityMap,o=e.edgeConfigOverrides;i.suspend();var c=u.lookup(n);return r.addTask((function(){return c.isNew()?a({consentOptions:n,identityMap:t,edgeConfigOverrides:o}):Promise.resolve()})).then((function(){return c.save()})).finally(g)}}},lifecycle:{onResponse:g,onRequestFailure:g}}}({storedConsent:l,taskQueue:f,defaultConsent:d,consent:a,sendSetConsentRequest:g,validateSetConsentOptions:eo,consentHashStore:v,doesIdentityCookieExist:m})};to.namespace="Consent",to.configValidators=no;var ro=function(){return{eventMergeId:Le()}},oo=function(){return function(e){return{commands:{createEventMergeId:{run:e.createEventMergeId}}}}({createEventMergeId:ro})};oo.namespace="EventMerge";var io={PAUSE:"media.pauseStart",PLAY:"media.play",BUFFER_START:"media.bufferStart",AD_START:"media.adStart",Ad_BREAK_START:"media.adBreakStart",SESSION_END:"media.sessionEnd",SESSION_START:"media.sessionStart",SESSION_COMPLETE:"media.sessionComplete",PING:"media.ping",AD_BREAK_COMPLETE:"media.adBreakComplete",AD_COMPLETE:"media.adComplete",AD_SKIP:"media.adSkip",BITRATE_CHANGE:"media.bitrateChange",CHAPTER_COMPLETE:"media.chapterComplete",CHAPTER_SKIP:"media.chapterSkip",CHAPTER_START:"media.chapterStart",ERROR:"media.error",STATES_UPDATE:"media.statesUpdate"},ao=function(e){var n=e.config,t=e.eventManager,r=e.consent,o=e.sendEdgeNetworkRequest,i=e.setTimestamp;return{createMediaEvent:function(e){var r=e.options,o=t.createEvent(),a=r.xdm;if(i(a),o.setUserXdm(a),a.eventType===io.AD_START){var c=r.xdm.mediaCollection.advertisingDetails;o.mergeXdm({mediaCollection:{advertisingDetails:{playerName:c.playerName||n.streamingMedia.playerName}}})}return o},createMediaSession:function(e){var r=n.streamingMedia,o=r.playerName,i=r.channel,a=r.appVersion,c=t.createEvent(),u=e.xdm.mediaCollection.sessionDetails;return c.setUserXdm(e.xdm),c.mergeXdm({eventType:io.SESSION_START,mediaCollection:{sessionDetails:{playerName:u.playerName||o,channel:u.channel||i,appVersion:u.appVersion||a}}}),c},augmentMediaEvent:function(e){var n=e.event,t=e.playerId,r=e.getPlayerDetails,o=e.sessionID;if(!t||!r)return n;var i=r({playerId:t}),a=i.playhead,c=i.qoeDataDetails;return n.mergeXdm({mediaCollection:{playhead:Re(a),qoeDataDetails:c,sessionID:o}}),n},trackMediaSession:function(e){var n=e.event,r={mediaOptions:e.mediaOptions,edgeConfigOverrides:e.edgeConfigOverrides};return t.sendEvent(n,r)},trackMediaEvent:function(e){var n=e.event,t=e.action,i=ut(),a=function(e){var n=e.mediaRequestPayload,t=e.action;return ot({payload:n,edgeSubPath:"/va",getAction:function(){return t},getUseSendBeacon:function(){return!1}})}({mediaRequestPayload:i,action:t});return i.addEvent(n),n.finalize(),r.awaitConsent().then((function(){return o({request:a}).then((function(){return{}}))}))}}},co="main",uo="completed",so=function(){var e;return{getSession:function(n){return e[n]||{}},storeSession:function(n){var t=n.playerId,r=n.sessionDetails;void 0===e&&(e={}),e[t]=r},stopPing:function(n){var t=n.playerId,r=e[t];r&&(clearTimeout(r.pingId),r.pingId=null,r.playbackState=uo)},savePing:function(n){var t=n.playerId,r=n.pingId,o=n.playbackState;e[t]&&(e[t].pingId&&clearTimeout(e[t].pingId),e[t].pingId=r,e[t].playbackState=o)}}},lo=function(e){var n=e.mediaEventManager,t=e.mediaSessionCacheManager,r=e.config,o=function(e){var i=n.createMediaEvent({options:e}),a=e.playerId,c=e.xdm.eventType,u=c.split(".")[1],s=t.getSession(a),d=s.getPlayerDetails,l=s.sessionPromise,f=s.playbackState;return l.then((function(e){return e.sessionId?(n.augmentMediaEvent({event:i,eventType:c,playerId:a,getPlayerDetails:d,sessionID:e.sessionId}),n.trackMediaEvent({event:i,action:u}).then((function(){if(a)if(c===io.SESSION_COMPLETE||c===io.SESSION_END)t.stopPing({playerId:a});else{var e=function(e,n){return e===io.AD_START||e===io.Ad_BREAK_START||e===io.AD_SKIP||e===io.AD_COMPLETE?"ad":e===io.AD_BREAK_COMPLETE||e===io.CHAPTER_COMPLETE||e===io.CHAPTER_START||e===io.CHAPTER_SKIP||e===io.SESSION_START?"main":e===io.SESSION_END||e===io.SESSION_COMPLETE?"completed":n}(c,f);if("completed"===e)return;var n="ad"===e?r.streamingMedia.adPingInterval:r.streamingMedia.mainPingInterval,i=setTimeout((function(){o({playerId:a,xdm:{eventType:io.PING}})}),1e3*n);t.savePing({playerId:a,pingId:i,playbackState:e})}}))):Promise.reject(new Error("Failed to trigger media event: "+c+". Session ID is not available for playerId: "+a+"."))}))};return function(e){return o(e)}},fo=function(e){var n=e.config,t=e.mediaEventManager,r=e.mediaSessionCacheManager,o=e.legacy,i=void 0!==o&&o;return function(e){if(!n.streamingMedia)return Promise.reject(new Error("Streaming media is not configured."));var o=e.playerId,a=e.getPlayerDetails,c=e.edgeConfigOverrides,u=t.createMediaSession(e);t.augmentMediaEvent({event:u,playerId:o,getPlayerDetails:a});var s=t.trackMediaSession({event:u,mediaOptions:{playerId:o,getPlayerDetails:a,legacy:i},edgeConfigOverrides:c});return r.storeSession({playerId:o,sessionDetails:{sessionPromise:s,getPlayerDetails:a,playbackState:co}}),s}},po=function(e){return!he(e)||!e.trim()},go=function(e){var n=e.mediaSessionCacheManager,t=e.config,r=e.trackMediaEvent;return function(e){var o=e.response,i=e.playerId,a=e.getPlayerDetails,c=o.getPayloadsByType("media-analytics:new-session");if(M(c)){var u=c[0].sessionId;if(po(u))return{};if(!i||!a)return{sessionId:u};var s=setTimeout((function(){r({playerId:i,xdm:{eventType:io.PING}})}),1e3*t.streamingMedia.mainPingInterval);return n.savePing({playerId:i,pingId:s,playbackState:co}),{sessionId:u}}return{}}},vo={Video:"video",Audio:"audio"},mo={VOD:"vod",Live:"live",Linear:"linear",Podcast:"podcast",Audiobook:"audiobook",AOD:"aod"},ho={FullScreen:"fullScreen",ClosedCaption:"closedCaptioning",Mute:"mute",PictureInPicture:"pictureInPicture",InFocus:"inFocus"},yo={AdBreakStart:"adBreakStart",AdBreakComplete:"adBreakComplete",AdStart:"adStart",AdComplete:"adComplete",AdSkip:"adSkip",ChapterStart:"chapterStart",ChapterComplete:"chapterComplete",ChapterSkip:"chapterSkip",SeekStart:"seekStart",SeekComplete:"seekComplete",BufferStart:"bufferStart",BufferComplete:"bufferComplete",BitrateChange:"bitrateChange",StateStart:"stateStart",StateEnd:"stateEnd"},wo="sessionStart",bo="sessionEnd",Eo="sessionComplete",Co="play",Io="pauseStart",ko="error",So="statesUpdate",Do={MediaResumed:"media.resumed",GranularAdTracking:"media.granularadtracking"},Po={Show:"a.media.show",Season:"a.media.season",Episode:"a.media.episode",AssetId:"a.media.asset",Genre:"a.media.genre",FirstAirDate:"a.media.airDate",FirstDigitalDate:"a.media.digitalDate",Rating:"a.media.rating",Originator:"a.media.originator",Network:"a.media.network",ShowType:"a.media.type",AdLoad:"a.media.adLoad",MVPD:"a.media.pass.mvpd",Authorized:"a.media.pass.auth",DayPart:"a.media.dayPart",Feed:"a.media.feed",StreamFormat:"a.media.format"},To={Artist:"a.media.artist",Album:"a.media.album",Label:"a.media.label",Author:"a.media.author",Station:"a.media.station",Publisher:"a.media.publisher"},Oo={Advertiser:"a.media.ad.advertiser",CampaignId:"a.media.ad.campaign",CreativeId:"a.media.ad.creative",PlacementId:"a.media.ad.placement",SiteId:"a.media.ad.site",CreativeUrl:"a.media.ad.creativeURL"},Ro=function(e){var n=e.logger;return{createMediaObject:function(e,t,r,o,i){var a={friendlyName:e,name:t,length:r,streamType:i,contentType:o},c=Sn({friendlyName:Dn().nonEmpty(),name:Dn().nonEmpty(),length:In().required(),streamType:Dn().nonEmpty(),contentType:Dn().nonEmpty()});try{var u=c(a);return{sessionDetails:{name:u.name,friendlyName:u.friendlyName,length:u.length,streamType:u.streamType,contentType:u.contentType}}}catch(e){return n.warn("An error occurred while creating the Media Object.",e),{}}},createAdBreakObject:function(e,t,r){var o={friendlyName:e,offset:t,index:r},i=Sn({friendlyName:Dn().nonEmpty(),offset:In(),index:In()});try{var a=i(o);return{advertisingPodDetails:{friendlyName:a.friendlyName,offset:a.offset,index:a.index}}}catch(e){return n.warn("An error occurred while creating the Ad Break Object.",e),{}}},createAdObject:function(e,t,r,o){var i={friendlyName:e,name:t,podPosition:r,length:o},a=Sn({friendlyName:Dn().nonEmpty(),name:Dn().nonEmpty(),podPosition:In(),length:In()});try{var c=a(i);return{advertisingDetails:{friendlyName:c.friendlyName,name:c.name,podPosition:c.podPosition,length:c.length}}}catch(e){return n.warn("An error occurred while creating the Advertising Object.",e),{}}},createChapterObject:function(e,t,r,o){var i={friendlyName:e,offset:t,length:r,index:o},a=Sn({friendlyName:Dn().nonEmpty(),offset:In(),length:In(),index:In()});try{var c=a(i);return{chapterDetails:{friendlyName:c.friendlyName,offset:c.offset,index:c.index,length:c.length}}}catch(e){return n.warn("An error occurred while creating the Chapter Object.",e),{}}},createStateObject:function(e){var t=Dn().matches(/^[a-zA-Z0-9_]{1,64}$/,"This is not a valid state name.");try{return{name:t(e)}}catch(e){return n.warn("An error occurred while creating the State Object.",e),{}}},createQoEObject:function(e,t,r,o){var i={bitrate:e,droppedFrames:t,fps:r,startupTime:o},a=Sn({bitrate:In(),droppedFrames:In(),fps:In(),startupTime:In()});try{var c=a(i);return{bitrate:c.bitrate,droppedFrames:c.droppedFrames,framesPerSecond:c.fps,timeToStart:c.startupTime}}catch(e){return n.warn("An error occurred while creating the QOE Object.",e),{}}}}},No={"a.media.show":"show","a.media.season":"season","a.media.episode":"episode","a.media.asset":"assetID","a.media.genre":"genre","a.media.airDate":"firstAirDate","a.media.digitalDate":"firstDigitalDate","a.media.rating":"rating","a.media.originator":"originator","a.media.network":"network","a.media.type":"showType","a.media.adLoad":"adLoad","a.media.pass.mvpd":"mvpd","a.media.pass.auth":"authorized","a.media.dayPart":"dayPart","a.media.feed":"feed","a.media.format":"streamFormat","a.media.artist":"artist","a.media.album":"album","a.media.label":"label","a.media.author":"author","a.media.station":"station","a.media.publisher":"publisher","media.resumed":"hasResume"},Ao={"a.media.ad.advertiser":"advertiser","a.media.ad.campaign":"campaignID","a.media.ad.creative":"creativeID","a.media.ad.placement":"placementID","a.media.ad.site":"siteID","a.media.ad.creativeURL":"creativeURL"},xo=function(e){var n=e.logger,t=e.trackMediaSession,r=e.trackMediaEvent,i=e.uuid,a=null,c=function(e){var n=e.eventType,t=e.mediaDetails,r=void 0===t?{}:t,i=e.contextData,a=void 0===i?[]:i,c=function(e){var n=e.eventType;return n===yo.BufferComplete||n===yo.SeekComplete?Co:n===yo.StateStart||n===yo.StateEnd?So:n===yo.SeekStart?Io:n}({eventType:n});if(n===yo.StateStart)return{eventType:"media."+c,mediaCollection:{statesStart:[r]}};if(n===yo.StateEnd)return{eventType:"media."+c,mediaCollection:{statesEnd:[r]}};var u={eventType:"media."+c,mediaCollection:o({},r)},s=[];return Object.keys(a).forEach((function(e){No[e]?u.mediaCollection.sessionDetails[No[e]]=a[e]:Ao[e]?u.mediaCollection.advertisingDetails[Ao[e]]=a[e]:s.push({name:e,value:a[e]})})),M(s)&&(u.mediaCollection.customMetadata=s),u};return{trackSessionStart:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(f(e)||W(e))return n.warn("Invalid media object"),{};null===a&&(n.warn("The Media Session was completed. Restarting a new session."),a={qoe:null,lastPlayhead:0,playerId:i()});var o=c({eventType:wo,mediaDetails:e,contextData:r});return t({playerId:a.playerId,getPlayerDetails:function(){return{playhead:a.lastPlayhead,qoeDataDetails:a.qoe}},xdm:o})},trackPlay:function(){if(null===a)return n.warn("The Media Session was completed."),{};var e=c({eventType:Co});return r({playerId:a.playerId,xdm:e})},trackPause:function(){if(null===a)return n.warn("The Media Session was completed."),{};var e=c({eventType:Io});return r({playerId:a.playerId,xdm:e})},trackSessionEnd:function(){if(null===a)return n.warn("The Media Session was completed."),{};var e=c({eventType:bo});return r({playerId:a.playerId,xdm:e})},trackComplete:function(){if(null===a)return n.warn("The Media Session was completed."),{};var e=c({eventType:Eo});return r({playerId:a.playerId,xdm:e})},trackError:function(e){if(n.warn("trackError("+e+")"),null===a)return n.warn("The Media Session was completed."),{};var t=c({eventType:ko,mediaDetails:{errorDetails:{name:e,source:"player"}}});return r({playerId:a.playerId,xdm:t})},trackEvent:function(e,t,o){if(W(t))return n.warn("Invalid media object."),{};if(null===a)return n.warn("The Media Session was completed."),{};if(!Object.values(yo).includes(e))return n.warn("Invalid event type"),{};var i=c({eventType:e,mediaDetails:t,contextData:o});return r({playerId:a.playerId,xdm:i})},updatePlayhead:function(e){null!==a?ve(e)&&(a.lastPlayhead=parseInt(e,10)):n.warn("The Media Session was completed.")},updateQoEObject:function(e){null!==a?e&&(a.qoe=e):n.warn("The Media Session was completed.")},destroy:function(){n.warn("Destroy called, destroying the tracker."),a=null}}},Mo=function(e){var n=e.eventManager,t=e.sendEdgeNetworkRequest,r=e.config,i=e.logger,a=e.consent,c=so(),u=ao({sendEdgeNetworkRequest:t,config:r,consent:a,eventManager:n,setTimestamp:Ct((function(){return new Date}))}),s=lo({mediaSessionCacheManager:c,mediaEventManager:u,config:r}),d=fo({config:r,mediaEventManager:u,mediaSessionCacheManager:c,legacy:!0});return function(e){var n=e.trackMediaEvent,t=e.trackMediaSession,r=e.mediaResponseHandler,i=e.logger,a=e.createMediaHelper,c=e.createGetInstance,u=e.config;return{lifecycle:{onBeforeEvent:function(e){var n=e.mediaOptions,t=e.onResponse,o=void 0===t?we:t;if(n){var i=n.legacy,a=n.playerId,c=n.getPlayerDetails;i&&o((function(e){var n=e.response;return r({playerId:a,getPlayerDetails:c,response:n})}))}}},commands:{getMediaAnalyticsTracker:{run:function(){if(!u.streamingMedia)return Promise.reject(new Error("Streaming media is not configured."));i.info("Streaming media is configured in legacy mode.");var e=a({logger:i});return Promise.resolve(o({getInstance:function(){return c({logger:i,trackMediaEvent:n,trackMediaSession:t,uuid:Le})},Event:yo,MediaType:vo,PlayerState:ho,StreamType:mo,MediaObjectKey:Do,VideoMetadataKeys:Po,AudioMetadataKeys:To,AdMetadataKeys:Oo},e))}}}}}({mediaResponseHandler:go({mediaSessionCacheManager:c,config:r,trackMediaEvent:s}),trackMediaSession:d,trackMediaEvent:s,createMediaHelper:Ro,createGetInstance:xo,logger:i,config:r})};Mo.namespace="Legacy Media Analytics";var qo,Lo="web",jo="webapp",Uo="://",Bo=/^(\w+):\/\/([^/#]+)(\/[^#]*)?(#.*)?$/,_o=/^(?:.*@)?(?:[a-z\d\u00a1-\uffff.-]+|\[[a-f\d:]+])(?::\d+)?$/,Fo=/^\/(?:[/\w\u00a1-\uffff-.~]|%[a-fA-F\d]{2})*$/,Vo=/^#(?:[/\w\u00a1-\uffff-.~]|%[a-fA-F\d]{2})+$/,zo=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",n=e.length;n>0&&-1!=="/".indexOf(e.charAt(n-1));)n-=1;return e.substring(0,n)||"/"},Ho=function(e){return""+e.surfaceType+Uo+e.authority+(e.path||"")+(e.fragment||"")},Jo=function(e){var n=e(),t=n.host.toLowerCase(),r=n.pathname;return Lo+Uo+t+zo(r)},Go=function(e,n,t){var r=function(e){return t.warn(e),null};if(!ye(e))return r("Invalid surface: "+e);var o,i,a,c,u=function(e,n){return e.startsWith("#")?Jo(n)+e:e}(e,n),s=(c=u.match(Bo))?{surfaceType:(a=c[1],ye(a)?a.toLowerCase():""),authority:(i=c[2],ye(i)?i.toLowerCase():""),path:(o=c[3],ye(o)?zo(o):"/"),fragment:c[4]}:null;return null===s?r("Invalid surface: "+e):[Lo,jo].includes(s.surfaceType)?s.authority&&_o.test(s.authority)?s.path&&!Fo.test(s.path)?r("Invalid path "+s.path+" in surface: "+e):s.fragment&&!Vo.test(s.fragment)?r("Invalid fragment "+s.fragment+" in surface: "+e):s:r("Invalid authority "+s.authority+" in surface: "+e):r("Unsupported surface type "+s.surfaceType+" in surface: "+e)},Qo=function(e){return!!e&&0===e.indexOf(Lo+Uo)&&-1===e.indexOf("#")},Xo="https://ns.adobe.com/personalization/default-content-item",Yo="https://ns.adobe.com/personalization/dom-action",Wo="https://ns.adobe.com/personalization/html-content-item",Ko="https://ns.adobe.com/personalization/json-content-item",$o="https://ns.adobe.com/personalization/ruleset-item",Zo="https://ns.adobe.com/personalization/redirect-item",ei="https://ns.adobe.com/personalization/message/in-app",ni=function(e){return e.filter((function(n,t){return e.indexOf(n)===t}))},ti=function(e){var n=e.getPageLocation,t=e.renderDecisions,r=e.decisionScopes,o=e.personalization,i=e.event,a=e.isCacheInitialized,c=e.logger,s=i.getViewName();return{isRenderDecisions:function(){return t},isSendDisplayEvent:function(){return!!o.sendDisplayEvent},shouldIncludeRenderedPropositions:function(){return!!o.includeRenderedPropositions},getViewName:function(){return s},hasScopes:function(){return r.length>0||M(o.decisionScopes)},hasSurfaces:function(){return M(o.surfaces)},hasViewName:function(){return ye(s)},createQueryDetails:function(){var e=u(r);M(o.decisionScopes)&&e.push.apply(e,u(o.decisionScopes));var t=function(){var e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(t){return Go(t,e,n)})).filter((function(e){return!f(e)})).map(Ho)}(o.surfaces,n,c);this.shouldRequestDefaultPersonalization()&&(function(e){e.includes(tt)||e.push(tt)}(e),function(e,n){var t=Jo(n);e.includes(t)||e.push(t)}(t,n));var i=[Xo,Wo,Ko,Zo,$o,ei,"https://ns.adobe.com/personalization/message/content-card"];return e.includes(tt)&&i.push(Yo),{schemas:i,decisionScopes:ni(e),surfaces:ni(t)}},isCacheInitialized:function(){return a},shouldFetchData:function(){return this.hasScopes()||this.hasSurfaces()||this.shouldRequestDefaultPersonalization()},shouldUseCachedData:function(){return this.hasViewName()&&!this.shouldFetchData()},shouldRequestDefaultPersonalization:function(){return o.defaultPersonalizationEnabled||!this.isCacheInitialized()&&!1!==o.defaultPersonalizationEnabled}}},ri="decisioning.propositionDisplay",oi="decisioning.propositionInteract",ii="decisioning.propositionTrigger",ai="decisioning.propositionDismiss",ci="decisioning.propositionSuppressDisplay",ui={DISPLAY:"display",INTERACT:"interact",TRIGGER:"trigger",DISMISS:"dismiss",SUPPRESS:"suppressDisplay"},si=t(t(t(t(t({},ri,ui.DISPLAY),oi,ui.INTERACT),ii,ui.TRIGGER),ai,ui.DISMISS),ci,ui.SUPPRESS),di=t(t(t(t(t({},ui.DISPLAY,ri),ui.INTERACT,oi),ui.TRIGGER,ii),ui.DISMISS,ai),ui.SUPPRESS,ci),li=function(e){return si[e]},fi=function(e){return di[e]},pi={propositions:[]},gi=function(e){var n=e.getPageLocation,t=e.logger,r=e.fetchDataHandler,o=e.viewChangeHandler,i=e.onClickHandler,a=e.isAuthoringModeEnabled,c=e.mergeQuery,u=e.viewCache,s=e.showContainers,d=e.applyPropositions,l=e.setTargetMigration,f=e.mergeDecisionsMeta,p=e.renderedPropositions,g=e.onDecisionHandler,v=e.handleConsentFlicker;return{lifecycle:{onComponentsRegistered:function(){v()},onDecision:g,onBeforeRequest:function(e){var n=e.request;return l(n),Promise.resolve()},onBeforeEvent:function(e){var i=e.event,d=e.renderDecisions,l=e.decisionScopes,g=void 0===l?[]:l,v=e.personalization,m=void 0===v?{}:v,h=e.onResponse,y=void 0===h?we:h,w=e.onRequestFailure,b=void 0===w?we:w;if(y((function(){return{propositions:[]}})),b((function(){return s()})),a())return t.warn("Rendering is disabled for authoring mode."),c(i,{enabled:!1}),Promise.resolve();var E=ti({getPageLocation:n,renderDecisions:d,decisionScopes:g,personalization:m,event:i,isCacheInitialized:u.isInitialized(),logger:t}),C=[];if(E.shouldIncludeRenderedPropositions()&&C.push(p.clear()),E.shouldFetchData()){var I=u.createCacheUpdate(E.getViewName());b((function(){return I.cancel()})),r({cacheUpdate:I,personalizationDetails:E,event:i,onResponse:y})}else E.shouldUseCachedData()&&C.push(o({personalizationDetails:E,event:i,onResponse:y,onRequestFailure:b}));return Promise.all(C).then((function(e){var n=e.flatMap((function(e){return e}));M(n)&&f(i,n,[ui.DISPLAY])}))},onClick:function(e){var n=e.event,t=e.clickedElement;i({event:n,clickedElement:t})}},commands:{applyPropositions:{optionsValidator:function(e){return function(e){var n=e.logger,t=e.options,r=Sn({propositions:wn(Sn({id:Dn().required(),scope:Dn().required(),scopeDetails:Sn({decisionProvider:Dn().required()}).required(),items:wn(Sn({id:Dn().required(),schema:Dn().required(),data:Sn(yn())})).nonEmpty().required()}).required()).nonEmpty().required(),metadata:Sn(yn()),viewName:Dn()}).required();try{return r(t)}catch(e){return n.warn("Invalid options for applyPropositions. No propositions will be applied.",e),pi}}({logger:t,options:e})},run:d}}}},vi=function(){return T("DIV",{},{innerHTML:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"})},mi=/:eq\((\d+)\)/g,hi=function(e){return-1===e.indexOf(":eq(")},yi=/(#|\.)(-?\w+)/g,wi=function(e,n,t){return""+n+CSS.escape(t)},bi=function(e){for(var n=[],t=function(e){return e.split(mi).filter(ye)}(function(e){return e.replace(yi,wi)}(e.trim())),r=t.length,o=0;o<r;){var i=t[o],a=t[o+1];a?n.push({sel:i,eq:Number(a)}):n.push({sel:i}),o+=2}return n},Ei=function(e){var n=document;if(hi(e))return F(e,n);for(var t=bi(e),r=t.length,o=[],i=n,a=0;a<r;){var u=t[a],s=u.sel,d=u.eq,l=F(s,i),f=l.length;if(0===f)break;if(null!=d&&d>f-1)break;if(a<r-1)if(null==d)i=c(l,1)[0];else i=l[d];a===r-1&&(o=null==d?l:[l[d]]),a+=1}return o},Ci=function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).getElementById(e)},Ii=function(e,n,t){e.setAttribute(n,t)},ki=function(e,n){return e.getAttribute(n)},Si=function(e,n,t,r){var o;o=r?n+":"+t+" !"+r+";":n+":"+t+";",e.style.cssText+=";"+o},Di=function(e){return e.parentNode},Pi=function(e,n){if(e){var t=Di(e);t&&t.insertBefore(n,function(e){return e.nextElementSibling}(e))}},Ti=function(e,n){if(e){var t=Di(e);t&&t.insertBefore(n,e)}},Oi=function(e){var n=e.childNodes;return n?q(n):[]},Ri=function(e){return e.firstElementChild},Ni=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(void 0===qo){var n=e.querySelector("[nonce]");qo=n&&(n.nonce||n.getAttribute("nonce"))}return qo},Ai="src",xi=function(e){return T(O,{src:e})},Mi=function(e){F(O,e).forEach((function(e){var n=ki(e,Ai);n&&xi(n)}))},qi=function(e){return function(e,n){return e.tagName===n}(e,R)&&!ki(e,Ai)},Li=function(e){var n=F(R,e),t=n.length,r=Ni();if(r)for(var o=0;o<t;o+=1){var i=n[o];qi(i)&&(i.nonce=r)}},ji=function(e){var n=document.createElement("script");n.src=e,n.async=!0;var t=function(e,n){return new Promise((function(t,r){n.onload=function(){t(n)},n.onerror=function(){r(new Error("Failed to load script: "+e))}}))}(e,n);return document.head.appendChild(n),t},Ui=function(e,n){return!!e&&e.tagName===n},Bi=function(e){return Ui(e,N)&&!ki(e,Ai)},_i=function(e){return Ui(e,N)&&ki(e,Ai)},Fi=function(e){for(var n=F(N,e),t=[],r=n.length,i=Ni(),a=o({},i&&{nonce:i}),c=0;c<r;c+=1){var u=n[c];if(Bi(u)){var s=u.textContent;s&&t.push(T(N,a,{textContent:s}))}}return t},Vi=function(e){for(var n=F(N,e),t=[],r=n.length,o=0;o<r;o+=1){var i=n[o];if(_i(i)){var a=ki(i,Ai);a&&t.push(a)}}return t},zi=function(e,n){n.forEach((function(n){e.appendChild(n),e.removeChild(n)}))},Hi=function(e){return Promise.all(e.map(ji))},Ji=function(e,n,t){var r=vi(n);Li(r);var o=Oi(r),i=Fi(r),a=Vi(r);return Mi(r),o.forEach((function(n){P(e,n)})),t(e),zi(e,i),Hi(a)},Gi=function(e,n,t){return function(e){Oi(e).forEach(Q)}(e),Ji(e,n,t)},Qi=function(e,n,t){var r=vi(n);Li(r);var o=Oi(r),i=Fi(r),a=Vi(r),c=o.length-1;for(Mi(r);c>=0;){var u=o[c];t(u);var s=Ri(e);s?Ti(s,u):P(e,u),c-=1}return zi(e,i),Hi(a)},Xi="alloy-prehiding",Yi={},Wi=function(e){if(!Yi[e]){var n=Ni(),t=o({},n&&{nonce:n}),r=T(R,t,{textContent:e+" { visibility: hidden }"});P(document.head,r),Yi[e]=r}},Ki=function(e){var n=Yi[e];n&&(Q(n),delete Yi[e])},$i=function(e,n,t){t(e),e.textContent=n},Zi=function(e,n,t){var r=vi(n);Li(r);var o=Oi(r),i=Fi(r),a=Vi(r);return Mi(r),o.forEach((function(n){t(n),Ti(e,n)})),zi(e,i),Hi(a)},ea=function(e,n,t){return Zi(e,n,t).then((function(){Q(e)}))},na=function(e,n,t){var r=vi(n);Li(r);var o=Oi(r),i=Fi(r),a=Vi(r);Mi(r);var c=e;return o.forEach((function(e){t(e),Pi(c,e),c=e})),zi(e,i),Hi(a)},ta=["priority"],ra=function(e,n,t){var r=n.priority,o=i(n,ta);Object.keys(o).forEach((function(n){Si(e,n,o[n],r)})),t(e)},oa=function(e,n,t){Object.keys(n).forEach((function(t){Ii(e,t,n[t])})),t(e)},ia=function(e,n,t){e.tagName===O&&(xi(n),t(e),function(e,n){e.removeAttribute(n)}(e,Ai),Ii(e,Ai,n))},aa=function(e,n,t){var r=n.from,o=n.to,i=function(e){var n=e.children;return n?q(n):[]}(e),a=i[r],c=i[o];a&&c&&(r<o?Pi(c,a):Ti(c,a),t(c),t(a))},ca=function(e){return function(n,t){var r=n.selector,o=n.prehidingSelector,i=n.content;return Wi(o),G(r,Ei).then((function(n){return function(e,n,t,r){var o=e.map((function(e){return r(e,n,t)}));return Promise.all(o)}(n,i,t,e)})).then((function(){Ki(o)}),(function(e){throw Ki(o),e}))}},ua=function(e){return(""+e).endsWith("px")?e:e+"px"},sa=["priority"],da=function(e,n,t){var r=n.priority,o=i(n,sa);Object.keys(o).forEach((function(n){var t=o[n];"left"!==n&&"top"!==n||(t=ua(t)),Si(e,n,t,r)})),t(e)},la=function(e,n,t){t(e)},fa=["priority"],pa=function(e,n,t){var r=n.priority,o=i(n,fa);Object.keys(o).forEach((function(n){var t=o[n];"width"!==n&&"height"!==n||(t=ua(t)),Si(e,n,t,r)})),t(e)},ga="customCode",va="appendHtml",ma="click",ha="collectInteractions",ya=function(e){var n=e.eventManager,t=e.mergeDecisionsMeta;return function(e){var r=e.decisionsMeta,o=void 0===r?[]:r,i=e.propositionAction,a=e.documentMayUnload,c=void 0!==a&&a,u=e.eventType,s=void 0===u?ri:u,d=e.propositionEventTypes,l=void 0===d?[li(s)]:d,f=e.viewName,p=n.createEvent(),g={eventType:s};return f&&(g.web={webPageDetails:{viewName:f}}),M(o)&&t(p,o,l,i),p.mergeXdm(g),c&&p.documentMayUnload(),n.sendEvent(p)}},wa=function(e,n){if(hi(e))return function(e,n){return n.matches?n.matches(e):n.msMatchesSelector(e)}(e,n);for(var t=Ei(e),r=!1,o=0;o<t.length;o+=1)if(t[o]===n){r=!0;break}return r},ba="view",Ea=["trackingLabel","scopeType"],Ca=function(e){return e.map((function(e){return e.trackingLabel,e.scopeType,i(e,Ea)}))},Ia=function(e){return e.filter((function(n,t){var r=JSON.stringify(n);return t===e.findIndex((function(e){return JSON.stringify(e)===r}))}))},ka=function(e,n,t){for(var r=document.documentElement,o=e,i=0;o&&o!==r;){if(wa(n,o)){var a=t(n),c={metas:a},u=a.find((function(e){return e.trackingLabel}));u&&(c.label=u.trackingLabel,c.weight=i);var s=a.find((function(e){return e.scopeType===ba}));return s&&(c.viewName=s.scope,c.weight=i),c}o=o.parentNode,i+=1}return{metas:null}},Sa=function(e,n,t){for(var r,o=[],i="",a=Number.MAX_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,s=0;s<n.length;s+=1){var d=ka(e,n[s],t),l=d.metas,f=d.label,p=d.weight,g=d.viewName;l&&(f&&p<=a&&(i=f,a=p),g&&p<=c&&(r=g,c=p),o.push.apply(o,u(Ca(l))))}return{decisionsMeta:Ia(o),propositionActionLabel:i,propositionActionToken:void 0,viewName:r}},Da=function(){return-1!==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document).location.href.indexOf("adobe_authoring_enabled")},Pa=function(e,n,t,r){if(0!==n.length){var o={};t.forEach((function(e){o[e]=1}));var i={_experience:{decisioning:{propositions:n,propositionEventType:o}}};r&&(i._experience.decisioning.propositionAction=r),e.mergeXdm(i)}},Ta=function(e,n){e.mergeQuery({personalization:o({},n)})},Oa=function(){var e={};return{storeClickMeta:function(n){var t=n.selector,r=n.meta,o=r.id,i=r.scope,a=r.scopeDetails,c=r.trackingLabel,u=r.scopeType;e[t]||(e[t]={}),e[t][o]={scope:i,scopeDetails:a,trackingLabel:c,scopeType:u}},getClickSelectors:function(){return Object.keys(e)},getClickMetas:function(n){return e[n]?function(e){return Object.keys(e).map((function(n){return o({id:n},e[n])}))}(e[n]):{}}}},Ra=function(e,n){return e===Ko&&n===ha},Na=t(t(t(t(t({},Yo,(function(){return!0})),Wo,(function(){return!0})),Ko,Ra),ei,(function(){return!0})),Xo,(function(){return!0})),Aa=function(e){var n=e.processPropositions,t=e.createProposition,r=e.renderedPropositions,i=e.viewCache,a=function(e){var n=e.items,t=e.metadataForScope,r=void 0===t?{}:t,i=r.actionType,a=r.selector;return n.filter((function(e){return function(e,n){return"function"==typeof Na[e]&&Na[e](e,n)}(e.schema,i)})).map((function(e){var n=e.schema;return n===Wo||Ra(n,i)?W(r)?void 0:o(o({},e),{},{schema:Ra(n,i)?Yo:n,data:o(o({},e.data),{},{selector:a,type:i})}):o({},e)})).filter((function(e){return e}))},c=function(e){return!(e.scope===tt&&e.renderAttempted)};return function(e){var o=e.propositions,s=void 0===o?[]:o,d=e.metadata,l=void 0===d?{}:d,f=e.viewName,p=S();r.concat(p.promise);var g=function(e){var n=e.propositions,t=e.metadata;return n.filter(c).map((function(e){return M(e.items)?{id:e.id,scope:e.scope,scopeDetails:e.scopeDetails,items:a({items:e.items,metadataForScope:t[e.scope]})}:e})).filter((function(e){return M(e.items)}))}({propositions:s,metadata:l}).map((function(e){return t(e)}));return Promise.resolve().then((function(){return f?i.getView(f):[]})).then((function(e){var t=n([].concat(u(g),u(e))),r=t.render,o=t.returnedPropositions;return r().then(p.resolve),{propositions:o}}))}},xa=function(e){var n=e.selector;return e.type!==ga||"BODY > *:eq(0)"!==n?e:o(o({},e),{selector:"BODY"})},Ma=function(e){var n=o({},e),t=n.content,r=n.selector;if(po(t))return n;if(null==r)return n;var i=Ei(r);return Ui(i[0],"HEAD")?(n.type=va,n.content=function(e){var n=vi(e);return F("SCRIPT,LINK,STYLE",n).map((function(e){return e.outerHTML})).join("")}(t),n):n},qa=function(e){var n=e.preprocess,t=e.isPageWideSurface;return function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.id,c=e.scope,u=e.scopeDetails,s=e.items,d=void 0===s?[]:s,l=(u||{}).characteristics,f=(void 0===l?{}:l).scopeType;return{getScope:function(){return c},getScopeType:function(){return c===tt||t(c)?"page":f===ba?ba:"proposition"},getItems:function(){var e=this;return d.map((function(t){return function(e,t){var r=e.id,o=e.schema,i=e.data,a=e.characteristics,c=(void 0===a?{}:a).trackingLabel,u=i?i.type:void 0,s=n(i);return{getId:function(){return r},getSchema:function(){return o},getSchemaType:function(){return u},getData:function(){return s},getProposition:function(){return t},getTrackingLabel:function(){return c},getOriginalItem:function(){return e},toString:function(){return JSON.stringify(e)},toJSON:function(){return e}}}(t,e)}))},getNotification:function(){return{id:a,scope:c,scopeDetails:u}},getId:function(){return a},toJSON:function(){return e},shouldSuppressDisplay:function(){return i},addToReturnValues:function(n,t,i,a){r&&(n.push(o(o({},e),{},{items:i.map((function(e){return e.getOriginalItem()})),renderAttempted:a})),a||t.push(o(o({},e),{},{items:i.map((function(e){return e.getOriginalItem()}))})))}}}},La=function(){return{render:we,setRenderAttempted:!0,includeInNotification:!0}},ja="always",Ua="never",Ba="decoratedElementsOnly",_a=[ja,Ua,Ba],Fa="data-aep-interact-id",Va="data-aep-click-label",za=0,Ha=function(e,n,t,r,o,i,a,c){var u=a.scopeDetails;return function(e,n){return!!e&&!!e[n]&&[ja,Ba].includes(e[n])}(e,(void 0===u?{}:u).decisionProvider)||n===ma?function(e){if(e.tagName){var n,u=(n=ki(e,Fa))?parseInt(n,10):++za;c(t,r,i,a,u),Ii(e,Fa,u),o&&!ki(e,Va)&&Ii(e,Va,o)}}:we},Ja="BODY",Ga=function(e){var t=e.schemaProcessors,r=e.logger,i=function(e,n){return function(){return Promise.resolve().then(e).then((function(){return r.enabled&&r.info("Action "+n.toString()+" executed."),n.toJSON()})).catch((function(e){var t=e.message,o=e.stack,i="Failed to execute action "+n.toString()+". "+t+" "+o;r.logOnContentRendering({status:"rendering-failed",detail:{propositionDetails:n.getProposition().getNotification(),item:n.toJSON()},error:e,message:i,logLevel:"warn"})}))}},c=function(){var e,t=(e=a().mark((function e(n,t){var r,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.allSettled(n.map((function(e){return e()})));case 2:if(r=e.sent,i=r.filter((function(e){return"fulfilled"===e.status})).map((function(e){return e.value})),!t||!M(i)){e.next=6;break}return e.abrupt("return",o(o({},t),{},{items:i}));case 6:return e.abrupt("return",void 0);case 7:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function c(e){n(a,o,i,c,u,"next",e)}function u(e){n(a,o,i,c,u,"throw",e)}c(void 0)}))});return function(e,n){return t.apply(this,arguments)}}(),s=function(e){var n=t[e.getSchema()];return n?n(e):{}},d=function(e){for(var n,t,r,o,a=e.renderers,d=e.returnedPropositions,l=e.returnedDecisions,f=e.items,p=e.proposition,g=u(a),v=u(d),m=u(l),h=[],y=[],w=[],b=!1,E=!1,C=0;f.length>C;){o=f[C];var I=s(o);if(n=I.render,t=I.setRenderAttempted,r=I.includeInNotification,E=I.onlyRenderThis){v=[],m=[],t?(h=[o],y=[]):(h=[],y=[o]),g=[],w=[n],b=r;break}n&&w.push(i(n,o)),r&&(b=!0),t?h.push(o):y.push(o),C+=1}if(w.length>0){var k=b?p.getNotification():void 0;g.push((function(){return c(w,k)}))}else b&&g.push((function(){return Promise.resolve(p.getNotification())}));return h.length>0&&p.addToReturnValues(v,m,h,!0),y.length>0&&p.addToReturnValues(v,m,y,!1),{renderers:g,returnedPropositions:v,returnedDecisions:m,onlyRenderThis:E}};return function(e){for(var n,t,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=[],u=[],s=[],l=0;e.length>l;){i=(t=e[l]).getItems();var f=d({renderers:c,returnedPropositions:u,returnedDecisions:s,items:i,proposition:t});if(c=f.renderers,u=f.returnedPropositions,s=f.returnedDecisions,n=f.onlyRenderThis)break;l+=1}n&&e.forEach((function(e,n){n!==l&&e.addToReturnValues(u,s,e.getItems(),!1)})),a.forEach((function(e){e.addToReturnValues(u,s,e.getItems(),!1)}));return{returnedPropositions:u,returnedDecisions:s,render:function(){return Promise.all(c.map((function(e){return e()}))).then((function(e){var n=e.filter((function(e){return e})),t=n.map((function(e){return{id:e.id,scope:e.scope,scopeDetails:e.scopeDetails}}));if(M(n)){var i=oe(n,(function(e){return e.scope}));r.logOnContentRendering({status:"rendering-succeeded",detail:o({},i),message:"Scopes: "+JSON.stringify(i)+" successfully executed.",logLevel:"info"})}return t}))}}}},Qa=function(e){var n=e.processPropositions,t=e.createProposition,r=e.notificationHandler;return function(e){var o=e.renderDecisions,i=e.propositions,a=e.event,c=e.personalization,u=void 0===c?{}:c;if(!o)return Promise.resolve();var s,d=u.sendDisplayEvent,l=void 0===d||d,f=a?a.getViewName():void 0,p=(s=0,function(e){var n=e.items;return!!(void 0===n?[]:n).some((function(e){return e.schema===ei}))&&(s+=1)>1}),g=i.map((function(e){return t(e,!0,p(e))})),v=n(g),m=v.render,h=v.returnedPropositions,y=r(o,l,f),w=g.reduce((function(e,n){return e[n.getId()]=n,e}),{});return m().then((function(e){var n=e.filter((function(e){return!w[e.id].shouldSuppressDisplay()})),t=e.filter((function(e){return w[e.id].shouldSuppressDisplay()}));y(n,t)})),Promise.resolve({propositions:h})}},Xa="text/html",Ya=["content","contentType"],Wa=["mobileParameters","webParameters","html"],Ka=function(e){var n=e.modules,t=e.logger;return function(e){var r=e.getData(),i=e.getProposition(),a=o({},i.getNotification()),c=i.shouldSuppressDisplay();if(!r)return t.warn("Invalid in-app message data: undefined.",r),{};var u=r.type,s=void 0===u?"defaultContent":u;return n[s]?function(e,n){for(var t=0;t<Ya.length;t+=1){var r=Ya[t];if(!Object.prototype.hasOwnProperty.call(e,r))return n.warn("Invalid in-app message data: missing property '"+r+"'.",e),!1}var o=e.content;if("application/json"===e.contentType)for(var i=0;i<Wa.length;i+=1){var a=Wa[i];if(!Object.prototype.hasOwnProperty.call(o,a))return n.warn("Invalid in-app message data.content: missing property '"+a+"'.",e),!1}return!0}(r,t)?a?{render:function(){return c?null:n[s](o(o({},r),{},{meta:a}))},setRenderAttempted:!0,includeInNotification:!0}:(t.warn("Invalid in-app message meta: undefined.",a),{}):{}:(t.warn("Invalid in-app message data: unknown type.",r),{})}},$a=function(e){var n=F("#"+e,document);n&&n.length>0&&Q(n[0])},Za=function(e){return function(n){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e.location.href=n:e.location.replace(n),new Promise((function(){}))}},ec="alloy-messaging-container",nc="alloy-overlay-container",tc="alloy-content-iframe",rc=function(){return[ec,nc].forEach($a)},oc=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Za(window);return function(t){t.preventDefault(),t.stopImmediatePropagation();var r=t.target,o="a"===r.tagName.toLowerCase()?r:r.closest("a");if(o){var i=function(e){var n={};if(!e||"a"!==e.tagName.toLowerCase())return n;var t=e.href;if(!t||!t.startsWith("adbinapp://"))return n;var r,o,i=t.split("?"),a=i[0].split("://")[1],c=e.innerText,u=e.getAttribute("data-uuid")||"";if(M(i)){var s=Se.parse(i[1]);r=s.interaction||"",o=Jt(s.link||"")}return{action:a,interaction:r,link:o,label:c,uuid:u}}(o),a=i.action,c=i.interaction,u=i.link,s=i.label,d=i.uuid;e(a,{label:s,id:c,uuid:d,link:u}),"dismiss"===a&&rc(),ye(u)&&u.length>0&&n(u,!0)}}},ic=function(e){var n=e.verticalAlign,t=e.width,r=e.horizontalAlign,o=e.backdropColor,i=e.height,a=e.cornerRadius,c=e.horizontalInset,u=e.verticalInset,s=e.uiTakeover,d={width:t?t+"%":"100%",backgroundColor:o||"rgba(0, 0, 0, 0.5)",borderRadius:a?a+"px":"0px",border:"none",position:void 0!==s&&s?"fixed":"relative",overflow:"hidden"};return"left"===r?d.left=c?c+"%":"0":"right"===r?d.right=c?c+"%":"0":"center"===r&&(d.left="50%",d.transform="translateX(-50%)"),"top"===n?d.top=u?u+"%":"0":"bottom"===n?(d.position="fixed",d.bottom=u?u+"%":"0"):"center"===n&&(d.top="50%",d.transform=("center"===r?d.transform+" ":"")+"translateY(-50%)",d.display="flex",d.alignItems="center",d.justifyContent="center"),d.height=i?i+"vh":"100%",d},ac=function(e){return{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"transparent",opacity:e.backdropOpacity||.5,backgroundColor:e.backdropColor||"#FFFFFF"}},cc=["enabled","parentElement","insertionMethod"],uc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;rc();var r=e.content,i=e.contentType,a=e.mobileParameters,c=e.webParameters;if(i===Xa){var u=T("div",{id:ec}),s=function(e,n){var t=(new DOMParser).parseFromString(e,Xa),r=t.querySelector("script");r&&r.setAttribute("nonce",Ni());var o=T("iframe",{src:URL.createObjectURL(new Blob([t.documentElement.outerHTML],{type:"text/html"})),id:tc});return o.addEventListener("load",(function(){(0,(o.contentDocument||o.contentWindow.document).addEventListener)("click",n)})),o}(r,oc(n)),d=T("div",{id:nc});(function(e){if(!e)return!1;var n=Object.keys(e);if(!n.includes(ec))return!1;if(!n.includes(nc))return!1;for(var t=Object.values(e),r=0;r<t.length;r+=1){if(!Sn(t[r],"style"))return!1;if(!Sn(t[r],"params"))return!1;for(var o=0;o<cc.length;o+=1)if(!Sn(t[r].params,cc[o]))return!1}return!0})(c)||(c=function(e){if(e){var n=e.uiTakeover,r=void 0!==n&&n;return t(t(t({},tc,{style:{border:"none",width:"100%",height:"100%"},params:{enabled:!0,parentElement:"#alloy-messaging-container",insertionMethod:"appendChild"}}),ec,{style:ic(e),params:{enabled:!0,parentElement:"body",insertionMethod:"appendChild"}}),nc,{style:ac(e),params:{enabled:!0===r,parentElement:"body",insertionMethod:"appendChild"}})}}(a)),c&&function(e,n,t,r){[{id:nc,element:r},{id:ec,element:t},{id:tc,element:e}].forEach((function(e){var t=e.id,r=e.element,i=n[t],a=i.style,c=void 0===a?{}:a,u=i.params,s=void 0===u?{}:u;r.style=o(o({},r.style),c);var d=s.parentElement,l=void 0===d?"body":d,f=s.insertionMethod,p=void 0===f?"appendChild":f,g=s.enabled,v=void 0===g||g,m=document.querySelector(l);v&&m&&"function"==typeof m[p]&&m[p](r)}))}(s,c,u,d)}},sc=function(e){return{defaultContent:function(n){return function(e,n){return new Promise((function(t){var r=e.meta;uc(e,(function(e,t){var o={};o[ui.INTERACT]=1,-1!==Object.values(ui).indexOf(e)&&(o[e]=1),n({decisionsMeta:[r],propositionAction:t,eventType:oi,propositionEventTypes:Object.keys(o)})})),t({meta:r})}))}(n,e)}}},dc=function(e){var n=e.find((function(e){return e.scopeType===ba}));return n?n.scope:void 0},lc=function(e,n,t){var r=function(e){for(var n,t,r=document.documentElement,o=e,i=new Set;o&&o!==r&&!(o instanceof ShadowRoot);){var a=ki(o,Fa);a&&i.add(a),n=n||ki(o,Va),t=t||ki(o,"data-aep-click-token"),o=o.parentNode}return{interactIds:u(i),clickLabel:n,clickToken:t}}(e),o=r.interactIds,i=r.clickLabel,a=void 0===i?"":i,c=r.clickToken,s=function(e,n,t){return function(r){var o=r.scopeDetails,i=(void 0===o?{}:o).decisionProvider;return e[i]===ja||e[i]===Ba&&(n||t)}}(t,a,c);if(0===o.length)return{};var d=n(o).filter(s);return{decisionsMeta:Ca(d),propositionActionLabel:a,propositionActionToken:c,viewName:dc(d)}},fc="AJO",pc=function(e){var n,r,i,a,c=e.config,s=e.logger,d=e.eventManager,l=e.consent,f=c.targetMigrationEnabled,p=c.prehidingStyle,g=c.autoCollectPropositionInteractions,v=ya({eventManager:d,mergeDecisionsMeta:Pa}),m=function(e){return function(){var n=Ci(Xi);n&&(e.logOnContentHiding({status:"show-containers",message:"Prehiding style removed to show containers.",logLevel:"info"}),Q(n))}}(s),h=function(e){return function(n){if(n&&!Ci(Xi)){var t=Ni(),r=o({id:Xi},t&&{nonce:t}),i=T(R,r,{textContent:n});e.logOnContentHiding({status:"hide-containers",message:"Prehiding style applied to hide containers.",logLevel:"info"}),P(document.head,i)}}}(s),y=(n={},r={},{storeInteractionMeta:function(e,t,i,a,c){c=parseInt(c,10),n[c]||(n[c]={},r[c]={}),r[c][e]||(r[c][e]=new Set),r[c][e].add(t),n[c][e]=o(o({},a),{},{scopeType:i})},getInteractionMetas:function(e){return Array.isArray(e)&&0!==e.length?Object.values(e.map((function(e){return parseInt(e,10)})).reduce((function(e,t){return Object.keys(n[t]||{}).forEach((function(o){e[o]||(e[o]={proposition:n[t][o],items:new Set}),e[o].items=new Set([].concat(u(e[o].items),u(r[t][o])))})),e}),{})).map((function(e){var n=e.proposition,t=e.items;return o(o({},n),{},{items:Array.from(t).map((function(e){return{id:e}}))})})):[]}}),w=y.storeInteractionMeta,b=y.getInteractionMetas,E=Oa(),C=E.storeClickMeta,I=E.getClickSelectors,k=E.getClickMetas,D=function(e){var n=e.window;return function(){return n.location}}({window:window}),O=function(){var e;return t(t(t(t(t(t(t(t(t(t(e={},"setHtml",ca(Gi)),ga,ca(Qi)),"setText",ca($i)),"setAttribute",ca(oa)),"setImageSource",ca(ia)),"setStyle",ca(ra)),"move",ca(da)),"resize",ca(pa)),"rearrange",ca(aa)),"remove",ca(Q)),t(t(t(t(t(t(e,"insertAfter",ca(na)),"insertBefore",ca(Zi)),"replaceHtml",ca(ea)),"prependHtml",ca(Qi)),va,ca(Ji)),ha,ca(la))}(),N=(i=[Ma,xa],function(e){return e?i.reduce((function(e,n){return o(o({},e),n(e))}),e):e}),A=qa({preprocess:N,isPageWideSurface:Qo}),x=function(e){var n=e.createProposition,t=!1,r=Promise.resolve({}),i=function(e,t){var r=e[t.toLowerCase()];return r&&r.length>0?r:[n({scope:t,scopeDetails:{characteristics:{scopeType:ba}},items:[{schema:Xo}]},!1)]};return{createCacheUpdate:function(e){var n=S();return t=!0,r=r.then((function(e){return n.promise.then((function(n){return o(o({},e),n)})).catch((function(){return e}))})),{update:function(t){var r=t.filter((function(e){return e.getScope()})),o=oe(r,(function(e){return e.getScope().toLowerCase()}));return n.resolve(o),e?i(o,e):[]},cancel:function(){n.reject()}}},getView:function(e){return r.then((function(n){return i(n,e)}))},isInitialized:function(){return t}}}({createProposition:A}),q=Za(window),L=t(t(t(t(t({},Xo,La),Yo,function(e){var n=e.modules,t=e.logger,r=e.storeInteractionMeta,i=e.storeClickMeta,a=e.autoCollectPropositionInteractions;return function(e){var c=e.getData()||{},u=c.type,s=c.selector;if(!u)return t.warn("Invalid DOM action data: missing type.",e.getData()),{setRenderAttempted:!1,includeInNotification:!1};if(u===ma)return s?(i({selector:s,meta:o(o({},e.getProposition().getNotification()),{},{trackingLabel:e.getTrackingLabel(),scopeType:e.getProposition().getScopeType()})}),{setRenderAttempted:!0,includeInNotification:!1}):(t.warn("Invalid DOM action data: missing selector.",e.getData()),{setRenderAttempted:!1,includeInNotification:!1});if(!n[u])return t.warn("Invalid DOM action data: unknown type.",e.getData()),{setRenderAttempted:!1,includeInNotification:!1};var d=Ha(a,u,e.getProposition().getId(),e.getId(),e.getTrackingLabel(),e.getProposition().getScopeType(),e.getProposition().getNotification(),r);return{render:function(){return n[u](e.getData(),d)},setRenderAttempted:!0,includeInNotification:!0}}}({modules:O,logger:s,storeInteractionMeta:w,storeClickMeta:C,autoCollectPropositionInteractions:g})),Wo,function(e){var n=e.modules,t=e.logger,r=e.storeInteractionMeta,o=e.autoCollectPropositionInteractions;return function(e){var i=e.getData()||{},a=i.type;if(!i.selector||!a)return{setRenderAttempted:!1,includeInNotification:!1};if(!n[a])return t.warn("Invalid HTML content data",e.getData()),{setRenderAttempted:!1,includeInNotification:!1};var c=Ha(o,a,e.getProposition().getId(),e.getId(),e.getTrackingLabel(),e.getProposition().getScopeType(),e.getProposition().getNotification(),r);return{render:function(){return n[a](e.getData(),c)},setRenderAttempted:!0,includeInNotification:!0}}}({modules:O,logger:s,storeInteractionMeta:w,autoCollectPropositionInteractions:g})),Zo,function(e){var n=e.logger,t=e.executeRedirect,r=e.collect;return function(e){var o=(e.getData()||{}).content;return o?{render:function(){return Wi(Ja),r({decisionsMeta:[e.getProposition().getNotification()],documentMayUnload:!0}).then((function(){return n.logOnContentRendering({status:"rendering-redirect",detail:{propositionDetails:e.getProposition().getNotification(),redirect:o},message:"Redirect action "+e.toString()+" executed.",logLevel:"info"}),t(o)})).catch((function(e){throw Ki(Ja),e}))},setRenderAttempted:!0,onlyRenderThis:!0}:(n.warn("Invalid Redirect data",e.getData()),{})}}({logger:s,executeRedirect:q,collect:v})),ei,Ka({modules:sc(v),logger:s})),j=Ga({schemaProcessors:L,logger:s}),U=(a=Promise.resolve([]),{concat:function(e){a=a.then((function(n){return e.then((function(e){return n.concat(e)})).catch((function(){return n}))}))},clear:function(){var e=a;return a=Promise.resolve([]),e}}),B=function(e,n){return function(t,r,o){if(!t)return function(){};if(!r){var i=S();return n.concat(i.promise),i.resolve}return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];M(n)&&e({decisionsMeta:n,viewName:o}),M(t)&&e({decisionsMeta:t,eventType:ci,propositionAction:{reason:"Conflict"},viewName:o})}}}(v,U),_=function(e){var n=e.logger,t=e.prehidingStyle,r=e.showContainers,o=e.hideContainers,i=e.mergeQuery,a=e.processPropositions,c=e.createProposition,s=e.notificationHandler,d=e.consent;return function(e){var l=e.cacheUpdate,f=e.personalizationDetails,p=e.event,g=e.onResponse,v=d.current(),m=v.state,h=v.wasSet;"out"===m&&h||(f.isRenderDecisions()?o(t):r()),i(p,f.createQueryDetails());var y=s(f.isRenderDecisions(),f.isSendDisplayEvent(),f.getViewName());g((function(e){var t=e.response.getPayloadsByType("personalization:decisions");M(t)||n.logOnContentRendering({status:"no-offers",message:"No offers were returned.",logLevel:"info",detail:{query:f.createQueryDetails()}});var o,i,s,d=t.map((function(e){return c(e)})),p=oe(d,(function(e){return e.getScopeType()})),g=p.page,v=void 0===g?[]:g,m=p.view,h=void 0===m?[]:m,w=p.proposition,b=void 0===w?[]:w,E=l.update(h);if(f.isRenderDecisions()){var C=a([].concat(u(v),u(E)),b);o=C.render,i=C.returnedPropositions,s=C.returnedDecisions,M(v)&&n.logOnContentRendering({status:"rendering-started",message:"Started rendering propositions for page-wide scope.",logLevel:"info",detail:{scope:tt,propositions:v.map((function(e){return e.toJSON()}))}}),M(E)&&n.logOnContentRendering({status:"rendering-started",message:"Rendering propositions started for view scope - "+f.getViewName()+".",logLevel:"info",detail:{scope:f.getViewName(),propositions:E.map((function(e){return e.toJSON()}))}}),o().then(y),r()}else{var I=a([],[].concat(u(v),u(E),u(b)));i=I.returnedPropositions,s=I.returnedDecisions}return{propositions:i,decisions:s}}))}}({prehidingStyle:p,showContainers:m,hideContainers:h,mergeQuery:Ta,processPropositions:j,createProposition:A,notificationHandler:B,consent:l,logger:s}),F=function(e){var n=e.mergeDecisionsMeta,t=e.collectInteractions,r=e.collectClicks,o=e.getInteractionMetas,i=e.getClickMetas,a=e.getClickSelectors,c=e.autoCollectPropositionInteractions;return function(e){var u,s,d,l=e.event,f=e.clickedElement,p=[];if([t(f,o,c),r(f,a(),i)].forEach((function(e){var n=e.decisionsMeta,t=e.propositionActionLabel,r=e.propositionActionToken,o=e.viewName;Array.prototype.push.apply(p,n),!u&&t&&(u=t),!s&&r&&(s=r),!d&&o&&(d=o)})),M(p)){var g={eventType:oi};d&&(g.web={webPageDetails:{viewName:d}}),l.mergeXdm(g),n(l,p,[ui.INTERACT],function(e,n){if(n||e){var t={};return e&&(t.label=e),n&&(t.tokens=[n]),t}}(u,s))}}}({mergeDecisionsMeta:Pa,collectInteractions:lc,collectClicks:Sa,getInteractionMetas:b,getClickMetas:k,getClickSelectors:I,autoCollectPropositionInteractions:g}),V=function(e){var n=e.processPropositions,t=e.viewCache,r=e.logger;return function(e){var o,i,a=e.personalizationDetails,c=e.onResponse,u=a.getViewName();return c((function(){return{propositions:o,decisions:i}})),t.getView(u).then((function(e){var t;if(a.isRenderDecisions()){var c=n(e);return t=c.render,o=c.returnedPropositions,i=c.returnedDecisions,r.logOnContentRendering({status:"rendering-started",message:"Started rendering propositions for view scope - "+u+".",logLevel:"info",detail:{scope:u,propositions:e.map((function(e){return e.toJSON()}))}}),t()}var s=n([],e);return o=s.returnedPropositions,i=s.returnedDecisions,[]}))}}({processPropositions:j,viewCache:x,logger:s}),z=Aa({processPropositions:j,createProposition:A,renderedPropositions:U,viewCache:x}),H=function(e){return e.targetMigrationEnabled?function(e){e.getPayload().mergeMeta({target:{migration:!0}})}:we}({targetMigrationEnabled:f}),J=Qa({processPropositions:j,createProposition:A,notificationHandler:B}),G=function(e){var n=e.showContainers,t=e.consent;return function(){var e=t.current(),r=e.state,o=e.wasSet;r===jn&&o?n():t.awaitConsent().catch(n)}}({showContainers:m,consent:l});return gi({getPageLocation:D,logger:s,fetchDataHandler:_,viewChangeHandler:V,onClickHandler:F,isAuthoringModeEnabled:Da,mergeQuery:Ta,viewCache:x,showContainers:m,applyPropositions:z,setTargetMigration:H,mergeDecisionsMeta:Pa,renderedPropositions:U,onDecisionHandler:J,handleConsentFlicker:G})};pc.namespace="Personalization";var gc=_a.map((function(e){return Cn(e)}));pc.configValidators=Sn({prehidingStyle:Dn().nonEmpty(),targetMigrationEnabled:bn().default(!1),autoCollectPropositionInteractions:Sn(t(t({},fc,hn(gc).default(ja)),"TGT",hn(gc).default(Ua))).default(t(t({},fc,ja),"TGT",Ua)).noUnknownFields()});var vc,mc=function(e){return null!==e&&"object"===d(e)&&Object.getPrototypeOf(e)===Object.prototype},hc=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Object.keys(e).forEach((function(r){mc(e[r])||Array.isArray(e[r])?hc(e[r],n,[].concat(u(t),[r])):n[[].concat(u(t),[r]).join(".")]=e[r]})),n},yc=function(e){return mc(e)?hc(e):e},wc="matcher",bc="group",Ec="historical",Cc="eq",Ic="ne",kc="ex",Sc="nx",Dc="gt",Pc="ge",Tc="lt",Oc="le",Rc="co",Nc="nc",Ac="sw",xc="ew",Mc="and",qc="or",Lc="ordered";function jc(e){return"object"===d(e)||void 0===e}function Uc(e){return"number"==typeof e}var Bc=(t(t(t(t(t(t(t(t(t(t(vc={},Cc,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(jc(e[n]))return!1;for(var r=String(e[n]).toLowerCase(),o=0;o<t.length;o+=1)if(!jc(t[o])&&r===String(t[o]).toLowerCase())return!0;return!1}}),Ic,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(jc(e[n]))return!1;for(var r=String(e[n]).toLowerCase(),o=0;o<t.length;o+=1)if(!jc(t[o])&&r===String(t[o]).toLowerCase())return!1;return!0}}),kc,{matches:function(e,n){return void 0!==e[n]&&null!==e[n]}}),Sc,{matches:function(e,n){return void 0===e[n]||null===e[n]}}),Dc,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=e[n];if(!Uc(r))return!1;for(var o=0;o<t.length;o+=1)if(Uc(t[o])&&r>t[o])return!0;return!1}}),Pc,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=e[n];if(!Uc(r))return!1;for(var o=0;o<t.length;o+=1)if(Uc(t[o])&&r>=t[o])return!0;return!1}}),Tc,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=e[n];if(!Uc(r))return!1;for(var o=0;o<t.length;o+=1)if(Uc(t[o])&&r<t[o])return!0;return!1}}),Oc,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=e[n];if(!Uc(r))return!1;for(var o=0;o<t.length;o+=1)if(Uc(t[o])&&r<=t[o])return!0;return!1}}),Rc,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(jc(e[n]))return!1;for(var r=String(e[n]).toLowerCase(),o=0;o<t.length;o+=1)if(!jc(t[o])&&-1!==r.indexOf(String(t[o]).toLowerCase()))return!0;return!1}}),Nc,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(jc(e[n]))return!1;for(var r=String(e[n]).toLowerCase(),o=0;o<t.length;o+=1)if(!jc(t[o])&&-1!==r.indexOf(String(t[o]).toLowerCase()))return!1;return!0}}),t(t(vc,Ac,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(jc(e[n]))return!1;for(var r=String(e[n]).toLowerCase(),o=0;o<t.length;o+=1)if(!jc(t[o])&&r.startsWith(String(t[o]).toLowerCase()))return!0;return!1}}),xc,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(jc(e[n]))return!1;for(var r=String(e[n]).toLowerCase(),o=0;o<t.length;o+=1)if(!jc(t[o])&&r.endsWith(t[o].toLowerCase()))return!0;return!1}}));function _c(e){return void 0===e}function Fc(e){return Object.keys(e)}var Vc=["iam.eventType","eventType","type"],zc=["iam.id","id"];function Hc(e,n){for(var t=0;t<n.length;t+=1)if(!_c(e[n[t]]))return e[n[t]]}function Jc(e,n){for(var t=Fc(e),r=0;r<t.length;r+=1){var o=t[r],i=n.event;if((void 0===i?{}:i)[t[r]]!==e[o])return!1}return!0}function Gc(e,n){return{evaluate:function(e){return n.evaluate(e)},toString:function(){return"Condition{type="+e+", definition="+n+"}"}}}function Qc(e,n,t){return{evaluate:function(r){var o=function(e){return Bc[e]}(n);return!!o&&o.matches(r,e,t)}}}function Xc(e,n,t,r,o,i){return{evaluate:function(a){var c;return c=Lc===i?function(e,n,t,r){var o=t;return e.every((function(e){var t=Hc(e,Vc);if(!t)return!1;var i=n.events[t];if(!i)return!1;var a=Hc(e,zc);if(!a)return!1;var c=i[a];if(!Jc(e,c))return!1;if(null===c||_c(c)||0===c.count)return!1;var u=(_c(o)||c.timestamp>=o)&&(_c(r)||c.timestamp<=r);return o=c.timestamp,u}))?1:0}(e,a,r,o):function(e,n,t,r){return e.reduce((function(e,o){var i=Hc(o,Vc);if(!i)return e;var a=n.events[i];if(!a)return e;var c=Hc(o,zc);if(!c)return e;var u=a[c];if(!u)return e;if(!Jc(o,u))return e;var s=u.count,d=void 0===s?1:s;return _c(t)||_c(r)||u.timestamp>=t&&u.timestamp<=r?e+d:e}),0)}(e,a,r,o),function(e,n,t){switch(n){case Dc:return e>t;case Pc:return e>=t;case Tc:return e<t;case Oc:return e<=t;case Cc:return e===t;case Ic:return e!==t;default:return!1}}(c,n,t)}}}function Yc(e){return function(e,n){return{evaluate:function(t){return Mc===e?function(e,n){for(var t=!0,r=0;r<n.length;r+=1)t=t&&n[r].evaluate(e);return t}(t,n):qc===e&&function(e,n){for(var t=!1,r=0;r<n.length;r+=1)if(t=t||n[r].evaluate(e))return!0;return!1}(t,n)}}}(e.logic,e.conditions.map(Wc))}function Wc(e){var n=e.type,t=e.definition;if(wc===n){var r=function(e){return Qc(e.key,e.matcher,e.values)}(t);return Gc(n,r)}if(bc===n)return Gc(n,Yc(t));if(Ec===n){var o=function(e){var n=e.events,t=e.from,r=e.to;return Xc(n,e.matcher,e.value,t,r,e.searchType)}(t);return Gc(n,o)}throw new Error("Can not parse condition")}function Kc(e){return function(e,n,t){return{id:e,type:n,detail:t}}(e.id,e.type,e.detail)}function $c(e){var n=e.condition,t=e.consequences,r=e.key;return function(e,n,t){return{key:t,execute:function(t){return e.evaluate(t)?n:[]},toString:function(){return"Rule{condition="+e+", consequences="+n+"}"}}}(Wc(n),t.map(Kc),r)}function Zc(e){return{provider:"DEFAULT",execute:function(n){return e.map((function(e){return e.execute(n)})).filter((function(e){return e.length>0}))}}}function eu(e,n,t){return t.providerData.identityTemplate.replace("<key>",n).replace("<identity>",e)}function nu(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e[0]},t={};return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];var a=n(o);return _c(t[a])&&(t[a]=e.apply(void 0,o)),t[a]}}function tu(e,n){var t=65535&n;return((n-t)*e|0)+(t*e|0)|0}var ru=nu((function(e){for(var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e.length,o=3432918353,i=461845907,a=t,c=-2&r,u=0;u<c;u+=2)n=tu(n=e.charCodeAt(u)|e.charCodeAt(u+1)<<16,o),a=5*(a=(524287&(a^=n=tu(n=(131071&n)<<15|n>>>17,i)))<<13|a>>>19)+3864292196|0;return r%2==1&&(n=tu(n=e.charCodeAt(c),o),a^=n=tu(n=(131071&n)<<15|n>>>17,i)),a^=r<<1,a=tu(a^=a>>>16,2246822507),a=tu(a^=a>>>13,3266489909),a^=a>>>16}),(function(e){return e.join("-")}));var ou=nu((function(e,n){var t=ru(e),r=Math.abs(t)%n/n*100;return Math.round(100*r)/100}));function iu(e,n,t){return o({allocation:ou(e,n)},t)}function au(e,n){return n.map((function(n){return n.execute(e)})).filter((function(e){return e.length>0}))}function cu(e,n){!function(e){var n=e.providerData;if(!n)throw new Error("Provider data is missing in metadata");var t=n.identityTemplate,r=n.buckets;if(!t)throw new Error("Identity template is missing in provider data");if(!r)throw new Error("Buckets is missing in provider data")}(n);var t=e.filter((function(e){return!e.key})),r=function(e){for(var n={},t=0;t<e.length;t+=1){var r=e[t];r.key&&(n[r.key]||(n[r.key]=[]),n[r.key].push(r))}return n}(e),o=n.providerData.buckets;return{provider:"TGT",execute:function(e){for(var i=function(e){var n=e.xdm;if(!n)throw new Error("XDM object is missing in the context");var t=n.identityMap;if(!t)throw new Error("Identity map is missing in the XDM object");var r=t.ECID;if(!r)throw new Error("ECID identity namespace is missing in the identity map");if(!Array.isArray(r)||0===r.length)throw new Error("ECID identities array is empty or not an array");var o=r[0].id;if(!o)throw new Error("ECID identity is missing in the identities array");return o}(e),a=au(e,t),c=Fc(r),s=[],d=0;d<c.length;d+=1){var l=c[d],f=r[l],p=au(iu(eu(i,l,n),o,e),f);s.push.apply(s,u(p))}return[].concat(u(a),s)}}}function uu(e){var n=function(e){var n=e.version,t=e.rules,r=e.metadata,o=t.map($c),i=function(e){var n,t;if(e)return{provider:e.provider,providerData:(n={},t=e.providerData,Object.assign(n,t))}}(r);return function(e,n,t){return{version:e,rules:n,metadata:t}}(n,o,i)}(e);return function(e,n){return n&&"TGT"===n.provider?cu(e,n):Zc(e)}(n.rules,n.metadata)}var su=function(e){return"iam."+e},du="events",lu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return function(t){var r={};return Object.keys(t).forEach((function(o){r[o]={},Object.values(t[o]).filter((function(e){return new Date(e.firstTimestamp)>=function(e){var n=new Date;return n.setDate(n.getDate()-e),n}(n)})).sort((function(e,n){return e.firstTimestamp-n.firstTimestamp})).slice(-1*e).forEach((function(e){r[o][e.event[su("id")]]=e}))})),r}},fu=function(e){var n;return null==e||null===(n=e.scopeDetails)||void 0===n||null===(n=n.activity)||void 0===n?void 0:n.id},pu=function(e){e.clear()},gu=t(t({},"cjmiam",(function(e,n,t){var r=t.html,o=t.mobileParameters;return{schema:ei,data:{mobileParameters:o,webParameters:{},content:r,contentType:Xa},id:e}})),"schema",(function(e,n,t){return{schema:t.schema,data:t.data,id:t.id||e}})),vu=function(e){var n=e.schema,t=e.data;if(n===$o)return!0;if(n!==Ko)return!1;try{var r="string"==typeof t.content?JSON.parse(t.content):t.content;return r&&Object.prototype.hasOwnProperty.call(r,"version")&&Object.prototype.hasOwnProperty.call(r,"rules")}catch(e){return!1}},mu=function(e,n){var t,r=function(e){var n=e.id,t=e.type,r=e.detail;return"function"==typeof gu[t]?gu[t](n,t,r):r},i=fu(e),a=[];return Array.isArray(e.items)&&e.items.filter(vu).forEach((function(e){var n=e.data,t=void 0===n?{}:n,r=e.schema===$o?t:t.content;r&&a.push(uu("string"==typeof r?JSON.parse(r):r))})),{rank:(null==e||null===(t=e.scopeDetails)||void 0===t?void 0:t.rank)||1/0,evaluate:function(t){var c=n.getEvent(ri,i),u=null==c?void 0:c.firstTimestamp,s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.flat(1/0):e}(a.map((function(e){return e.execute(t)}))).map(r).map((function(e){var t=(n.addEvent({eventType:ui.TRIGGER,eventId:i})||{}).firstTimestamp;return o(o({},e),{},{data:o(o({},e.data),{},{qualifiedDate:t,displayedDate:u})})}));return o(o({},e),{},{items:s})},isEvaluable:a.length>0}},hu=function(e){var n,r,o,i=e.storage,a=i,c=function(e){n=function(e,n){return function(t){var r=e.getItem(n);if(!r)return t;try{return JSON.parse(r)}catch(e){return t}}}(a=e,du),r=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e};return function(r){e.setItem(n,JSON.stringify(t(r)))}}(a,du,lu()),o=n({})};c(i);var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.eventType,i=e.eventId,a=e.action;if(n&&i){o[n]||(o[n]={});var c=o[n][i],u=c?c.count:0,s=(new Date).getTime(),d=c?c.firstTimestamp||c.timestamp:s;return o[n][i]={event:t(t(t({},su("id"),i),su("eventType"),n),su("action"),a),firstTimestamp:d,timestamp:s,count:u+1},r(o),o[n][i]}};return{addExperienceEdgeEvent:function(e){var n=e.getContent().xdm;if(function(e){var n=(e||{})._experience;return!!n&&"object"===d(n)}(n)){var t=n._experience.decisioning,r=void 0===t?{}:t,o=r.propositionEventType,i=void 0===o?{}:o,a=r.propositionAction,c=(void 0===a?{}:a).id,s=r.propositions,l=void 0===s?[]:s;Object.keys(i).filter((function(e){return 1===i[e]})).forEach((function(e){l.forEach((function(n){(function(e){var n;return null==e||null===(n=e.scopeDetails)||void 0===n?void 0:n.decisionProvider})(n)===fc&&u({eventType:e,eventId:fu(n),action:c})}))}))}},addEvent:u,getEvent:function(e,n){if(o[e])return o[e][n]},toJSON:function(){return o},setStorage:c}},yu=function(e){var n=e.eventRegistry,t=e.window,r=e.getBrowser,i=(new Date).getTime(),a={browser:{name:r()},page:o({title:t.title,url:t.url},Ee(t.url)),referringPage:o({url:t.referrer},Ee(t.referrer))},c=function(){return o(o(o({},a),(e=new Date,n=e.getTime(),{pageLoadTimestamp:i,currentTimestamp:n,currentDate:e.getDate(),"~state.com.adobe.module.lifecycle/lifecyclecontextdata.dayofweek":e.getDay()+1,"~state.com.adobe.module.lifecycle/lifecyclecontextdata.hourofday":e.getHours(),currentMinute:e.getMinutes(),currentMonth:e.getMonth(),currentYear:e.getFullYear(),pageVisitDuration:n-i,"~timestampu":n/1e3,"~timestampz":e.toISOString()})),{},{window:{height:t.height,width:t.width,scrollY:t.scrollY,scrollX:t.scrollX},"~sdkver":It});var e,n};return{getContext:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=o(o({},c()),e);return o(o({},yc(t)),{},{events:n.toJSON()})}}},wu=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return t},bu=function(e){return!0},Eu=function(e){var n=e.collect,t=function(){},r=new Set,i=function(e,n,t){var o=[e,n].join("-"),i=!t.has(o)&&(function(e){return[ui.INTERACT,ui.DISMISS].includes(e)}(e)||!r.has(o));return t.add(o),r.add(o),i},a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!(t instanceof Array))return Promise.resolve();if(!Object.values(ui).includes(e))return Promise.resolve();var r=[],o=new Set;return t.forEach((function(n){var t=function(e){return{id:e.id,scope:e.scope,scopeDetails:e.scopeDetails}}(n);i(e,t.id,o)&&r.push(t)})),r.length>0?n({decisionsMeta:r,eventType:fi(e),documentMayUnload:!0}):Promise.resolve()},c=function(){var e=wu,n=bu,t=0,r={};return{add:function(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return"function"!=typeof e?function(){}:(r[t+=1]={callback:e,params:o},{id:t,unsubscribe:(n=t,function(){delete r[n]})})},emit:function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];Object.values(r).forEach((function(t){var r=t.callback,i=t.params,a=e.apply(void 0,[i].concat(o));n.apply(void 0,[i].concat(u(a)))&&r.apply(void 0,u(a))}))},emitOne:function(t){if(t&&r[t]){for(var o=r[t],i=o.callback,a=o.params,c=arguments.length,s=new Array(c>1?c-1:0),d=1;d<c;d++)s[d-1]=arguments[d];var l=e.apply(void 0,[a].concat(s));n.apply(void 0,[a].concat(u(l)))&&i.apply(void 0,u(l))}},hasSubscriptions:function(){return Object.keys(r).length>0},setEmissionPreprocessor:function(n){"function"==typeof n&&(e=n)},setEmissionCondition:function(e){"function"==typeof e&&(n=e)}}}();c.setEmissionPreprocessor((function(e,n){var t=e.surfacesFilter,r=e.schemasFilter;return[{propositions:n.filter((function(e){return!t||t.includes(e.scope)})).map((function(e){var n=e.items,t=void 0===n?[]:n;return o(o({},e),{},{items:t.filter((function(e){return!r||r.includes(e.schema)}))})})).filter((function(e){return e.items.length>0}))},a]}));return{refresh:function(e){(t=function(n){n?c.emitOne(n,e):c.emit(e)})()},command:{optionsValidator:function(e){return function(e){var n=e.options;return Sn({surfaces:wn(Dn()).uniqueItems(),schemas:wn(Dn()).uniqueItems(),callback:En().required()}).noUnknownFields()(n)}({options:e})},run:function(e){var n=e.surfaces,r=e.schemas,o=e.callback,i=c.add(o,{surfacesFilter:n instanceof Array?n:void 0,schemasFilter:r instanceof Array?r:void 0}),a=i.id,u=i.unsubscribe;return t(a),Promise.resolve({unsubscribe:u})}}}},Cu="~type",Iu="~source",ku="com.adobe.eventType.edge",Su="com.adobe.eventType.rulesEngine",Du="com.adobe.eventSource.requestContent",Pu=function(e){var n=e.contextProvider,t=e.decisionProvider;return{optionsValidator:function(e){return function(e){var n=e.options;return Sn({renderDecisions:bn(),personalization:Sn({decisionContext:Sn({})})}).noUnknownFields()(n)}({options:e})},run:function(e){var r=e.renderDecisions,o=e.decisionContext;return(0,e.applyResponse)({renderDecisions:r,propositions:t.evaluate(n.getContext(o))})}}},Tu=function(e){var n=e.config,r=e.eventManager,i=e.createNamespacedStorage,a=e.consent,c=e.getBrowser,u=n.orgId,s=n.personalizationStorageEnabled,d=ya({eventManager:r,mergeDecisionsMeta:Pa}),l=i(te(u)+".decisioning.");s||pu(l.persistent);var f,p,g=hu({storage:(f={},{getItem:function(e){return e in f?f[e]:null},setItem:function(e,n){f[e]=n}})}),v=function(e){var n=e.eventRegistry,t={},r=function(e){var r=fu(e);if(r){var o=mu(e,n);o.isEvaluable&&(t[r]=o)}};return{addPayload:r,addPayloads:function(e){e.forEach(r)},evaluate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.values(t).sort((function(e,n){return e.rank-n.rank})).map((function(n){return n.evaluate(e)})).filter((function(e){return e.items.length>0}))}}}({eventRegistry:g}),m=yu({eventRegistry:g,window:window,getBrowser:c}),h=Pu({contextProvider:m,decisionProvider:v}),y=Eu({collect:d});return{lifecycle:{onDecision:function(e){var n=e.propositions;y.refresh(n)},onComponentsRegistered:function(e){var n;n=e.lifecycle,p=function(e){var t=e.renderDecisions,r=void 0!==t&&t,o=e.propositions,i=void 0===o?[]:o,a=e.event,c=e.personalization;return n&&n.onDecision({renderDecisions:r,propositions:i,event:a,personalization:c}),{propositions:i}},s&&a.awaitConsent().then((function(){g.setStorage(l.persistent)})).catch((function(){l&&pu(l.persistent)}))},onBeforeEvent:function(e){var n=e.event,r=e.renderDecisions,i=e.personalization,a=void 0===i?{}:i,c=e.onResponse,u=void 0===c?we:c,s=a.decisionContext,d=void 0===s?{}:s;u(function(e){var n=e.renderDecisions,t=e.decisionProvider,r=e.applyResponse,i=e.event,a=e.personalization,c=e.decisionContext,u=o(o({},yc(i.getContent())),c);return function(e){var o=e.response;if(t.addPayloads(o.getPayloadsByType("personalization:decisions")),!i.hasQuery())return{propositions:[]};var c=t.evaluate(u);return r({renderDecisions:n,propositions:c,event:i,personalization:a})}}({renderDecisions:r,decisionProvider:v,applyResponse:p,event:n,personalization:a,decisionContext:m.getContext(o(t(t({},Cu,ku),Iu,Du),d))}))},onBeforeRequest:function(e){var n=e.request.getPayload().toJSON().events,t=void 0===n?[]:n;0!==t.length&&t.forEach((function(e){return g.addExperienceEdgeEvent(e)}))}},commands:{evaluateRulesets:{run:function(e){var n=e.renderDecisions,r=e.personalization,i=(void 0===r?{}:r).decisionContext,a=void 0===i?{}:i;return h.run({renderDecisions:n,decisionContext:o(t(t({},Cu,Su),Iu,Du),a),applyResponse:p})},optionsValidator:h.optionsValidator},subscribeRulesetItems:y.command}}};Tu.namespace="RulesEngine",Tu.configValidators=Sn({personalizationStorageEnabled:bn().default(!1)});var Ou=Sn({streamingMedia:Sn({channel:Dn().nonEmpty().required(),playerName:Dn().nonEmpty().required(),appVersion:Dn(),mainPingInterval:In().minimum(10).maximum(50).default(10),adPingInterval:In().minimum(1).maximum(10).default(10)}).noUnknownFields()}),Ru=function(e){var n=e.config,t=e.trackMediaEvent,r=e.trackMediaSession,o=e.mediaResponseHandler;return{lifecycle:{onBeforeEvent:function(e){var n=e.mediaOptions,t=e.onResponse,r=void 0===t?we:t;if(n){var i=n.legacy,a=n.playerId,c=n.getPlayerDetails;i||r((function(e){var n=e.response;return o({playerId:a,getPlayerDetails:c,response:n})}))}}},commands:{createMediaSession:{optionsValidator:function(e){return function(e){var n=e.options;return hn([Sn({playerId:Dn().required(),getPlayerDetails:En().required(),xdm:Sn({mediaCollection:Sn({sessionDetails:Sn(yn()).required()})}),edgeConfigOverrides:Sn({})}).required(),Sn({xdm:Sn({mediaCollection:Sn({playhead:In().required(),sessionDetails:Sn(yn()).required()})}),edgeConfigOverrides:Sn({})}).required()],"Error validating the createMediaSession command options.")(n)}({options:e})},run:r},sendMediaEvent:{optionsValidator:function(e){return function(e){var n=e.options;return hn([Sn({playerId:Dn().required(),xdm:Sn({eventType:Pn.apply(void 0,u(Object.values(io))).required(),mediaCollection:Sn(yn())}).required()}).required(),Sn({xdm:Sn({eventType:Pn.apply(void 0,u(Object.values(io))).required(),mediaCollection:Sn({playhead:In().integer().required(),sessionID:Dn().required()}).required()}).required()}).required()],"Error validating the sendMediaEvent command options.")(n)}({options:e})},run:function(e){return n.streamingMedia?t(e):Promise.reject(new Error("Streaming media is not configured."))}}}}},Nu=function(e){var n=e.config;e.logger;var t=e.eventManager,r=e.sendEdgeNetworkRequest,o=e.consent,i=so(),a=ao({config:n,eventManager:t,consent:o,sendEdgeNetworkRequest:r,setTimestamp:Ct((function(){return new Date}))}),c=lo({mediaSessionCacheManager:i,mediaEventManager:a,config:n}),u=fo({config:n,mediaEventManager:a,mediaSessionCacheManager:i}),s=go({mediaSessionCacheManager:i,config:n,trackMediaEvent:c});return Ru({config:n,trackMediaEvent:c,mediaResponseHandler:s,trackMediaSession:u})};Nu.namespace="Streaming media",Nu.configValidators=Ou;var Au=Object.freeze({__proto__:null,activityCollector:Hr,audiences:Qr,consent:to,eventMerge:oo,mediaAnalyticsBridge:Mo,personalization:pc,rulesEngine:Tu,streamingMedia:Nu});!function(e){var n=e.components,t=window.__alloyNS;t&&t.forEach((function(e){var t=Nn({console:dr,locationSearch:window.location.search,createLogger:nt,instanceName:e,createNamespacedStorage:ur,getMonitors:pr}),r=function(e){return function(n){var t=c(n,3),r=t[0],o=t[1],i=c(t[2],2),a=i[0],u=i[1];e(a,u).then(r,o)}}(br({instanceName:e,logController:t,components:n})),o=window[e].q;o.push=r,t.logger.logOnInstanceCreated({instance:r}),o.forEach(r)}))}({components:Object.values(Au)})}();}catch(err){console.error(err);}})(window.usbAnalyticsConfig);}catch(e){console.log(e)}}catch(e){console.log(e);}
try{try{window.s={cookieDomain:'usbank.com',writeSecureCookies:false,tl:function(obj,type,name){if(name){window.usbAnalytics.push({command:'trackEvent',event:'onClick',properties:{linkName:name,linkOrPageName:name}});}},replace:function(a,c,d){return!a||0>a.indexOf(c)?a:a.split(c).join(d);},escape:function(b){var c,d;if(!b)
return b;b=encodeURIComponent(b);for(c=0;7>c;c++)
d="+~!*()'".substring(c,c+1),0<=b.indexOf(d)&&(b=this.replace(b,d,"%"+d.charCodeAt(0).toString(16).toUpperCase()));return b;},unescape:function(b){if(!b)
return b;b=0<=b.indexOf("+")?this.replace(b,"+"," "):b;try{return decodeURIComponent(b)}catch(c){}
return unescape(b);},cookieRead:function(b){b=this.escape(b);var c=" "+document.cookie,d=c.indexOf(" "+b+"="),f=0>d?d:c.indexOf(";",d);b=0>d?"":this.unescape(c.substring(d+2+b.length,0>f?c.length:f));return"[[B]]"!=b?b:"";},Rb:function(){var b=window.location.hostname,c=this.fpCookieDomainPeriods,d;c||(c=this.cookieDomainPeriods);if(b&&!this.La&&!/^[0-9.]+$/.test(b)&&(c=c?parseInt(c):2,c=2<c?c:2,d=b.lastIndexOf("."),0<=d)){for(;0<=d&&1<c;)
d=b.lastIndexOf(".",d-1),c--;this.La=0<d?b.substring(d):b}
return this.La;},cookieWrite:function(b,c,d){var f=this.Rb(),e=this.cookieLifetime,g;c=""+c;e=e?(""+e).toUpperCase():"";d&&"SESSION"!=e&&"NONE"!=e&&((g=""!=c?parseInt(e?e:0):-60)?(d=new Date,d.setTime(d.getTime()+1E3*g)):1===d&&(d=new Date,g=d.getYear(),d.setYear(g+2+(1900>g?1900:0))));return b&&"NONE"!=e?(document.cookie=this.escape(b)+"="+this.escape(""!=c?c:"[[B]]")+"; path=/;"+(d&&"SESSION"!=e?" expires="+d.toUTCString()+";":"")+(f?" domain="+f+";":"")+(this.writeSecureCookies?" secure;":""),this.cookieRead(b)==c):0;},};s.cookieDomainPeriods=s.cookieDomain.split('.').length;s.c_rr=s.cookieRead;s.c_wr=s.cookieWrite;if(!s.__ccucr){s.__ccucr=true;function c_r(k){var s=this,d=new Date,v=s.c_rr(k),c=s.c_rspers(),i,m,e;if(v)return v;k=s.escape?s.escape(k):encodeURIComponent(k);i=c.indexOf(' '+k+'=');c=i<0?s.c_rr('s_sess'):c;i=c.indexOf(' '+k+'=');m=i<0?i:c.indexOf('|',i);e=i<0?i:c.indexOf(';',i);m=m>0?m:e;v=i<0?'':s.unescape?s.unescape(c.substring(i+2+k.length,m<0?c.length:m)):decodeURIComponent(c.substring(i+2+k.length,m<0?c.length:m));return v;}
function c_rspers(){var s=this,cv=s.c_rr("s_pers"),date=new Date().getTime(),expd=null,cvarr=[],vcv="";if(!cv)return vcv;cvarr=cv.split(";");for(var i=0,l=cvarr.length;i<l;i++){expd=cvarr[i].match(/\|([0-9]+)$/);if(expd&&parseInt(expd[1])>=date){vcv+=cvarr[i]+";";}}
return vcv;}
s.c_rspers=c_rspers;s.c_r=s.cookieRead=c_r;}
if(!s.__ccucw){s.__ccucw=true;function c_w(k,v,e){var s=this,d=new Date,ht=0,pn='s_pers',sn='s_sess',pc=0,sc=0,pv,sv,c,i,t,f;d.setTime(d.getTime()-60000);if(s.c_rr(k))s.c_wr(k,'',d);k=s.escape?s.escape(k):encodeURIComponent(k);pv=s.c_rspers();i=pv.indexOf(' '+k+'=');if(i>-1){pv=pv.substring(0,i)+pv.substring(pv.indexOf(';',i)+1);pc=1;}
sv=s.c_rr(sn);i=sv.indexOf(' '+k+'=');if(i>-1){sv=sv.substring(0,i)+sv.substring(sv.indexOf(';',i)+1);sc=1;}
d=new Date;if(e){if(e==1)e=new Date,f=e.getYear(),e.setYear(f+5+(f<1900?1900:0));if(e.getTime()>d.getTime()){pv+=' '+k+'='+(s.escape?s.escape(v):encodeURIComponent(v))+'|'+e.getTime()+';';pc=1;}}else{sv+=' '+k+'='+(s.escape?s.escape(v):encodeURIComponent(v))+';';sc=1;}
sv=sv.replace(/%00/g,'');pv=pv.replace(/%00/g,'');if(sc)s.c_wr(sn,sv,0);if(pc){t=pv;while(t&&t.indexOf(';')!=-1){var t1=parseInt(t.substring(t.indexOf('|')+1,t.indexOf(';')));t=t.substring(t.indexOf(';')+1);ht=ht<t1?t1:ht;}
d.setTime(ht);s.c_wr(pn,pv,d);}
return v==s.c_r(s.unescape?s.unescape(k):decodeURIComponent(k));}
s.c_w=s.cookieWrite=c_w;}
s.getValOnce=new Function("v","c","e",""+
"var s=this,k=s.c_r(c),a=new Date;e=e?e:0;if(v){a.setTime(a.getTime("+
")+e*86400000);s.c_w(c,v,e?a:0);}return v==k?'':v");s.getPreviousValue=new Function("v","c","el",""+
"var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el"+
"){if(s.events){i=s.split(el,',');j=s.split(s.events,',');for(x in i"+
"){for(y in j){if(i[x]==j[y]){if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t)"+
":s.c_w(c,'no value',t);return r}}}}}else{if(s.c_r(c)) r=s.c_r(c);v?"+
"s.c_w(c,v,t):s.c_w(c,'no value',t);return r}");s.getPercentPageViewed=function(pid,ch){var e=pid,i=ch;if("-v"===e)return{plugin:"getPercentPageViewed",version:"5.1"};var t=function(){if(void 0!==window.s_c_il){for(var e,i=0;i<window.s_c_il.length;i++)if((e=window.s_c_il[i])._c&&"s_c"===e._c)return e}}();function o(){if(window.ppvID){var e=Math.max(Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),Math.max(document.body.clientHeight,document.documentElement.clientHeight)),i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,t=(window.pageYOffset||window.document.documentElement.scrollTop||window.document.body.scrollTop)+i,o=Math.min(Math.round(t/e*100),100),n=Math.floor(e/i),p=Math.floor(t/i),s="";if(!window.cookieRead("s_tp")||decodeURIComponent(window.cookieRead("s_ppv").split(",")[0])!==window.ppvID||window.p_fo(window.ppvID)||!0==window.ppvChange&&window.cookieRead("s_tp")&&e!=window.cookieRead("s_tp")){if((decodeURIComponent(window.cookieRead("s_ppv").split(",")[0])!==window.ppvID||window.p_fo(window.ppvID+"1"))&&window.cookieWrite("s_ips",t),window.cookieRead("s_tp")&&decodeURIComponent(window.cookieRead("s_ppv").split(",")[0])===window.ppvID){window.cookieRead("s_tp");var a=window.cookieRead("s_ppv"),c=a.indexOf(",")>-1?a.split(","):[],d=c[0]?c[0]:"",r=window.cookieRead("s_ips"),l=c[3]?c[3]:"";s=d+","+Math.round(r/e*100)+","+Math.round(l/e*100)+","+o+","+l+","+n+","+p}window.cookieWrite("s_tp",e)}else s=window.cookieRead("s_ppv");var v=s&&s.indexOf(",")>-1?s.split(",",7):[],f=v.length>0?v[0]:encodeURIComponent(window.ppvID),$=v.length>1?parseInt(v[1]):o,h=v.length>2?parseInt(v[2]):o,u=v.length>4?parseInt(v[4]):t,k=v.length>5?parseInt(v[5]):n,m=v.length>6?parseInt(v[6]):p;o>0&&(s=f+","+$+","+(o>h?o:h)+","+o+","+(t>u?t:u)+","+(n>k?n:k)+","+(p>m?p:m)),window.cookieWrite("s_ppv",s)}}void 0!==t&&(t.contextData.getPercentPageViewed="5.1"),window.pageName=void 0!==t&&t.pageName||"",window.cookieWrite=window.cookieWrite||function(e,i,t){if("string"==typeof e){if(g=function(){var e=window.location.hostname,i=window.location.hostname.split(".").length-1;if(e&&!/^[0-9.]+$/.test(e)){i=2<i?i:2;var t=e.lastIndexOf(".");if(0<=t){for(;0<=t&&1<i;)t=e.lastIndexOf(".",t-1),i--;t=0<t?e.substring(t):e}}return t}(),i=void 0!==i?""+i:"",t||""===i){if(""===i&&(t=-60),"number"==typeof t){var o=new Date;o.setTime(o.getTime()+6e4*t)}else o=t}return!!e&&(document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(i)+"; path=/;"+(t?" expires="+o.toUTCString()+";":"")+(g?" domain="+g+";":""),void 0!==window.cookieRead)&&window.cookieRead(e)===i}},window.cookieRead=window.cookieRead||function(e){if("string"!=typeof e)return"";e=encodeURIComponent(e);var i=" "+document.cookie,t=i.indexOf(" "+e+"="),o=0>t?t:i.indexOf(";",t);return(e=0>t?"":decodeURIComponent(i.substring(t+2+e.length,0>o?i.length:o)))?e:""},window.p_fo=window.p_fo||function(e){return window.__fo||(window.__fo={}),!window.__fo[e]&&(window.__fo[e]={},!0)};var n=window.cookieRead("s_ppv"),p=n.indexOf(",")>-1?n.split(","):[];p[0]=p.length>0?decodeURIComponent(p[0]):"",e=e||(window.pageName?window.pageName:document.location.href),void 0===i||!0==i?window.ppvChange=!0:window.ppvChange=!1,void 0!==t&&t.linkType&&"o"===t.linkType||(window.ppvID&&window.ppvID===e||(window.ppvID=e,window.cookieWrite("s_ppv",""),o()),window.p_fo("s_gppvLoad2")&&window.addEventListener&&(window.addEventListener("load",o,!1),window.addEventListener("click",o,!1),window.addEventListener("scroll",o,!1)),this._ppvPreviousPage=p[0]?p[0]:"",this._ppvInitialPercentViewed=p[1]?p[1]:"",this._ppvHighestPercentViewed=p[2]?p[2]:"",this._ppvFinalPercentViewed=p[3]?p[3]:"",this._ppvHighestPixelsSeen=p[4]?p[4]:"",this._ppvFoldsAvailable=p[5]?p[5]:"",this._ppvFoldsSeen=p[6]?p[6]:"")};}catch(e){console.log(e)}}catch(e){console.log(e);}
try{try{if(!window.Visitor){window.Visitor={};if(typeof alloy==="function"){alloy("getIdentity")
.then(function(result){window.Visitor.ECID=result.identity.ECID;})
.catch(e=>{window.Visitor.ECID=''})}else{window.Visitor.ECID='';}
window.Visitor.getInstance=function(orgId){return window.Visitor;}
window.Visitor.getMarketingCloudVisitorID=function(){return window.Visitor.ECID;}
window.Visitor.isAllowed=function(){return true};}}catch(e){console.log(e)}}catch(e){console.log(e);}